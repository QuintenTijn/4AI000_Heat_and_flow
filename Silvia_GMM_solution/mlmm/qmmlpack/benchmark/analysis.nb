(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    332542,       8393]
NotebookOptionsPosition[    314881,       7821]
NotebookOutlinePosition[    316642,       7869]
CellTagsIndexPosition[    316599,       7866]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["qmmlpack benchmarks analysis", "Title",
 CellChangeTimes->{{3.5269768869725227`*^9, 3.526976889291122*^9}, {
  3.675583034323839*^9, 3.6755830419289837`*^9}, {3.676182416139007*^9, 
  3.676182417025535*^9}}],

Cell["\<\
Analysis for timing benchmarks of C++/Python/Mathematica parts of qmmlpack.\
\>", "Text",
 CellChangeTimes->{{3.5269768985336533`*^9, 3.526976901871909*^9}, {
  3.675583046273357*^9, 3.675583079727379*^9}, {3.6761824187615128`*^9, 
  3.6761824259531507`*^9}}],

Cell[CellGroupData[{

Cell["Code & initialization", "Section",
 CellChangeTimes->{{3.5269769790029383`*^9, 3.5269769982995653`*^9}, 
   3.526982441933325*^9, {3.526982501312275*^9, 3.526982501422443*^9}, {
   3.675583303511499*^9, 3.675583304013823*^9}, {3.676779095118896*^9, 
   3.676779099990643*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Initialization  ",
 StyleBox["[resultsDir]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsection",
 CellChangeTimes->{{3.6767790636009903`*^9, 3.676779066424155*^9}, {
  3.6772105951003723`*^9, 3.677210597860229*^9}}],

Cell[CellGroupData[{

Cell["Parallel settings", "Subsubsection",
 CellChangeTimes->{{3.6755832152099943`*^9, 3.675583218641634*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"numkernels", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LaunchKernels", "[", "numkernels", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$HistoryLength", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParallelEvaluate", "[", 
    RowBox[{"$HistoryLength", "=", "0"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"On", "[", "Assert", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{"On", "[", "Assert", "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.548683029048232*^9, 3.5486830298226748`*^9}, {
   3.548736975622952*^9, 3.548736977430768*^9}, {3.549614820971567*^9, 
   3.549614846324506*^9}, {3.550900268083726*^9, 3.550900268264217*^9}, {
   3.553430387785866*^9, 3.553430387846553*^9}, {3.5553217735493507`*^9, 
   3.5553217737899847`*^9}, {3.569218933730733*^9, 3.569218933943967*^9}, {
   3.5704382469298897`*^9, 3.570438247302685*^9}, {3.570952605236747*^9, 
   3.570952606492248*^9}, {3.5710698743930693`*^9, 3.571069891703614*^9}, {
   3.594453195789053*^9, 3.594453197182135*^9}, {3.5944542537681217`*^9, 
   3.594454254631847*^9}, {3.6086106231388702`*^9, 3.608610647093856*^9}, {
   3.6098412077469263`*^9, 3.609841220913802*^9}, 3.610706079416524*^9, {
   3.612688834343123*^9, 3.612688843260086*^9}, 3.612688915660953*^9, {
   3.612690686930704*^9, 3.612690687057312*^9}, {3.6145000467023983`*^9, 
   3.614500048005906*^9}, {3.61502989848693*^9, 3.61502990814999*^9}, {
   3.615038324008312*^9, 3.615038329328095*^9}, {3.6360287741765747`*^9, 
   3.636028783983691*^9}, {3.636271937349308*^9, 3.636271947469322*^9}, {
   3.6755831521325617`*^9, 3.67558315242059*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Directories  ",
 StyleBox["[resultsDir]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.676182615698044*^9, 3.676182616889368*^9}, {
  3.676184761732806*^9, 3.676184763403181*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"resultsDir", " ", "=", " ", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<results\>\""}], 
     "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676182669126285*^9, 3.6761826912876368`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Utility  ",
 StyleBox["[NamesJoin]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsection",
 CellChangeTimes->{{3.676717777777916*^9, 3.6767177786811857`*^9}, {
  3.676717928578919*^9, 3.6767179315469513`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "NamesJoin", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NamesJoin", "::", "usage"}], "=", 
    "\"\<NamesJoin[s1,s2,...] or NamesJoin[{s1,s2,...}] removes common parts \
of strings s1,s2,...\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NamesJoin", "[", "names__", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"args", ",", "joint", ",", "y"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"args", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayDepth", "[", 
           RowBox[{"{", "names", "}"}], "]"}], "\[Equal]", "1"}], ",", 
         RowBox[{"{", "names", "}"}], ",", "names"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"joint", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"ToCharacterCode", ",", "args"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"joint", "=", 
       RowBox[{"Fold", "[", 
        RowBox[{"LongestCommonSubsequence", ",", "joint"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringDrop", "[", 
          RowBox[{"#", ",", 
           RowBox[{"Length", "[", "joint", "]"}]}], "]"}], "&"}], ",", 
        "args"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.67671615588839*^9, 3.676716167381531*^9}, {
  3.676716270969693*^9, 3.6767163720767603`*^9}, {3.6767164940155983`*^9, 
  3.676716497359394*^9}, {3.676716570204311*^9, 3.676716624938819*^9}, {
  3.676716684343536*^9, 3.6767166897511797`*^9}, {3.676716925998054*^9, 
  3.676716991386503*^9}, {3.676717026185194*^9, 3.676717190370878*^9}, {
  3.676717246263814*^9, 3.676717247847671*^9}, {3.676717300397599*^9, 
  3.676717301573526*^9}, {3.676717390593842*^9, 3.676717602113161*^9}, {
  3.676717690317594*^9, 3.676717752642777*^9}, {3.676717787169121*^9, 
  3.6767177973608*^9}, {3.67671788075023*^9, 3.676717923267704*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "BenchmarkPlot  ",
 StyleBox["[BenchmarkPlot,BenchmarkArrayPlot,BenchmarkContourPlot,\
BenchmarkBarChart]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsection",
 CellChangeTimes->{{3.675670367800508*^9, 3.6756703703197117`*^9}, {
  3.676718260685441*^9, 3.6767182630535583`*^9}, {3.677929017413598*^9, 
  3.677929020813553*^9}, {3.677990612091942*^9, 3.67799061850668*^9}, {
  3.6779906834801083`*^9, 3.6779906935436687`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "BenchmarkPlot", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BenchmarkPlot", "::", "error"}], "=", 
    "\"\<BenchmarkPlot failed: ``\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BenchmarkPlot", "]"}], "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<PlotType\>\"", "\[Rule]", "Automatic"}], " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<BarChart\>\"", " ", "--"}], " ", "\"\<Array\>\""}], 
         ",", " ", "\"\<Contours\>\""}], " ", "*)"}], "}"}], ",", 
      RowBox[{"Options", "[", "Graphics", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"namea_", ",", "timingsa_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nameb_", ",", "timingsb_"}], "}"}], ",", 
     RowBox[{"theta_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VectorQ", "[", 
         RowBox[{"#", ",", "ListQ"}], "]"}], "&"}], ")"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dim", ",", "oplottype"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dim", "=", 
       RowBox[{"Length", "[", "theta", "]"}]}], ";", "  ", 
      RowBox[{"Assert", "[", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", "dim"}], "]"}], "]"}], ";", 
      " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Number", " ", "of", " ", "parameters"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"oplottype", "=", 
       RowBox[{"OptionValue", "[", "\"\<PlotType\>\"", "]"}]}], ";", 
      RowBox[{"Assert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dim", "\[Equal]", "1"}], "&&", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", "\"\<BarChart\>\"", "}"}], ",", "oplottype"}], 
          "]"}]}], "||", 
        RowBox[{
         RowBox[{"dim", "\[Equal]", "2"}], "&&", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Array\>\"", ",", "\"\<Contours\>\""}], "}"}], ",", 
           "oplottype"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "oplottype", ",", "\[IndentingNewLine]", "\"\<BarChart\>\"", ",", 
        RowBox[{"BenchmarkBarChart", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"namea", ",", "timingsa"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"nameb", ",", "timingsb"}], "}"}], ",", "theta", ",", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "opts", "}"}], ",", 
            RowBox[{"Options", "[", "Graphics", "]"}]}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\"\<Array\>\"", ",", 
        RowBox[{"BenchmarkArrayPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"namea", ",", "timingsa"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"nameb", ",", "timingsb"}], "}"}], ",", "theta", ",", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "opts", "}"}], ",", 
            RowBox[{"Options", "[", "Graphics", "]"}]}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\"\<Contours\>\"", ",", 
        RowBox[{"BenchmarkContourPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"namea", ",", "timingsa"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"nameb", ",", "timingsb"}], "}"}], ",", "theta", ",", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "opts", "}"}], ",", 
            RowBox[{"Options", "[", "Graphics", "]"}]}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "_", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"BenchmarkPlot", "::", "error"}], ",", 
           RowBox[{
           "\"\<Unknown value '\>\"", "<>", "oplottype", "<>", 
            "\"\<' for \\\"PlotType\\\" option\>\""}]}], "]"}], ";", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675584644784678*^9, 3.675584711532267*^9}, {
   3.675584799608852*^9, 3.67558480132885*^9}, {3.675585200200604*^9, 
   3.675585254606577*^9}, {3.675585291437151*^9, 3.675585294517088*^9}, {
   3.6755853301649837`*^9, 3.675585336979438*^9}, {3.6755853713060007`*^9, 
   3.6755855721699533`*^9}, {3.675585629063469*^9, 3.675585720476234*^9}, {
   3.675585785489429*^9, 3.6755857945852737`*^9}, {3.675585846064814*^9, 
   3.675585850776314*^9}, {3.67558589664511*^9, 3.675586000345071*^9}, {
   3.675586140197003*^9, 3.675586229527959*^9}, {3.675586265912051*^9, 
   3.675586275406008*^9}, {3.675586337780327*^9, 3.675586418800106*^9}, {
   3.675586745708658*^9, 3.6755867544908857`*^9}, {3.675586858039894*^9, 
   3.675586898164983*^9}, {3.675587149244306*^9, 3.6755871848826427`*^9}, {
   3.675587370234468*^9, 3.67558737553592*^9}, {3.675587513573697*^9, 
   3.675587579658258*^9}, {3.675587733061483*^9, 3.675587804233121*^9}, 
   3.6755905395259953`*^9, {3.6755906342499657`*^9, 3.675590635545559*^9}, {
   3.675590701222927*^9, 3.675590702294935*^9}, {3.675590740461429*^9, 
   3.675590741253042*^9}, {3.675590805202362*^9, 3.675590823583942*^9}, {
   3.675591243831711*^9, 3.6755912685411873`*^9}, {3.675591312196622*^9, 
   3.67559133957824*^9}, {3.675591374481461*^9, 3.675591461845986*^9}, {
   3.6755915575212727`*^9, 3.675591614165594*^9}, {3.675592349585005*^9, 
   3.6755924107986507`*^9}, {3.675592450077174*^9, 3.675592454628826*^9}, {
   3.6755925033525457`*^9, 3.675592596191107*^9}, {3.6755926712600822`*^9, 
   3.675592782775838*^9}, {3.675592819422846*^9, 3.6755928220462112`*^9}, {
   3.675592865652842*^9, 3.675592898684649*^9}, {3.675592937570726*^9, 
   3.675592938594131*^9}, {3.6755929699279127`*^9, 3.67559297016782*^9}, {
   3.675593044686482*^9, 3.675593074619734*^9}, {3.67559315489258*^9, 
   3.6755931928949738`*^9}, {3.675593241702128*^9, 3.675593260404204*^9}, {
   3.675593398031431*^9, 3.6755933982961884`*^9}, {3.6755937026102*^9, 
   3.675593724633733*^9}, {3.675594148945863*^9, 3.675594186774819*^9}, {
   3.675594249764184*^9, 3.6755942813149357`*^9}, {3.67559431823538*^9, 
   3.675594501530263*^9}, {3.675596572311145*^9, 3.6755967314895687`*^9}, {
   3.675596953967368*^9, 3.675597026068953*^9}, {3.67559720790091*^9, 
   3.675597223820229*^9}, {3.675597255827491*^9, 3.675597261602845*^9}, {
   3.675597313242909*^9, 3.6755973135050783`*^9}, {3.675597445659292*^9, 
   3.6755974756659727`*^9}, {3.675597555078496*^9, 3.6755976578425217`*^9}, {
   3.675598768005427*^9, 3.675598771629224*^9}, {3.67559938254974*^9, 
   3.6755994131233587`*^9}, {3.675599450977515*^9, 3.6755994572096863`*^9}, {
   3.675599495495685*^9, 3.6755995027356033`*^9}, {3.675599577956841*^9, 
   3.675599612906582*^9}, {3.6755996665288887`*^9, 3.675599742469801*^9}, {
   3.675599835058083*^9, 3.6755998383940153`*^9}, {3.675599904230859*^9, 
   3.675599927134378*^9}, {3.675600259074028*^9, 3.67560026227232*^9}, {
   3.675600414051375*^9, 3.675600422402486*^9}, {3.6756681445565767`*^9, 
   3.675668160851145*^9}, {3.675668212578308*^9, 3.675668219345125*^9}, {
   3.67566840443237*^9, 3.6756684446708803`*^9}, {3.675668476614106*^9, 
   3.675668481126534*^9}, {3.675668518228405*^9, 3.675668529779867*^9}, {
   3.675668585370364*^9, 3.675668588889577*^9}, {3.6756686347683353`*^9, 
   3.675668635799857*^9}, {3.675668677406502*^9, 3.6756686782704353`*^9}, {
   3.675668717037107*^9, 3.675668733203549*^9}, {3.675668766683031*^9, 
   3.675668911108346*^9}, {3.675669006376649*^9, 3.675669008216683*^9}, {
   3.6756690422715197`*^9, 3.675669065302253*^9}, {3.675671084980612*^9, 
   3.675671085012526*^9}, {3.676182504152945*^9, 3.676182506248555*^9}, {
   3.676362111804947*^9, 3.676362112292861*^9}, {3.6764546706281557`*^9, 
   3.6764546891379128`*^9}, {3.676454745023622*^9, 3.676454754304962*^9}, {
   3.6764549068019667`*^9, 3.676454937055969*^9}, {3.6779289280454597`*^9, 
   3.677928942683195*^9}, {3.6779289861774282`*^9, 3.6779290028806677`*^9}, {
   3.677930928264647*^9, 3.6779311558550253`*^9}, {3.677931187725471*^9, 
   3.6779314576175337`*^9}, {3.677932154612399*^9, 3.6779322023934927`*^9}, {
   3.6779323497166348`*^9, 3.677932351468623*^9}, {3.6779324445834208`*^9, 
   3.677932448775279*^9}, 3.6779325192762823`*^9, {3.677933355986018*^9, 
   3.6779333841206293`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Factored", " ", "out", " ", "code", " ", "from", " ", 
    "BenchmarkArrayPlot", " ", "and", " ", "BenchmarkContourPlot"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "benchmarkArrayContourPlot", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"benchmarkArrayContourPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"namea_", ",", "timingsa_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nameb_", ",", "timingsb_"}], "}"}], ",", "theta_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timings", ",", "min", ",", "max", ",", "nr", ",", "nc", ",", 
         "labelr", ",", "labelc", ",", "ranger", ",", "rangec", ",", 
         "legendlbl", ",", "df", ",", "colorf", ",", "legend"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"timings", "=", 
         RowBox[{
          RowBox[{"timingsa", "/", "timingsb"}], " ", "-", " ", "1"}]}], ";", 
        " ", 
        RowBox[{"(*", " ", 
         RowBox[{"fractional", " ", "relative", " ", "timings"}], " ", "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"min", ",", "max"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Min", "[", "timings", "]"}], ",", 
           RowBox[{"Max", "[", "timings", "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nr", ",", "nc"}], "}"}], "=", 
         RowBox[{"Dimensions", "[", "timings", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"labelr", ",", "labelc"}], "}"}], "=", 
         RowBox[{"theta", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ranger", ",", "rangec"}], "}"}], "=", 
         RowBox[{"theta", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ranger", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ranger", "===", "Automatic"}], ",", 
           RowBox[{"Range", "[", "nr", "]"}], ",", 
           RowBox[{"MapIndexed", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#2", "]"}], ",", "#1"}], "}"}], "&"}], 
             ",", "ranger"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rangec", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"rangec", "===", "Automatic"}], ",", 
           RowBox[{"Range", "[", "nc", "]"}], ",", 
           RowBox[{"MapIndexed", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"First", "[", "#2", "]"}], ",", "#1"}], "}"}], "&"}], 
             ",", "rangec"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"legendlbl", "=", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "namea", ",", "\"\< better\>\"", ",", "\"\<\\t\\t\\t\\t\\t\\t\>\"",
             ",", "nameb", ",", "\"\< better\>\""}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"df", "=", 
         RowBox[{"Function", "[", 
          RowBox[{"p", ",", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", "idx", "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"idx", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"nr", "-", 
                  RowBox[{"Clip", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"nr", "-", 
                    RowBox[{
                    "p", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}], "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "nr"}], "}"}]}], "]"}], "+", "1"}], ",", 
                 RowBox[{"Clip", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    "p", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "+", "1"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "nc"}], "}"}]}], "]"}]}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "labelr", ",", "\"\<\[ThinSpace]=\[ThinSpace]\>\"", ",", 
                  RowBox[{"ranger", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{
                    "idx", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "2"}], 
                   "\[RightDoubleBracket]"}], ",", "\"\<, \>\"", ",", 
                  "labelc", ",", "\"\<\[ThinSpace]=\[ThinSpace]\>\"", ",", 
                  RowBox[{"rangec", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{
                    "idx", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "2"}], 
                   "\[RightDoubleBracket]"}], ",", "\"\<\\n\>\"", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Extract", "[", 
                   RowBox[{"timingsa", ",", "idx"}], "]"}], ",", 
                  "\"\<\[ThinSpace]/\[ThinSpace]\>\"", ",", 
                  RowBox[{"Extract", "[", 
                   RowBox[{"timingsb", ",", "idx"}], "]"}], ",", 
                  "\"\<-1\[ThinSpace]=\[ThinSpace]\>\"", ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"timings", ",", "idx"}], "]"}], ",", "Bold"}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Automatic"}], ",", 
                RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
                RowBox[{"ImageMargins", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"5", ",", "5"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"10", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"colorf", ":=", 
         RowBox[{"Function", "[", 
          RowBox[{"x", ",", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"f", "=", 
               RowBox[{"Max", "[", 
                RowBox[{"max", ",", 
                 RowBox[{"-", "min"}]}], "]"}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
              
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x", "+", "f"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", "f"}], ")"}]}], "]"}]}], "]"}]}], "]"}]}], ";", 
        " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Bug", " ", "in", " ", "BarLegend"}], ",", " ", 
          RowBox[{"must", " ", "have", " ", "head", " ", "Function"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"legend", "=", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"BarLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"colorf", ",", 
               RowBox[{"{", 
                RowBox[{"min", ",", "max"}], "}"}]}], "}"}], ",", 
             RowBox[{"LegendLayout", "\[Rule]", "\"\<Row\>\""}], ",", 
             RowBox[{"LegendLabel", "\[Rule]", "legendlbl"}]}], "]"}], ",", 
           "Below"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "timings", ",", "labelr", ",", "labelc", ",", "ranger", ",", 
          "rangec", ",", "df", ",", "colorf", ",", "legend"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "BenchmarkArrayPlot", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "BenchmarkArrayPlot", "]"}], "=", 
     RowBox[{"Options", "[", "MatrixPlot", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BenchmarkArrayPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"namea_", ",", 
         RowBox[{"timingsa_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatrixQ", "[", "#", "]"}], "&"}], ")"}]}]}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"nameb_", ",", 
         RowBox[{"timingsb_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatrixQ", "[", "#", "]"}], "&"}], ")"}]}]}], "}"}], ",", 
       "theta_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timings", ",", "labelr", ",", "labelc", ",", "ranger", ",", "rangec",
          ",", "df", ",", "colorf", ",", "legend"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "timings", ",", "labelr", ",", "labelc", ",", "ranger", ",", 
           "rangec", ",", "df", ",", "colorf", ",", "legend"}], "}"}], "=", 
         RowBox[{"benchmarkArrayContourPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"namea", ",", "timingsa"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nameb", ",", "timingsb"}], "}"}], ",", "theta"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"MatrixPlot", "[", 
         RowBox[{"timings", ",", "\[IndentingNewLine]", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "opts", "}"}], ",", 
            RowBox[{"Options", "[", "MatrixPlot", "]"}]}], "]"}], ",", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"User", "-", 
            RowBox[{
            "specified", " ", "options", " ", "go", " ", "first", " ", "so", 
             " ", "they", " ", "take", " ", "precedence"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"labelr", ",", "labelc"}], "}"}]}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ranger", ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"rangec", ",", "None"}], "}"}]}], "}"}]}], ",", 
          RowBox[{"DataReversed", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", "colorf"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotLegends", "\[Rule]", "legend"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"CoordinatesToolOptions", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<DisplayFunction\>\"", "\[Rule]", "df"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "BenchmarkContourPlot", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "BenchmarkContourPlot", "]"}], "=", 
     RowBox[{"Options", "[", "ListContourPlot", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BenchmarkContourPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"namea_", ",", 
         RowBox[{"timingsa_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatrixQ", "[", "#", "]"}], "&"}], ")"}]}]}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"nameb_", ",", 
         RowBox[{"timingsb_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MatrixQ", "[", "#", "]"}], "&"}], ")"}]}]}], "}"}], ",", 
       "theta_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "timings", ",", "labelr", ",", "labelc", ",", "ranger", ",", "rangec",
          ",", "df", ",", "colorf", ",", "legend", ",", "contours"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "timings", ",", "labelr", ",", "labelc", ",", "ranger", ",", 
           "rangec", ",", "df", ",", "colorf", ",", "legend"}], "}"}], "=", 
         RowBox[{"benchmarkArrayContourPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"namea", ",", "timingsa"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nameb", ",", "timingsb"}], "}"}], ",", "theta"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"contours", "=", 
         RowBox[{"N", "[", 
          RowBox[{"FindDivisions", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Min", "[", "timings", "]"}], ",", 
              RowBox[{"Max", "[", "timings", "]"}]}], "}"}], ",", "8"}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"contours", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Append", "[", 
           RowBox[{"contours", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ListContourPlot", "[", 
         RowBox[{"timings", ",", "\[IndentingNewLine]", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "opts", "}"}], ",", 
            RowBox[{"Options", "[", "ListContourPlot", "]"}]}], "]"}], ",", 
          " ", 
          RowBox[{"(*", " ", 
           RowBox[{"User", "-", 
            RowBox[{
            "specified", " ", "options", " ", "go", " ", "first", " ", "so", 
             " ", "they", " ", "take", " ", "precedence"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"labelc", ",", "labelr"}], "}"}]}], ",", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"rangec", ",", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ranger", ",", "None"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", "colorf"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotLegends", "\[Rule]", "legend"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
          RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
          RowBox[{"ContourStyle", "\[Rule]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#", "\[Equal]", "0"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Thick", ",", "Black"}], "]"}], ",", "Black"}], 
               "]"}], "&"}], ",", "contours"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"CoordinatesToolOptions", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<DisplayFunction\>\"", "\[Rule]", "df"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675584644784678*^9, 3.675584711532267*^9}, {
   3.675584799608852*^9, 3.67558480132885*^9}, {3.675585200200604*^9, 
   3.675585254606577*^9}, {3.675585291437151*^9, 3.675585294517088*^9}, {
   3.6755853301649837`*^9, 3.675585336979438*^9}, {3.6755853713060007`*^9, 
   3.6755855721699533`*^9}, {3.675585629063469*^9, 3.675585720476234*^9}, {
   3.675585785489429*^9, 3.6755857945852737`*^9}, {3.675585846064814*^9, 
   3.675585850776314*^9}, {3.67558589664511*^9, 3.675586000345071*^9}, {
   3.675586140197003*^9, 3.675586229527959*^9}, {3.675586265912051*^9, 
   3.675586275406008*^9}, {3.675586337780327*^9, 3.675586418800106*^9}, {
   3.675586745708658*^9, 3.6755867544908857`*^9}, {3.675586858039894*^9, 
   3.675586898164983*^9}, {3.675587149244306*^9, 3.6755871848826427`*^9}, {
   3.675587370234468*^9, 3.67558737553592*^9}, {3.675587513573697*^9, 
   3.675587579658258*^9}, {3.675587733061483*^9, 3.675587804233121*^9}, 
   3.6755905395259953`*^9, {3.6755906342499657`*^9, 3.675590635545559*^9}, {
   3.675590701222927*^9, 3.675590702294935*^9}, {3.675590740461429*^9, 
   3.675590741253042*^9}, {3.675590805202362*^9, 3.675590823583942*^9}, {
   3.675591243831711*^9, 3.6755912685411873`*^9}, {3.675591312196622*^9, 
   3.67559133957824*^9}, {3.675591374481461*^9, 3.675591461845986*^9}, {
   3.6755915575212727`*^9, 3.675591614165594*^9}, {3.675592349585005*^9, 
   3.6755924107986507`*^9}, {3.675592450077174*^9, 3.675592454628826*^9}, {
   3.6755925033525457`*^9, 3.675592596191107*^9}, {3.6755926712600822`*^9, 
   3.675592782775838*^9}, {3.675592819422846*^9, 3.6755928220462112`*^9}, {
   3.675592865652842*^9, 3.675592898684649*^9}, {3.675592937570726*^9, 
   3.675592938594131*^9}, {3.6755929699279127`*^9, 3.67559297016782*^9}, {
   3.675593044686482*^9, 3.675593074619734*^9}, {3.67559315489258*^9, 
   3.6755931928949738`*^9}, {3.675593241702128*^9, 3.675593260404204*^9}, {
   3.675593398031431*^9, 3.6755933982961884`*^9}, {3.6755937026102*^9, 
   3.675593724633733*^9}, {3.675594148945863*^9, 3.675594186774819*^9}, {
   3.675594249764184*^9, 3.6755942813149357`*^9}, {3.67559431823538*^9, 
   3.675594501530263*^9}, {3.675596572311145*^9, 3.6755967314895687`*^9}, {
   3.675596953967368*^9, 3.675597026068953*^9}, {3.67559720790091*^9, 
   3.675597223820229*^9}, {3.675597255827491*^9, 3.675597261602845*^9}, {
   3.675597313242909*^9, 3.6755973135050783`*^9}, {3.675597445659292*^9, 
   3.6755974756659727`*^9}, {3.675597555078496*^9, 3.6755976578425217`*^9}, {
   3.675598768005427*^9, 3.675598771629224*^9}, {3.67559938254974*^9, 
   3.6755994131233587`*^9}, {3.675599450977515*^9, 3.6755994572096863`*^9}, {
   3.675599495495685*^9, 3.6755995027356033`*^9}, {3.675599577956841*^9, 
   3.675599612906582*^9}, {3.6755996665288887`*^9, 3.675599742469801*^9}, {
   3.675599835058083*^9, 3.6755998383940153`*^9}, {3.675599904230859*^9, 
   3.675599927134378*^9}, {3.675600259074028*^9, 3.67560026227232*^9}, {
   3.675600414051375*^9, 3.675600422402486*^9}, {3.6756681445565767`*^9, 
   3.675668160851145*^9}, {3.675668212578308*^9, 3.675668219345125*^9}, {
   3.67566840443237*^9, 3.6756684446708803`*^9}, {3.675668476614106*^9, 
   3.675668481126534*^9}, {3.675668518228405*^9, 3.675668529779867*^9}, {
   3.675668585370364*^9, 3.675668588889577*^9}, {3.6756686347683353`*^9, 
   3.675668635799857*^9}, {3.675668677406502*^9, 3.6756686782704353`*^9}, {
   3.675668717037107*^9, 3.675668733203549*^9}, {3.675668766683031*^9, 
   3.675668911108346*^9}, {3.675669006376649*^9, 3.675669008216683*^9}, {
   3.6756690422715197`*^9, 3.675669065302253*^9}, {3.675671084980612*^9, 
   3.675671085012526*^9}, {3.676182504152945*^9, 3.676182506248555*^9}, {
   3.676362111804947*^9, 3.676362112292861*^9}, {3.6764546706281557`*^9, 
   3.6764546891379128`*^9}, {3.676454745023622*^9, 3.676454754304962*^9}, {
   3.6764549068019667`*^9, 3.676454937055969*^9}, {3.6779289280454597`*^9, 
   3.677928942683195*^9}, {3.6779289861774282`*^9, 3.6779290028806677`*^9}, {
   3.6779314858812323`*^9, 3.677931590012349*^9}, {3.677931696431723*^9, 
   3.677931712510689*^9}, {3.67793274387599*^9, 3.6779330611517763`*^9}, {
   3.6779331196306562`*^9, 3.67793318058589*^9}, {3.677990652555964*^9, 
   3.677990679091186*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "BenchmarkBarChart", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BenchmarkBarChart", "]"}], "=", 
    RowBox[{"Options", "[", "BarChart", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BenchmarkBarChart", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"namea_", ",", "timingsa_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nameb_", ",", "timingsb_"}], "}"}], ",", "theta_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"timings", ",", "labeledtimings", ",", "style"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"style", "=", 
       RowBox[{"Directive", "[", "14", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"timings", "=", 
       RowBox[{"100", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"timingsa", "/", "timingsb"}], " ", "-", " ", "1"}], 
         ")"}]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"fractional", " ", "relative", " ", "timings"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"labeledtimings", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Labeled", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"Style", "[", 
             RowBox[{"#2", ",", "style"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#1", "\[LessEqual]", "0"}], ",", "Above", ",", 
              "Below"}], "]"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"timings", ",", 
           RowBox[{"theta", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"User", "-", 
        RowBox[{
        "specified", " ", "options", " ", "go", " ", "first", " ", "so", " ", 
         "they", " ", "take", " ", "precedence"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"BarChart", "[", 
       RowBox[{"labeledtimings", ",", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", 
          RowBox[{"Options", "[", "BenchmarkBarChart", "]"}]}], "]"}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<  n\>\"", ",", "\"\<%\>\""}], "}"}]}], ",", 
        RowBox[{"TicksStyle", "\[Rule]", "style"}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", "style"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ColorFunction", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Blend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LightBlue", ",", "Blue"}], "}"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#", "-", 
                RowBox[{"Min", "[", 
                 RowBox[{"Abs", "[", "timings", "]"}], "]"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{"Abs", "[", "timings", "]"}], "]"}], "-", 
                RowBox[{"Min", "[", 
                 RowBox[{"Abs", "[", "timings", "]"}], "]"}]}], ")"}]}]}], 
            "]"}], "&"}], ")"}]}], ",", 
        RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"nameb", "<>", "\"\< better\>\""}], ",", "style"}], 
              "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"namea", "<>", "\"\< better\>\""}], ",", "style"}], 
              "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
          "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzjtIAgEAxvFLm4oMskAFI02iaOmhNGRhCVIUJEEIGga9rkWkshQiFwVt
SNQiiqOoQB2iwWzIsoaroQdIUISEhFuBoUilPaH7bvj4jd9fMmoenOAQBCFi
Br0qbV5IprsyC7YC9GX1v7DsboMrYnx69w/A4Um+FnIouQ7qm8oNsJs2jsCg
wkJCTTxkho853iyseZNZIUH1umDrUnIHVqTD+6zVqhN40Oi+hH5fkKdg3HN/
8WFiLiCEL88yMRTEtqUwSU3Vw8xPpA2Gv13t8PWjoIbRlKQPyhPZIXi8GTHA
lEM2DpWhaRO8ydPz0Nn5Z4cak9IBi6M9TvZXcO+F8fWqVWjlPmzBmF+9Cxuk
4jMoLGq+YPso3TXs8NQlYH/lqeWI8fMwboO1BaMTno+1uCAdKFmGt8YrD5wp
za1A+yK5Bv8B5jLIvQ==
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "BenchmarkStatistics  ",
 StyleBox["[BenchmarkStatistics]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsection",
 CellChangeTimes->{{3.676705901512369*^9, 3.676705906055472*^9}, {
  3.676718271061095*^9, 3.676718275324896*^9}, {3.677990706055183*^9, 
  3.677990709447015*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "BenchmarkStatistics", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BenchmarkStatistics", "::", "err"}], " ", "=", " ", 
    "\"\<Error: ``.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BenchmarkStatistics", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"Transpose", "\[Rule]", "False"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BenchmarkStatistics", "[", 
    RowBox[{"data_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "names", ",", "timings", ",", "table", ",", "highlight", ",", 
       "totaltimes", ",", "pcbest", ",", "otranspose"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"otranspose", "=", 
       RowBox[{"OptionValue", "[", "Transpose", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{
          RowBox[{"ArrayDepth", "[", "data", "]"}], "\[Equal]", "2"}], "]"}], 
        ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"BenchmarkStatistics", "::", "err"}], ",", 
           "\"\<Invalid format for data argument\>\""}], "]"}], ";", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"names", ",", "timings"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"data", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"data", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"totaltimes", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"#", ",", "Infinity"}], "]"}], "&"}], ",", "timings"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pcbest", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Min", ",", "timings", ",", 
         RowBox[{
          RowBox[{"ArrayDepth", "[", "timings", "]"}], "-", "1"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"pcbest", "=", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Extract", "[", 
            RowBox[{"pcbest", ",", 
             RowBox[{"Rest", "[", "#2", "]"}]}], "]"}], "\[Equal]", "#1"}], 
          "&"}], ",", "timings", ",", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pcbest", "=", 
       RowBox[{"Round", "[", 
        RowBox[{"N", "[", 
         RowBox[{"100", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Count", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", "#", "]"}], ",", "True"}], "]"}], 
              "&"}], ",", "pcbest"}], "]"}], "/", 
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"First", "[", "pcbest", "]"}], "]"}], "]"}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"highlight", "[", 
        RowBox[{
         RowBox[{"v_", "?", "ListQ"}], ",", "what_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "ind", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ind", "=", 
           RowBox[{"Switch", "[", 
            RowBox[{"what", ",", "\[IndentingNewLine]", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
                 RowBox[{"Positive", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
             "what", ",", "\[IndentingNewLine]", 
             RowBox[{"Min", "|", "Max"}], ",", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"v", ",", 
                RowBox[{"what", "[", "v", "]"}], ",", 
                RowBox[{"{", "1", "}"}], ",", 
                RowBox[{"Heads", "\[Rule]", "False"}]}], "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             "\[IndentingNewLine]", "_", ",", 
             RowBox[{"Abort", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"v", ",", 
            RowBox[{"ind", "\[Rule]", 
             RowBox[{"Item", "[", 
              RowBox[{
               RowBox[{
               "v", "\[LeftDoubleBracket]", "ind", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"BaseStyle", "\[Rule]", "Bold"}]}], "]"}]}]}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"table", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{"names", ",", "\"\<\>\""}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"highlight", "[", 
            RowBox[{"totaltimes", ",", "Min"}], "]"}], ",", 
           "\"\<\[CapitalSigma]t/s\>\""}], "]"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"highlight", "[", 
            RowBox[{"pcbest", ",", "Max"}], "]"}], ",", "\"\<best t/%\>\""}], 
          "]"}]}], "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{"If", "[", 
        RowBox[{"otranspose", ",", 
         RowBox[{"Transpose", "[", "table", "]"}], ",", "table"}], "]"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6767059123292522`*^9, 3.676706037474469*^9}, {
   3.6767062743536*^9, 3.6767062788168*^9}, {3.676706352653585*^9, 
   3.676706366301135*^9}, {3.6767066180670958`*^9, 3.676706636282435*^9}, 
   3.676706708593079*^9, {3.676706741677979*^9, 3.676706964813336*^9}, {
   3.6767070039236603`*^9, 3.6767070282345743`*^9}, {3.6767070759286127`*^9, 
   3.67670709814382*^9}, {3.676707301967703*^9, 3.676707315511108*^9}, {
   3.676707350477744*^9, 3.676707431619288*^9}, {3.6767075090721083`*^9, 
   3.6767075390221786`*^9}, {3.676707608395467*^9, 3.6767076122112617`*^9}, {
   3.676707782844331*^9, 3.676707863257218*^9}, {3.6767079992777*^9, 
   3.676708002411787*^9}, {3.6767082524417887`*^9, 3.6767083352464523`*^9}, {
   3.676708426698958*^9, 3.676708426962829*^9}, 3.6767793975011587`*^9, {
   3.676779471071847*^9, 3.67677950338267*^9}, {3.676779618331229*^9, 
   3.6767797578286133`*^9}, {3.676779789746694*^9, 3.676779790042561*^9}, {
   3.67677985295275*^9, 3.6767800044257*^9}, {3.676780042361259*^9, 
   3.6767800900706987`*^9}, {3.676780132597397*^9, 3.6767801497882147`*^9}, {
   3.676780187571753*^9, 3.676780229648695*^9}, {3.6767802967657633`*^9, 
   3.676780298485898*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "PairwiseComparison  ",
 StyleBox["[PairwiseComparison]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsection",
 CellChangeTimes->{{3.6763750814425983`*^9, 3.676375084538327*^9}, {
  3.6767182764848547`*^9, 3.676718280012918*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "PairwiseComparison", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$PairwiseComparisonFilenameA", "=", "None"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$PairwiseComparisonFilenameB", "=", "None"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PairwiseComparison", "::", "warn"}], "=", 
    "\"\<Warning: ``\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PairwiseComparison", "[", "]"}], ":=", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "filenames", ",", "namea", ",", "nameb", ",", "rawa", ",", "rawb", ",", 
       "timingsa", ",", "timingsb", ",", "theta"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"filenames", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[Rule]", 
           RowBox[{"FileBaseName", "[", "#", "]"}]}], "&"}], ",", 
         RowBox[{"FileNames", "[", 
          RowBox[{"\"\<*.json\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"NotebookDirectory", "[", "]"}], ",", 
               "\"\<results\>\""}], "}"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"fna", "===", "None"}], "||", 
           RowBox[{"fnb", "===", "None"}]}], ",", 
          RowBox[{
          "Style", "[", 
           "\"\<Please select two benchmarking results files to be \
compared.\>\"", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rawa", "=", 
            RowBox[{"Import", "[", "fna", "]"}]}], ";", 
           RowBox[{"rawb", "=", 
            RowBox[{"Import", "[", "fnb", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"$PairwiseComparisonFilenameA", "=", "fna"}], ";", 
           RowBox[{"$PairwiseComparisonFilenameB", "=", "fnb"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"namea", ",", "nameb"}], "}"}], "=", " ", 
            RowBox[{"NamesJoin", "[", 
             RowBox[{
              RowBox[{"\"\<Benchmark\>\"", "/.", "rawa"}], ",", 
              RowBox[{"\"\<Benchmark\>\"", "/.", "rawb"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"timingsa", "=", 
            RowBox[{"\"\<Timings\>\"", "/.", "rawa"}]}], ";", 
           RowBox[{"timingsb", "=", 
            RowBox[{"\"\<Timings\>\"", "/.", "rawb"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"theta", "=", 
            RowBox[{"\"\<Theta\>\"", "/.", "rawa"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"theta", "\[NotEqual]", 
              RowBox[{"(", 
               RowBox[{"\"\<Theta\>\"", "/.", "rawb"}], ")"}]}], ",", 
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{"PairwiseComparison", "::", "warn"}], ",", 
               "\"\<parameters differ between files\>\""}], "]"}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"GraphicsGrid", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "theta", "]"}], "\[Equal]", "1"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"BenchmarkPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"namea", ",", "timingsa"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nameb", ",", "timingsb"}], "}"}], ",", "theta", 
                    ",", 
                    RowBox[{
                    "\"\<PlotType\>\"", "\[Rule]", "\"\<BarChart\>\""}], ",", 
                    
                    RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], ",", 
                   "SpanFromLeft"}], "}"}], "\[IndentingNewLine]", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"BenchmarkPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"namea", ",", "timingsa"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nameb", ",", "timingsb"}], "}"}], ",", "theta", 
                    ",", 
                    RowBox[{"\"\<PlotType\>\"", "\[Rule]", "\"\<Array\>\""}], 
                    ",", 
                    RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"BenchmarkPlot", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"namea", ",", "timingsa"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nameb", ",", "timingsb"}], "}"}], ",", "theta", 
                    ",", 
                    RowBox[{
                    "\"\<PlotType\>\"", "\[Rule]", "\"\<Contours\>\""}], ",", 
                    
                    RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
                  "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"BenchmarkStatistics", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"namea", ",", "timingsa"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"nameb", ",", "timingsb"}], "}"}]}], "}"}], ",", 
                   RowBox[{"Transpose", "\[Rule]", "True"}]}], "]"}], ",", 
                 "SpanFromLeft"}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Row", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", " ", 
           RowBox[{
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"fna", ",", "$PairwiseComparisonFilenameA", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<LHS\>\"", ",", "Bold"}], "]"}]}], "}"}], ",", 
               "filenames", ",", 
               RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Control", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"fnb", ",", "$PairwiseComparisonFilenameB", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<RHS\>\"", ",", "Bold"}], "]"}]}], "}"}], ",", 
               "filenames", ",", 
               RowBox[{"ControlType", "\[Rule]", "PopupMenu"}]}], "}"}], 
             "]"}]}], " ", "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"Spacer", "[", "20", "]"}]}], "]"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"ContentSize", "\[Rule]", "Full"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{"fna", ",", "fnb"}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.676357936666329*^9, 3.676357967455212*^9}, {
   3.676360150809548*^9, 3.6763601584166718`*^9}, {3.676360462949052*^9, 
   3.676360544361061*^9}, 3.6763606445574827`*^9, {3.6763607000031567`*^9, 
   3.676360760536656*^9}, {3.676360832925891*^9, 3.676360852356943*^9}, {
   3.676360887467539*^9, 3.676360918355101*^9}, {3.6763610084171*^9, 
   3.676361111882551*^9}, {3.676361169378048*^9, 3.676361175048984*^9}, {
   3.676361253453247*^9, 3.676361371216509*^9}, {3.676361436351515*^9, 
   3.676361714514735*^9}, {3.676361769064857*^9, 3.676361788512122*^9}, {
   3.676361831238534*^9, 3.676361926962335*^9}, {3.676362017279831*^9, 
   3.676362075197844*^9}, {3.6763621377070637`*^9, 3.676362138250211*^9}, {
   3.676362169489603*^9, 3.676362222798974*^9}, {3.6763736343846207`*^9, 
   3.6763736352006083`*^9}, {3.6763736660152283`*^9, 3.676373681890501*^9}, {
   3.676373810920898*^9, 3.676373812007121*^9}, {3.676373889675761*^9, 
   3.676374046989567*^9}, {3.6763740796292343`*^9, 3.676374111075036*^9}, {
   3.6763742042719593`*^9, 3.676374209175112*^9}, {3.676374866149398*^9, 
   3.6763749019471703`*^9}, {3.676374937281598*^9, 3.6763750087106256`*^9}, {
   3.676454418691578*^9, 3.676454578045763*^9}, {3.676454948670368*^9, 
   3.6764549913241453`*^9}, {3.676456698336051*^9, 3.67645677378752*^9}, {
   3.676456840121119*^9, 3.6764570098029833`*^9}, {3.676705651747398*^9, 
   3.676705660706976*^9}, {3.6767080308847647`*^9, 3.676708107480146*^9}, {
   3.676708343631001*^9, 3.6767083507258043`*^9}, {3.676708460363062*^9, 
   3.676708466353901*^9}, {3.6767179504692097`*^9, 3.676717956707376*^9}, {
   3.676717986796414*^9, 3.6767179871390047`*^9}, {3.676779153798298*^9, 
   3.676779154094049*^9}, 3.677926947996057*^9, {3.677926980450802*^9, 
   3.677927053582852*^9}, {3.6779286472625437`*^9, 3.67792866586977*^9}, {
   3.6779287225232487`*^9, 3.677928756626111*^9}, {3.677928818528656*^9, 
   3.6779288766850147`*^9}, {3.6779290464380627`*^9, 3.677929094858376*^9}, {
   3.6779291270751553`*^9, 3.67792913513095*^9}, {3.677931751414859*^9, 
   3.6779317650844793`*^9}, {3.677931804746853*^9, 3.677931908806315*^9}, {
   3.677932055735955*^9, 3.6779320638459387`*^9}, {3.677932342757573*^9, 
   3.6779323439976873`*^9}, {3.677932494446891*^9, 3.677932494590036*^9}, {
   3.677932673710655*^9, 3.6779326943814697`*^9}, {3.677933267016176*^9, 
   3.677933270997343*^9}, {3.677933319628275*^9, 3.677933351498014*^9}, {
   3.6782583758410273`*^9, 3.678258437662612*^9}, {3.678258474229404*^9, 
   3.678258525780349*^9}}]
}, Closed]]
}, Closed]],

Cell["Input / output", "Section",
 CellChangeTimes->{{3.526982503859284*^9, 3.52698250799911*^9}, {
  3.6755833200852203`*^9, 3.67558332478095*^9}}],

Cell[CellGroupData[{

Cell["Distances", "Section",
 CellChangeTimes->{{3.676705840234108*^9, 3.676705841442141*^9}, {
  3.677210454850891*^9, 3.6772104558981247`*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["p",
  FontSlant->"Italic"],
 "-norm distances"
}], "Subsection",
 CellChangeTimes->{{3.6767058427780848`*^9, 3.676705844513961*^9}, {
  3.677210457914754*^9, 3.6772104651216383`*^9}}],

Cell[CellGroupData[{

Cell["OneNormDistance", "Subsubsection",
 CellChangeTimes->{{3.676705845938011*^9, 3.676705851785695*^9}, {
  3.6767851492378387`*^9, 3.67678515103646*^9}, {3.6792102754755297`*^9, 
  3.679210280267809*^9}, {3.679291159455618*^9, 3.679291159574524*^9}, {
  3.679291198716879*^9, 3.679291198860804*^9}, {3.680405684219202*^9, 
  3.680405684891203*^9}}],

Cell[CellGroupData[{

Cell["K", "Subsubsubsection",
 CellChangeTimes->{3.679291204572694*^9}],

Cell[CellGroupData[{

Cell["Python", "Subsubsubsubsection",
 CellChangeTimes->{{3.676780818559895*^9, 3.676780820111006*^9}, {
  3.679210322526723*^9, 3.6792103233094387`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<distances_one_norm_k_py_sp_2016-08-04_08-25.json\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<distances_one_norm_k_py_cppnaive_2016-08-04_08-30.json\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<distances_one_norm_k_py_cppblas1sym_2016-08-04_08-42.json\>\"", ",",
      "\[IndentingNewLine]", 
     "\"\<distances_one_norm_k_py_cppblas1_2016-08-04_08-37.json\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<distances_one_norm_k_py_cppblas2_2016-08-04_08-57.json\>\""}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<results\>\"", 
          ",", "#"}], "}"}], "]"}], "]"}], "&"}], ",", "filenames"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"NamesJoin", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Benchmark\>\"", "/.", "#"}], "&"}], ",", "res"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BenchmarkStatistics", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"names", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Timings\>\"", "/.", "#"}], "&"}], ",", "res"}], 
        "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Transpose", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6767063688321667`*^9, 3.676706511239314*^9}, {
  3.676706972316763*^9, 3.6767069989714727`*^9}, {3.676707036139514*^9, 
  3.6767070399860363`*^9}, {3.676708369210973*^9, 3.6767083731004467`*^9}, {
  3.676708704214966*^9, 3.6767087071748867`*^9}, {3.676716020684443*^9, 
  3.676716021219853*^9}, {3.6767160986882687`*^9, 3.67671609935236*^9}, {
  3.676718004352167*^9, 3.67671823331108*^9}, {3.6767791952365637`*^9, 
  3.676779212131809*^9}, {3.6792102858048553`*^9, 3.679210314234125*^9}, {
  3.679212245605389*^9, 3.67921225352451*^9}, {3.679212989789339*^9, 
  3.679212996045588*^9}, {3.6792894360213346`*^9, 3.679289479556967*^9}, {
  3.67929007588305*^9, 3.679290079202978*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", "\<\"SciPy\"\>", "\<\"C++/naive\"\>", \
"\<\"C++/BLAS/v1symmetric\"\>", "\<\"C++/BLAS/v1\"\>", \
"\<\"C++/BLAS/v2\"\>"},
    {"\<\"\[CapitalSigma]t/s\"\>", "21.89671019921578`", "45.64056509442032`", 
     ItemBox["18.92041543462257`",
      BaseStyle->Bold,
      StripOnInput->False], "38.484363684764`", "19.326157659740005`"},
    {"\<\"best t/%\"\>", "5", "19", 
     ItemBox["55",
      BaseStyle->Bold,
      StripOnInput->False], "0", "21"}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.6792900826905727`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Mathematica", "Subsubsubsubsection",
 CellChangeTimes->{{3.676780818559895*^9, 3.676780820111006*^9}, {
  3.679210322526723*^9, 3.6792103233094387`*^9}, {3.679305737940785*^9, 
  3.6793057388959513`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<distances_one_norm_k_mm_mm_2016-08-04_15-07.json\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<distances_one_norm_k_mm_cppblas2_2016-08-04_15-17.json\>\""}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<results\>\"", 
          ",", "#"}], "}"}], "]"}], "]"}], "&"}], ",", "filenames"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"NamesJoin", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Benchmark\>\"", "/.", "#"}], "&"}], ",", "res"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BenchmarkStatistics", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"names", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Timings\>\"", "/.", "#"}], "&"}], ",", "res"}], 
        "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Transpose", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6767063688321667`*^9, 3.676706511239314*^9}, {
  3.676706972316763*^9, 3.6767069989714727`*^9}, {3.676707036139514*^9, 
  3.6767070399860363`*^9}, {3.676708369210973*^9, 3.6767083731004467`*^9}, {
  3.676708704214966*^9, 3.6767087071748867`*^9}, {3.676716020684443*^9, 
  3.676716021219853*^9}, {3.6767160986882687`*^9, 3.67671609935236*^9}, {
  3.676718004352167*^9, 3.67671823331108*^9}, {3.6767791952365637`*^9, 
  3.676779212131809*^9}, {3.6792102858048553`*^9, 3.679210314234125*^9}, {
  3.679212245605389*^9, 3.67921225352451*^9}, {3.679212989789339*^9, 
  3.679212996045588*^9}, {3.6792894360213346`*^9, 3.679289479556967*^9}, {
  3.67929007588305*^9, 3.679290079202978*^9}, {3.679305741948399*^9, 
  3.679305764341848*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", "\<\"Mathematica\"\>", "\<\"C++/BLAS/v2\"\>"},
    {"\<\"\[CapitalSigma]t/s\"\>", "113.9379403487`", 
     ItemBox["19.184499420530003`",
      BaseStyle->Bold,
      StripOnInput->False]},
    {"\<\"best t/%\"\>", "0", 
     ItemBox["100",
      BaseStyle->Bold,
      StripOnInput->False]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.6793057654856358`*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["L", "Subsubsubsection",
 CellChangeTimes->{3.6792912115489597`*^9}],

Cell[CellGroupData[{

Cell["Python", "Subsubsubsubsection",
 CellChangeTimes->{{3.676780818559895*^9, 3.676780820111006*^9}, {
  3.679210322526723*^9, 3.6792103233094387`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<distances_one_norm_l_py_cppnaive_2016-08-04_09-05.json\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<distances_one_norm_l_py_cppblas_2016-08-04_09-14.json\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<distances_one_norm_l_py_cppblas2_2016-08-04_09-24.json\>\""}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<results\>\"", 
          ",", "#"}], "}"}], "]"}], "]"}], "&"}], ",", "filenames"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"NamesJoin", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Benchmark\>\"", "/.", "#"}], "&"}], ",", "res"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BenchmarkStatistics", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"names", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Timings\>\"", "/.", "#"}], "&"}], ",", "res"}], 
        "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Transpose", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6767063688321667`*^9, 3.676706511239314*^9}, {
  3.676706972316763*^9, 3.6767069989714727`*^9}, {3.676707036139514*^9, 
  3.6767070399860363`*^9}, {3.676708369210973*^9, 3.6767083731004467`*^9}, {
  3.676708704214966*^9, 3.6767087071748867`*^9}, {3.676716020684443*^9, 
  3.676716021219853*^9}, {3.6767160986882687`*^9, 3.67671609935236*^9}, {
  3.676718004352167*^9, 3.67671823331108*^9}, {3.6767791952365637`*^9, 
  3.676779212131809*^9}, {3.6792102858048553`*^9, 3.679210314234125*^9}, {
  3.679212245605389*^9, 3.67921225352451*^9}, {3.679212989789339*^9, 
  3.679212996045588*^9}, {3.6792894360213346`*^9, 3.679289479556967*^9}, {
  3.67929007588305*^9, 3.679290079202978*^9}, {3.679291219077153*^9, 
  3.67929124380586*^9}, {3.679291827611517*^9, 3.6792918298201313`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", "\<\"naive\"\>", "\<\"BLAS\"\>", "\<\"BLAS/v2\"\>"},
    {"\<\"\[CapitalSigma]t/s\"\>", "45.763401582558`", "38.62221878418343`", 
     ItemBox["36.20679698443708`",
      BaseStyle->Bold,
      StripOnInput->False]},
    {"\<\"best t/%\"\>", "38", "2", 
     ItemBox["60",
      BaseStyle->Bold,
      StripOnInput->False]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.6792918345681133`*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["EuclideanDistance", "Subsubsection",
 CellChangeTimes->{{3.676705845938011*^9, 3.676705851785695*^9}, {
  3.6767851492378387`*^9, 3.67678515103646*^9}, {3.680405674603672*^9, 
  3.680405682603231*^9}}],

Cell[CellGroupData[{

Cell["K", "Subsubsubsection",
 CellChangeTimes->{{3.68040922997871*^9, 3.680409231135627*^9}}],

Cell[CellGroupData[{

Cell["Mathematica", "Subsubsubsubsection",
 CellChangeTimes->{{3.676780818559895*^9, 3.676780820111006*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<distances_euclidean_k_mm_mm_2016-08-17_09-43.json\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<distances_euclidean_k_mm_cppnaive_2016-08-17_09-47.json\>\""}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<results\>\"", 
          ",", "#"}], "}"}], "]"}], "]"}], "&"}], ",", "filenames"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"NamesJoin", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Benchmark\>\"", "/.", "#"}], "&"}], ",", "res"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BenchmarkStatistics", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"names", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Timings\>\"", "/.", "#"}], "&"}], ",", "res"}], 
        "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Transpose", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6767063688321667`*^9, 3.676706511239314*^9}, {
   3.676706972316763*^9, 3.6767069989714727`*^9}, {3.676707036139514*^9, 
   3.6767070399860363`*^9}, {3.676708369210973*^9, 3.6767083731004467`*^9}, {
   3.676708704214966*^9, 3.6767087071748867`*^9}, {3.676716020684443*^9, 
   3.676716021219853*^9}, {3.6767160986882687`*^9, 3.67671609935236*^9}, {
   3.676718004352167*^9, 3.67671823331108*^9}, {3.6767791952365637`*^9, 
   3.676779212131809*^9}, {3.676785004602377*^9, 3.676785033316127*^9}, 
   3.67678512300648*^9, {3.68040571009628*^9, 3.680405717932701*^9}, {
   3.680409177289514*^9, 3.6804092050584717`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", "\<\"Mathematica\"\>", "\<\"C++/naive\"\>"},
    {"\<\"\[CapitalSigma]t/s\"\>", "23.683217724200002`", 
     ItemBox["2.7849095101`",
      BaseStyle->Bold,
      StripOnInput->False]},
    {"\<\"best t/%\"\>", "5", 
     ItemBox["95",
      BaseStyle->Bold,
      StripOnInput->False]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.680409236364173*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Python", "Subsubsubsubsection",
 CellChangeTimes->{{3.676785119958153*^9, 3.676785120589604*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<distances_euclidean_k_py_scipy_2016-08-17_06-47.json\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<distances_euclidean_k_py_cppnaivestdlib_2016-08-17_06-41.json\>\""}]\
, "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<results\>\"", 
          ",", "#"}], "}"}], "]"}], "]"}], "&"}], ",", "filenames"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"NamesJoin", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Benchmark\>\"", "/.", "#"}], "&"}], ",", "res"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BenchmarkStatistics", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"names", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Timings\>\"", "/.", "#"}], "&"}], ",", "res"}], 
        "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Transpose", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6767063688321667`*^9, 3.676706511239314*^9}, {
   3.676706972316763*^9, 3.6767069989714727`*^9}, {3.676707036139514*^9, 
   3.6767070399860363`*^9}, {3.676708369210973*^9, 3.6767083731004467`*^9}, {
   3.676708704214966*^9, 3.6767087071748867`*^9}, {3.676716020684443*^9, 
   3.676716021219853*^9}, {3.6767160986882687`*^9, 3.67671609935236*^9}, {
   3.676718004352167*^9, 3.67671823331108*^9}, {3.6767791952365637`*^9, 
   3.676779212131809*^9}, {3.676785004602377*^9, 3.676785033316127*^9}, 
   3.67678512300648*^9, {3.68040571009628*^9, 3.680405717932701*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", "\<\"SciPy\"\>", "\<\"C++/naivestdlib\"\>"},
    {"\<\"\[CapitalSigma]t/s\"\>", "22.010861956740403`", 
     ItemBox["2.717424661184238`",
      BaseStyle->Bold,
      StripOnInput->False]},
    {"\<\"best t/%\"\>", "17", 
     ItemBox["83",
      BaseStyle->Bold,
      StripOnInput->False]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.676785084581896*^9, 3.676785125039423*^9, 
  3.680405721538904*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["SquaredEuclideanDistance", "Subsubsection",
 CellChangeTimes->{{3.676705845938011*^9, 3.676705851785695*^9}, {
  3.6767851492378387`*^9, 3.67678515103646*^9}, {3.680405687803076*^9, 
  3.6804056880909986`*^9}}],

Cell[CellGroupData[{

Cell["Mathematica", "Subsubsubsection",
 CellChangeTimes->{{3.676780818559895*^9, 3.676780820111006*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<numerics_distances_squared_euclidean_k_mm_mm_2016-07-05_12-44.json\>\
\"", ",", "\[IndentingNewLine]", 
     "\"\<numerics_distances_squared_euclidean_k_mm_cppnaive_2016-07-05_12-36.\
json\>\"", ",", "\[IndentingNewLine]", 
     "\"\<numerics_distances_squared_euclidean_k_mm_cppblas_2016-07-06_09-27.\
json\>\""}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<results\>\"", 
          ",", "#"}], "}"}], "]"}], "]"}], "&"}], ",", "filenames"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"NamesJoin", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Benchmark\>\"", "/.", "#"}], "&"}], ",", "res"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BenchmarkStatistics", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"names", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Timings\>\"", "/.", "#"}], "&"}], ",", "res"}], 
        "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Transpose", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6767063688321667`*^9, 3.676706511239314*^9}, {
  3.676706972316763*^9, 3.6767069989714727`*^9}, {3.676707036139514*^9, 
  3.6767070399860363`*^9}, {3.676708369210973*^9, 3.6767083731004467`*^9}, {
  3.676708704214966*^9, 3.6767087071748867`*^9}, {3.676716020684443*^9, 
  3.676716021219853*^9}, {3.6767160986882687`*^9, 3.67671609935236*^9}, {
  3.676718004352167*^9, 3.67671823331108*^9}, {3.6767791952365637`*^9, 
  3.676779212131809*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", "\<\"Mathematica\"\>", "\<\"C++/naive\"\>", \
"\<\"C++/BLAS\"\>"},
    {"\<\"\[CapitalSigma]t/s\"\>", "265.0339954113`", "45.71113832273`", 
     ItemBox["2.0673465288`",
      BaseStyle->Bold,
      StripOnInput->False]},
    {"\<\"best t/%\"\>", "0", "19", 
     ItemBox["81",
      BaseStyle->Bold,
      StripOnInput->False]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.676780259905254*^9, 3.676780302854866*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Python", "Subsubsubsection",
 CellChangeTimes->{{3.676785119958153*^9, 3.676785120589604*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<numerics_distances_squared_euclidean_k_py_sp_2016-07-06_08-59.json\>\
\"", ",", "\[IndentingNewLine]", 
     "\"\<numerics_distances_squared_euclidean_k_py_cppblas_2016-07-06_09-06.\
json\>\""}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<results\>\"", 
          ",", "#"}], "}"}], "]"}], "]"}], "&"}], ",", "filenames"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"NamesJoin", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Benchmark\>\"", "/.", "#"}], "&"}], ",", "res"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BenchmarkStatistics", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"names", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Timings\>\"", "/.", "#"}], "&"}], ",", "res"}], 
        "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Transpose", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6767063688321667`*^9, 3.676706511239314*^9}, {
   3.676706972316763*^9, 3.6767069989714727`*^9}, {3.676707036139514*^9, 
   3.6767070399860363`*^9}, {3.676708369210973*^9, 3.6767083731004467`*^9}, {
   3.676708704214966*^9, 3.6767087071748867`*^9}, {3.676716020684443*^9, 
   3.676716021219853*^9}, {3.6767160986882687`*^9, 3.67671609935236*^9}, {
   3.676718004352167*^9, 3.67671823331108*^9}, {3.6767791952365637`*^9, 
   3.676779212131809*^9}, {3.676785004602377*^9, 3.676785033316127*^9}, 
   3.67678512300648*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", "\<\"SciPy\"\>", "\<\"C++/BLAS\"\>"},
    {"\<\"\[CapitalSigma]t/s\"\>", "22.061218650637915`", 
     ItemBox["2.122120710877128`",
      BaseStyle->Bold,
      StripOnInput->False]},
    {"\<\"best t/%\"\>", "0", 
     ItemBox["100",
      BaseStyle->Bold,
      StripOnInput->False]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.676785084581896*^9, 3.676785125039423*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Kernels", "Section",
 CellChangeTimes->{{3.675583330533601*^9, 3.675583331092876*^9}}],

Cell[CellGroupData[{

Cell["Centering kernel matrices", "Subsection",
 CellChangeTimes->{{3.677210483552908*^9, 3.677210486536837*^9}, {
  3.6782585744324427`*^9, 3.678258579127735*^9}}],

Cell[CellGroupData[{

Cell["Mathematica", "Subsubsubsection",
 CellChangeTimes->{{3.677210493728554*^9, 3.677210495256406*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<kernels_centering_k_mm-cpp1_2016-07-23_12-16.json\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<kernels_centering_k_mm-cpp2_2016-07-23_12-19.json\>\""}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"resultsDir", ",", "#"}], "}"}], "]"}], "&"}], ",", 
     "filenames"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Import", ",", "filenames"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"NamesJoin", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Benchmark\>\"", "/.", "#"}], "&"}], ",", "res"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BenchmarkStatistics", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"names", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Timings\>\"", "/.", "#"}], "&"}], ",", "res"}], 
        "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Transpose", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6767063688321667`*^9, 3.676706511239314*^9}, {
  3.676706972316763*^9, 3.6767069989714727`*^9}, {3.676707036139514*^9, 
  3.6767070399860363`*^9}, {3.676708369210973*^9, 3.6767083731004467`*^9}, {
  3.676708704214966*^9, 3.6767087071748867`*^9}, {3.676716020684443*^9, 
  3.676716021219853*^9}, {3.6767160986882687`*^9, 3.67671609935236*^9}, {
  3.676718004352167*^9, 3.67671823331108*^9}, {3.6767791952365637`*^9, 
  3.676779212131809*^9}, {3.6772105225341473`*^9, 3.6772105545745363`*^9}, {
  3.677210617452612*^9, 3.677210635331801*^9}, {3.677210670681959*^9, 
  3.67721067184149*^9}, {3.678258605579472*^9, 3.6782586274796267`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", "\<\"1\"\>", "\<\"2\"\>"},
    {"\<\"\[CapitalSigma]t/s\"\>", "1.21513162734`", 
     ItemBox["0.5192272083199999`",
      BaseStyle->Bold,
      StripOnInput->False]},
    {"\<\"best t/%\"\>", "0", 
     ItemBox["100",
      BaseStyle->Bold,
      StripOnInput->False]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.678258629984021*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Gaussian kernel", "Subsection",
 CellChangeTimes->{{3.677210483552908*^9, 3.677210486536837*^9}}],

Cell[CellGroupData[{

Cell["Kernel matrix K", "Subsubsection",
 CellChangeTimes->{{3.6772105393107643`*^9, 3.677210544174533*^9}}],

Cell[CellGroupData[{

Cell["Mathematica", "Subsubsubsection",
 CellChangeTimes->{{3.677210493728554*^9, 3.677210495256406*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<kernels_gaussian_k_mm-cppnaive_2016-07-11_09-10.json\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<kernels_gaussian_k_mm-cppblas_2016-07-11_09-17.json\>\""}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"resultsDir", ",", "#"}], "}"}], "]"}], "&"}], ",", 
     "filenames"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Import", ",", "filenames"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"NamesJoin", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Benchmark\>\"", "/.", "#"}], "&"}], ",", "res"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BenchmarkStatistics", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"names", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Timings\>\"", "/.", "#"}], "&"}], ",", "res"}], 
        "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Transpose", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6767063688321667`*^9, 3.676706511239314*^9}, {
  3.676706972316763*^9, 3.6767069989714727`*^9}, {3.676707036139514*^9, 
  3.6767070399860363`*^9}, {3.676708369210973*^9, 3.6767083731004467`*^9}, {
  3.676708704214966*^9, 3.6767087071748867`*^9}, {3.676716020684443*^9, 
  3.676716021219853*^9}, {3.6767160986882687`*^9, 3.67671609935236*^9}, {
  3.676718004352167*^9, 3.67671823331108*^9}, {3.6767791952365637`*^9, 
  3.676779212131809*^9}, {3.6772105225341473`*^9, 3.6772105545745363`*^9}, {
  3.677210617452612*^9, 3.677210635331801*^9}, {3.677210670681959*^9, 
  3.67721067184149*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", "\<\"naive\"\>", "\<\"BLAS\"\>"},
    {"\<\"\[CapitalSigma]t/s\"\>", "42.36085232741`", 
     ItemBox["2.71677044012`",
      BaseStyle->Bold,
      StripOnInput->False]},
    {"\<\"best t/%\"\>", "12", 
     ItemBox["88",
      BaseStyle->Bold,
      StripOnInput->False]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.677210557761368*^9, 3.677210636617134*^9, 
  3.67721067623958*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kernel matrix M diagonal", "Subsubsection",
 CellChangeTimes->{{3.677413686407568*^9, 3.677413689894575*^9}, {
  3.678258650790394*^9, 3.678258652492673*^9}}],

Cell[CellGroupData[{

Cell["Mathematica", "Subsubsubsection",
 CellChangeTimes->{{3.677413701134802*^9, 3.677413703606114*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<kernels_gaussian_m_mm-cpp_2016-07-13_17-42.json\>\"", ",", 
     "\[IndentingNewLine]", 
     "\"\<kernels_gaussian_m_mm-mm_2016-07-13_17-38.json\>\""}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"resultsDir", ",", "#"}], "}"}], "]"}], "&"}], ",", 
     "filenames"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Import", ",", "filenames"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"NamesJoin", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Benchmark\>\"", "/.", "#"}], "&"}], ",", "res"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BenchmarkStatistics", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"names", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Timings\>\"", "/.", "#"}], "&"}], ",", "res"}], 
        "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Transpose", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6767063688321667`*^9, 3.676706511239314*^9}, {
  3.676706972316763*^9, 3.6767069989714727`*^9}, {3.676707036139514*^9, 
  3.6767070399860363`*^9}, {3.676708369210973*^9, 3.6767083731004467`*^9}, {
  3.676708704214966*^9, 3.6767087071748867`*^9}, {3.676716020684443*^9, 
  3.676716021219853*^9}, {3.6767160986882687`*^9, 3.67671609935236*^9}, {
  3.676718004352167*^9, 3.67671823331108*^9}, {3.6767791952365637`*^9, 
  3.676779212131809*^9}, {3.6772105225341473`*^9, 3.6772105545745363`*^9}, {
  3.677210617452612*^9, 3.677210635331801*^9}, {3.677210670681959*^9, 
  3.67721067184149*^9}, {3.677413803410475*^9, 3.677413843728496*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", "\<\"C++\"\>", "\<\"native\"\>"},
    {"\<\"\[CapitalSigma]t/s\"\>", "0.00039303954000000004`", 
     ItemBox["0.00038284053`",
      BaseStyle->Bold,
      StripOnInput->False]},
    {"\<\"best t/%\"\>", "5", 
     ItemBox["95",
      BaseStyle->Bold,
      StripOnInput->False]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.6774138456638947`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear kernel", "Subsection",
 CellChangeTimes->{{3.675583336461198*^9, 3.675583337660679*^9}}],

Cell[CellGroupData[{

Cell["Kernel matrix K", "Subsubsection",
 CellChangeTimes->{{3.676182556540422*^9, 3.676182558027754*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"filenames", "=", 
  RowBox[{"FileNames", "[", 
   RowBox[{
    RowBox[{"{", "\"\<kernels_linear_k_*.json\>\"", "}"}], ",", 
    RowBox[{"{", "resultsDir", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6761827004509*^9, 3.676182759380321*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"/Users/rupp/Data/Projects/qmmlpackgit/benchmark/results/\
kernels_linear_k_cppblas_2016-06-29_17-21.json\"\>", 
   ",", "\<\"/Users/rupp/Data/Projects/qmmlpackgit/benchmark/results/kernels_\
linear_k_mm_2016-06-29_17-26.json\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.676182759871006*^9, 3.676184780940323*^9, 
  3.676185313898294*^9, 3.6762030567776117`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dataA", "=", 
  RowBox[{"Import", "[", 
   RowBox[{"filenames", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.676182776947575*^9, 3.676182783194618*^9}, {
  3.676183785531748*^9, 3.6761837885792627`*^9}, {3.6761847907541428`*^9, 
  3.676184790802185*^9}, {3.676185326716443*^9, 3.6761853275803823`*^9}, {
  3.676185385652178*^9, 3.6761853857460947`*^9}, {3.676203059613318*^9, 
  3.676203059947342*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"System\"\>", 
    "\[Rule]", "\<\"aurum, MacOSX-x86-64, Mathematica 10.4\"\>"}], ",", 
   RowBox[{"\<\"DateTime\"\>", "\[Rule]", "\<\"2016-06-29_17-21\"\>"}], ",", 
   RowBox[{"\<\"Benchmark\"\>", 
    "\[Rule]", "\<\"Linear kernel (K), C++/BLAS\"\>"}], ",", 
   RowBox[{"\<\"Theta\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"10", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "300"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "1000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "10000"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"50", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "300"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "1000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "10000"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"100", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "300"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "1000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "10000"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"500", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "300"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "1000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "10000"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1000", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "300"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "1000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "10000"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"5000", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5000", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5000", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5000", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5000", ",", "300"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5000", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5000", ",", "1000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5000", ",", "10000"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"10000", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10000", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10000", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10000", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10000", ",", "300"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10000", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10000", ",", "1000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10000", ",", "10000"}], "}"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"Timings\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "2.55639`*^-6", ",", "2.73153`*^-6", ",", "3.67524`*^-6", ",", 
        "4.33967`*^-6", ",", "7.78772`*^-6", ",", "0.000011235`", ",", 
        "0.0000200554`", ",", "0.000174326`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "4.53436`*^-6", ",", "5.4994`*^-6", ",", "9.56086`*^-6", ",", 
        "0.0000153248`", ",", "0.0000390527`", ",", "0.0000615994`", ",", 
        "0.000117716`", ",", "0.00111876`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.0000303105`", ",", "0.0000307203`", ",", "0.0000483457`", ",", 
        "0.0000437378`", ",", "0.0000773012`", ",", "0.00011061`", ",", 
        "0.000192304`", ",", "0.00179769`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.00032958`", ",", "0.000366918`", ",", "0.000445467`", ",", 
        "0.000530697`", ",", "0.000928251`", ",", "0.0013046`", ",", 
        "0.00241961`", ",", "0.0215972`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.00337852`", ",", "0.00349417`", ",", "0.0035395`", ",", 
        "0.00395998`", ",", "0.0044047`", ",", "0.00593197`", ",", 
        "0.00990704`", ",", "0.0797024`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.22433`", ",", "0.227505`", ",", "0.230728`", ",", "0.234845`", ",", 
        "0.273623`", ",", "0.315843`", ",", "0.41531`", ",", "2.19728`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "1.03516`", ",", "1.05112`", ",", "1.06692`", ",", "1.09337`", ",", 
        "1.24163`", ",", "1.39988`", ",", "1.8169`", ",", "8.86069`"}], 
       "}"}]}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6761827839017897`*^9, 3.676183789630908*^9, 
  3.6761847912902203`*^9, 3.676185328006077*^9, 3.6761853863352947`*^9, 
  3.676203060607383*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dataB", "=", 
  RowBox[{"Import", "[", 
   RowBox[{"filenames", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.676182776947575*^9, 3.676182783194618*^9}, {
  3.676183785531748*^9, 3.676183795186866*^9}, {3.676184793745998*^9, 
  3.676184793778385*^9}, {3.676185329628335*^9, 3.676185329676313*^9}, {
  3.676185387834208*^9, 3.676185387868515*^9}, {3.676203062899373*^9, 
  3.676203062955514*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"System\"\>", 
    "\[Rule]", "\<\"aurum, MacOSX-x86-64, Mathematica 10.4\"\>"}], ",", 
   RowBox[{"\<\"DateTime\"\>", "\[Rule]", "\<\"2016-06-29_17-26\"\>"}], ",", 
   RowBox[{"\<\"Benchmark\"\>", 
    "\[Rule]", "\<\"Linear kernel (K), Mathematica native\"\>"}], ",", 
   RowBox[{"\<\"Theta\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"10", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "300"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "1000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "10000"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"50", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "300"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "1000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "10000"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"100", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "300"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "1000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "10000"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"500", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "300"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "1000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", "10000"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1000", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "300"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "1000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1000", ",", "10000"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"5000", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5000", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5000", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5000", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5000", ",", "300"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5000", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5000", ",", "1000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5000", ",", "10000"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"10000", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10000", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10000", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10000", ",", "100"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10000", ",", "300"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10000", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10000", ",", "1000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10000", ",", "10000"}], "}"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"Timings\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "2.26538`*^-6", ",", "4.35092`*^-6", ",", "0.0000144059`", ",", 
        "3.66597`*^-6", ",", "9.07966`*^-6", ",", "0.000013075`", ",", 
        "0.0000232543`", ",", "0.000187071`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.000012966`", ",", "7.71626`*^-6", ",", "0.0000123267`", ",", 
        "0.0000203534`", ",", "0.0000480747`", ",", "0.0000769528`", ",", 
        "0.000125796`", ",", "0.00146256`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.0000120779`", ",", "0.000017232`", ",", "0.0000296852`", ",", 
        "0.000043161`", ",", "0.000105897`", ",", "0.000196356`", ",", 
        "0.000427219`", ",", "0.00632183`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.000233863`", ",", "0.000262958`", ",", "0.000452349`", ",", 
        "0.000662754`", ",", "0.00162521`", ",", "0.00273688`", ",", 
        "0.00546703`", ",", "0.0565554`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.00239468`", ",", "0.00295365`", ",", "0.0033196`", ",", 
        "0.00402664`", ",", "0.00705692`", ",", "0.0103349`", ",", 
        "0.0199159`", ",", "0.166051`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.0647951`", ",", "0.067359`", ",", "0.0780056`", ",", "0.0901091`", 
        ",", "0.149058`", ",", "0.20344`", ",", "0.355314`", ",", "3.0561`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.217246`", ",", "0.232465`", ",", "0.285693`", ",", "0.338971`", ",",
         "0.550387`", ",", "0.764498`", ",", "1.35981`", ",", "11.5686`"}], 
       "}"}]}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6761837955840397`*^9, 3.676184794101918*^9, 
  3.676185329996731*^9, 3.676185388202361*^9, 3.676203063306823*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"BenchmarkPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Benchmark\>\"", "/.", "dataA"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"\"\<Timings\>\"", "/.", "dataA"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Benchmark\>\"", "/.", "dataB"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"\"\<Timings\>\"", "/.", "dataB"}], "]"}]}], "}"}], ",", 
   RowBox[{"Reverse", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<n\>\"", ",", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\"\<Theta\>\"", "/.", "dataA"}], ")"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
          "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<d\>\"", ",", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\"\<Theta\>\"", "/.", "dataA"}], ")"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}], 
          "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.676183808412572*^9, 3.676183830281539*^9}, {
  3.676184049984816*^9, 3.676184115357873*^9}, {3.676184322341111*^9, 
  3.676184351692178*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear kernel", "Subsection",
 CellChangeTimes->{{3.675583336461198*^9, 3.675583337660679*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "[2016-06-22] K: MM/WVM vs C++ (2015)  ",
 StyleBox["[mixed]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.6755833406524754`*^9, 3.6755834054017553`*^9}, {
  3.6755834831665173`*^9, 3.675583493822259*^9}, {3.675671669746537*^9, 
  3.675671670266548*^9}, {3.6756721409375134`*^9, 3.675672142359215*^9}}],

Cell["\<\
iMac, 3.5 GHz Intel Core i5, 16 GB RAM, OS 10.11.5; Mathematica 10.4.1\
\>", "Text",
 CellChangeTimes->{{3.675670549705044*^9, 3.675670606118071*^9}}],

Cell[CellGroupData[{

Cell["Grid", "Subsubsubsection",
 CellChangeTimes->{{3.6756704065181637`*^9, 3.675670406934144*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ngrid", "=", 
   RowBox[{"{", 
    RowBox[{
    "10", ",", "50", ",", "100", ",", "500", ",", "1000", ",", "5000", ",", 
     "10000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dgrid", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "10", ",", "50", ",", "100", ",", "300", ",", "500", ",", 
     "1000", ",", "10000"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67558352273318*^9, 3.675583563019446*^9}, {
   3.675583608713636*^9, 3.675583649895831*^9}, {3.675583696238008*^9, 
   3.675583714501089*^9}, {3.675587885606567*^9, 3.675587975313457*^9}, {
   3.675597707014162*^9, 3.675597724317615*^9}, 3.675598116733819*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "bm", "]"}], ";", 
  RowBox[{
   RowBox[{"bm", "[", 
    RowBox[{"f_", ",", "n_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xx", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"First", "[", 
       RowBox[{"RepeatedTiming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "xx", "]"}], ";"}], ",", "3"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6755865239218893`*^9, 3.6755865623938217`*^9}, {
  3.675586650278653*^9, 3.675586650734549*^9}, {3.6755879791616163`*^9, 
  3.675587979241152*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["C++ (2015) implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<QMMLPack`\>\"", "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"old", " ", "version", " ", 
    RowBox[{"C", "++"}], " ", "implementation"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.675583416488957*^9, 3.67558343580858*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingscpp", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"KernelLinear", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}]}], "]"}], "&"}], ")"}], ",", "n", ",", "d"}], 
       "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6755837310841618`*^9, 3.675583781105747*^9}, {
   3.675583812401144*^9, 3.6755838144811172`*^9}, {3.675584401481059*^9, 
   3.675584413088552*^9}, {3.675584552835106*^9, 3.6755845594826393`*^9}, {
   3.675585593154819*^9, 3.675585595441177*^9}, {3.675586438711046*^9, 
   3.675586439014894*^9}, {3.675586566584388*^9, 3.675586580969152*^9}, {
   3.675591918506966*^9, 3.67559192155416*^9}, 3.6755977433728247`*^9, {
   3.675598062822199*^9, 3.6755980708837976`*^9}, {3.6755981035665407`*^9, 
   3.675598107869968*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.43566874220050004501035220694227`3.*^-6", ",", 
     "2.66535626710766275498801572418905`3.*^-6", ",", 
     "3.49416165146531485226713033276358`3.*^-6", ",", 
     "4.24950036337209593730003184819388`3.*^-6", ",", 
     "7.78461082945478826809922179297274`3.*^-6", ",", 
     "0.00001120001647088770254463620940077462`3.", ",", 
     "0.00001965654217880029544398938490257223`3.", ",", 
     "0.00017511489661654143349701906462456691`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.73663567877435130688617767602544`3.*^-6", ",", 
     "5.86601484061244873760131851581079`3.*^-6", ",", 
     "9.95484042730207838818243248901751`3.*^-6", ",", 
     "0.00001586270265682029981810577390355377`3.", ",", 
     "0.00003960912258473237658506008185277381`3.", ",", 
     "0.00006194630369630373415909541101598279`3.", ",", 
     "0.00011821484003801086232025852051918946`3.", ",", 
     "0.00113919680851063808563194967859999451`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00003312740363314134499827731672461084`3.", ",", 
     "0.00003352946990116802226250536378415745`3.", ",", 
     "0.00005526322272134471982451414673320755`2.", ",", 
     "0.00004666542727698798251030967709773734`3.", ",", 
     "0.00008039817612777898565065010094699005`3.", ",", 
     "0.00011302562936002429690336701373354344`3.", ",", 
     "0.00019534840146750515532322878264892552`3.", ",", 
     "0.00180985818181818238110925012307461657`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00042696885813148796953719887881106843`2.", ",", 
     "0.00045176781400966186741721686281891834`3.", ",", 
     "0.00052451090781140043833863373379244877`2.", ",", 
     "0.00064093177966101702851958732409798358`2.", ",", 
     "0.00107234913793103443443999189810256212`2.", ",", 
     "0.00151208841463414643546681048746904708`2.", ",", 
     "0.00267377355072463728305476315938449261`2.", ",", 
     "0.02158539705882353207377910564446210628`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00211295460992907838462806502377588913`3.", ",", 
     "0.0022026785185185189346046552572033761`2.", ",", 
     "0.00247295666666666859659362565082574292`2.", ",", 
     "0.00333822629310345005831939246832007484`1.", ",", 
     "0.00490841721854304302574689700122689828`2.", ",", 
     "0.00633394042553191236738507896575356426`2.", ",", 
     "0.01040435211267605464247054669613135047`2.", ",", 
     "0.0829067777777777736858411117282230407`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.23403450000000000641442454707430442795`3.", ",", 
     "0.23650850000000001038813479681266471744`3.", ",", 
     "0.24076166666666667937057866311079123989`3.", ",", 
     "0.247778166666666660455931037176924292`3.", ",", 
     "0.28640579999999998817017399233009200543`3.", ",", 
     "0.32611750000000000460076421404664870352`3.", ",", 
     "0.4332309999999999772235526052099885419`3.", ",", 
     "2.23287000000000013244516594568267464638`4."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.0614330000000000708837433194275945425`3.", ",", 
     "1.07826200000000005374545253289397805929`4.", ",", 
     "1.09697500000000003339550858072470873594`4.", ",", 
     "1.15000299999999988642684911610558629036`2.", ",", 
     "1.26901900000000011914380593225359916687`3.", ",", 
     "1.42939900000000008617462299298495054245`4.", ",", 
     "1.8621414999999998940438672434538602829`3.", ",", 
     "8.94790850000000048680703912395983934402`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675598370195902*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compiled WVM implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.6755864457108727`*^9, 
  3.675586449781939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"xx", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"xx", ".", 
      RowBox[{"Transpose", "[", "xx", "]"}]}], ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<WVM\>\""}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675586464865552*^9, 3.675586496244589*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingswvm", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{"f", ",", "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675586499328845*^9, 3.675586507980432*^9}, {
  3.675586625392827*^9, 3.6755866275113153`*^9}, {3.675598385665947*^9, 
  3.675598412625558*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.36420138484390034579977080825275`2.*^-6", ",", 
     "3.49557509718899234039046416966379`2.*^-6", ",", 
     "0.00001367377716769617566775017053481989`3.", ",", 
     "2.73838914735487125727184630485933`3.*^-6", ",", 
     "8.04046295501373200608624669527558`3.*^-6", ",", 
     "0.0000122859197302300928686695155600539`2.", ",", 
     "0.00002213872858096579905639103569292558`2.", ",", 
     "0.00026774209770114953781117161923930325`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001448319678496544378042566042497086`3.", ",", 
     "9.2183049841772227774592055049574`3.*^-6", ",", 
     "0.00001380677777777778869746586748457062`2.", ",", 
     "0.00002181486344537815911452487138699752`2.", ",", 
     "0.00005044803523035228836387394713014487`2.", ",", 
     "0.00008026532474503489085829177618336416`2.", ",", 
     "0.00012916562608394037544798371719423358`2.", ",", 
     "0.00236050949367088607269704603197624238`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00002233569100929554861667200582608928`3.", ",", 
     "0.00002923260647893952837261637156540672`2.", ",", 
     "0.00004086755094194541293711048224324145`2.", ",", 
     "0.00005315508135883532681584609513869566`2.", ",", 
     "0.00011806244064577397438319666944650521`2.", ",", 
     "0.00020828951793721976228079828530326267`3.", ",", 
     "0.00044085499999999943742529096013527123`2.", ",", 
     "0.0060960819672131166119255496482765011`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00056332115963855420269490448248461689`2.", ",", 
     "0.00060041404358353528750158467630626546`2.", ",", 
     "0.00081671225382932174756411836114011749`2.", ",", 
     "0.00104775980392156917511692348909946304`2.", ",", 
     "0.00206951666666666716024036709598021844`2.", ",", 
     "0.00404076648351648411855441267448441067`2.", ",", 
     "0.00708762318840579826767500648543318675`2.", ",", 
     "0.06027347999999999039744125184370204806`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00609265447154471416479903922436278663`2.", ",", 
     "0.00643990948275862101074507037878902338`3.", ",", 
     "0.00681498623853211103751359445368507295`2.", ",", 
     "0.00732527941176470704515155674130255647`2.", ",", 
     "0.01058593571428571161741061246175377164`2.", ",", 
     "0.01489627000000000485446793874189097551`2.", ",", 
     "0.02330079687500001203726007759087224258`2.", ",", 
     "0.17498325000000003459632580415927805007`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.18588650000000001005773242468421813101`3.", ",", 
     "0.19849349999999998939159695510170422494`2.", ",", 
     "0.20191814285714287935391553219233173877`3.", ",", 
     "0.21444400000000002348699013055011164397`3.", ",", 
     "0.27578080000000004812221732208854518831`3.", ",", 
     "0.339000999999999996781241407006746158`2.", ",", 
     "0.48377933333333333898451655841199681163`3.", ",", 
     "3.22160549999999989978505254839546978474`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.70759949999999993686117250035749748349`4.", ",", 
     "0.7203935000000000199449345927860122174`3.", ",", 
     "0.76799200000000000798650034994352608919`3.", ",", 
     "0.82039649999999997298516518640099093318`3.", ",", 
     "1.03131700000000003925038072338793426752`3.", ",", 
     "1.25351349999999994722088558773975819349`3.", ",", 
     "1.84071249999999997370991877687629312277`3.", ",", 
     "12.14203200000000038016878534108400344849`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675598400629724*^9, 3.675598661550433*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Results", "Subsubsubsection",
 CellChangeTimes->{{3.675586453813734*^9, 3.675586458589772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"timingscpp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "2.43566874220050004501035220694227`3.*^-6", ",", 
       "2.66535626710766275498801572418905`3.*^-6", ",", 
       "3.49416165146531485226713033276358`3.*^-6", ",", 
       "4.24950036337209593730003184819388`3.*^-6", ",", 
       "7.78461082945478826809922179297274`3.*^-6", ",", 
       "0.00001120001647088770254463620940077462`3.", ",", 
       "0.00001965654217880029544398938490257223`3.", ",", 
       "0.00017511489661654143349701906462456691`3."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "4.73663567877435130688617767602544`3.*^-6", ",", 
       "5.86601484061244873760131851581079`3.*^-6", ",", 
       "9.95484042730207838818243248901751`3.*^-6", ",", 
       "0.00001586270265682029981810577390355377`3.", ",", 
       "0.00003960912258473237658506008185277381`3.", ",", 
       "0.00006194630369630373415909541101598279`3.", ",", 
       "0.00011821484003801086232025852051918946`3.", ",", 
       "0.00113919680851063808563194967859999451`3."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00003312740363314134499827731672461084`3.", ",", 
       "0.00003352946990116802226250536378415745`3.", ",", 
       "0.00005526322272134471982451414673320755`2.", ",", 
       "0.00004666542727698798251030967709773734`3.", ",", 
       "0.00008039817612777898565065010094699005`3.", ",", 
       "0.00011302562936002429690336701373354344`3.", ",", 
       "0.00019534840146750515532322878264892552`3.", ",", 
       "0.00180985818181818238110925012307461657`3."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00042696885813148796953719887881106843`2.", ",", 
       "0.00045176781400966186741721686281891834`3.", ",", 
       "0.00052451090781140043833863373379244877`2.", ",", 
       "0.00064093177966101702851958732409798358`2.", ",", 
       "0.00107234913793103443443999189810256212`2.", ",", 
       "0.00151208841463414643546681048746904708`2.", ",", 
       "0.00267377355072463728305476315938449261`2.", ",", 
       "0.02158539705882353207377910564446210628`3."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00211295460992907838462806502377588913`3.", ",", 
       "0.0022026785185185189346046552572033761`2.", ",", 
       "0.00247295666666666859659362565082574292`2.", ",", 
       "0.00333822629310345005831939246832007484`1.", ",", 
       "0.00490841721854304302574689700122689828`2.", ",", 
       "0.00633394042553191236738507896575356426`2.", ",", 
       "0.01040435211267605464247054669613135047`2.", ",", 
       "0.0829067777777777736858411117282230407`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.23403450000000000641442454707430442795`3.", ",", 
       "0.23650850000000001038813479681266471744`3.", ",", 
       "0.24076166666666667937057866311079123989`3.", ",", 
       "0.247778166666666660455931037176924292`3.", ",", 
       "0.28640579999999998817017399233009200543`3.", ",", 
       "0.32611750000000000460076421404664870352`3.", ",", 
       "0.4332309999999999772235526052099885419`3.", ",", 
       "2.23287000000000013244516594568267464638`4."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.0614330000000000708837433194275945425`3.", ",", 
       "1.07826200000000005374545253289397805929`4.", ",", 
       "1.09697500000000003339550858072470873594`4.", ",", 
       "1.15000299999999988642684911610558629036`2.", ",", 
       "1.26901900000000011914380593225359916687`3.", ",", 
       "1.42939900000000008617462299298495054245`4.", ",", 
       "1.8621414999999998940438672434538602829`3.", ",", 
       "8.94790850000000048680703912395983934402`3."}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timingswvm", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1.36420138484390034579977080825275`2.*^-6", ",", 
       "3.49557509718899234039046416966379`2.*^-6", ",", 
       "0.00001367377716769617566775017053481989`3.", ",", 
       "2.73838914735487125727184630485933`3.*^-6", ",", 
       "8.04046295501373200608624669527558`3.*^-6", ",", 
       "0.0000122859197302300928686695155600539`2.", ",", 
       "0.00002213872858096579905639103569292558`2.", ",", 
       "0.00026774209770114953781117161923930325`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00001448319678496544378042566042497086`3.", ",", 
       "9.2183049841772227774592055049574`3.*^-6", ",", 
       "0.00001380677777777778869746586748457062`2.", ",", 
       "0.00002181486344537815911452487138699752`2.", ",", 
       "0.00005044803523035228836387394713014487`2.", ",", 
       "0.00008026532474503489085829177618336416`2.", ",", 
       "0.00012916562608394037544798371719423358`2.", ",", 
       "0.00236050949367088607269704603197624238`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00002233569100929554861667200582608928`3.", ",", 
       "0.00002923260647893952837261637156540672`2.", ",", 
       "0.00004086755094194541293711048224324145`2.", ",", 
       "0.00005315508135883532681584609513869566`2.", ",", 
       "0.00011806244064577397438319666944650521`2.", ",", 
       "0.00020828951793721976228079828530326267`3.", ",", 
       "0.00044085499999999943742529096013527123`2.", ",", 
       "0.0060960819672131166119255496482765011`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00056332115963855420269490448248461689`2.", ",", 
       "0.00060041404358353528750158467630626546`2.", ",", 
       "0.00081671225382932174756411836114011749`2.", ",", 
       "0.00104775980392156917511692348909946304`2.", ",", 
       "0.00206951666666666716024036709598021844`2.", ",", 
       "0.00404076648351648411855441267448441067`2.", ",", 
       "0.00708762318840579826767500648543318675`2.", ",", 
       "0.06027347999999999039744125184370204806`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00609265447154471416479903922436278663`2.", ",", 
       "0.00643990948275862101074507037878902338`3.", ",", 
       "0.00681498623853211103751359445368507295`2.", ",", 
       "0.00732527941176470704515155674130255647`2.", ",", 
       "0.01058593571428571161741061246175377164`2.", ",", 
       "0.01489627000000000485446793874189097551`2.", ",", 
       "0.02330079687500001203726007759087224258`2.", ",", 
       "0.17498325000000003459632580415927805007`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.18588650000000001005773242468421813101`3.", ",", 
       "0.19849349999999998939159695510170422494`2.", ",", 
       "0.20191814285714287935391553219233173877`3.", ",", 
       "0.21444400000000002348699013055011164397`3.", ",", 
       "0.27578080000000004812221732208854518831`3.", ",", 
       "0.339000999999999996781241407006746158`2.", ",", 
       "0.48377933333333333898451655841199681163`3.", ",", 
       "3.22160549999999989978505254839546978474`3."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.70759949999999993686117250035749748349`4.", ",", 
       "0.7203935000000000199449345927860122174`3.", ",", 
       "0.76799200000000000798650034994352608919`3.", ",", 
       "0.82039649999999997298516518640099093318`3.", ",", 
       "1.03131700000000003925038072338793426752`3.", ",", 
       "1.25351349999999994722088558773975819349`3.", ",", 
       "1.84071249999999997370991877687629312277`3.", ",", 
       "12.14203200000000038016878534108400344849`3."}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.675667933182199*^9, 3.675667968122138*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<C++\>\"", ",", 
       RowBox[{"Transpose", "[", "timingscpp", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<WVM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingswvm", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<C++\>\"", ",", 
       RowBox[{"Transpose", "[", "timingscpp", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<WVM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingswvm", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"\"\<PlotType\>\"", "\[Rule]", "\"\<Contours\>\""}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"p", "=", 
  RowBox[{"Row", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2"}], "}"}], ",", 
    RowBox[{"Alignment", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Center", ",", "Bottom"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.675585228483169*^9, 3.675585231079399*^9}, {
  3.67558573270728*^9, 3.6755857761693783`*^9}, {3.67558591764384*^9, 
  3.675585921731621*^9}, {3.6755860073122683`*^9, 3.675586007368134*^9}, {
  3.675586348538485*^9, 3.675586372265463*^9}, {3.675586774097477*^9, 
  3.675586789312622*^9}, {3.67558683717619*^9, 3.67558685018228*^9}, {
  3.6755996301857357`*^9, 3.6755996849661627`*^9}, {3.675599764331643*^9, 
  3.67559984971093*^9}, {3.675599894685419*^9, 3.6755998950933037`*^9}, {
  3.675599931667879*^9, 3.675599946939253*^9}, {3.675669242085101*^9, 
  3.675669247060527*^9}, {3.675669278532414*^9, 3.675669279259132*^9}, {
  3.675669328162595*^9, 3.675669357696048*^9}, {3.675669406239079*^9, 
  3.675669408725966*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fn", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<results\>\"", ",", 
      "\"\<2016-06-22_kernel_linear_cpp_vs_wvm.pdf\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"fn", ",", "p"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6755999844355087`*^9, 3.675600044967346*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "[2016-06-23] K: MM/nat vs MM/WVM  ",
 StyleBox["[MM/nat]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.6755833406524754`*^9, 3.6755834054017553`*^9}, {
  3.6755834831665173`*^9, 3.675583493822259*^9}, {3.675670626717189*^9, 
  3.675670643484375*^9}, {3.675671662284398*^9, 3.675671662850811*^9}, {
  3.6756721496229467`*^9, 3.675672162062339*^9}, {3.675672727087734*^9, 
  3.675672735615417*^9}}],

Cell["\<\
iMac, 3.5 GHz Intel Core i5, 16 GB RAM, OS 10.11.5; Mathematica 10.4.1\
\>", "Text",
 CellChangeTimes->{{3.675670549705044*^9, 3.675670606118071*^9}}],

Cell[CellGroupData[{

Cell["Grid", "Subsubsubsection",
 CellChangeTimes->{{3.6756704065181637`*^9, 3.675670406934144*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ngrid", "=", 
   RowBox[{"{", 
    RowBox[{
    "10", ",", "50", ",", "100", ",", "500", ",", "1000", ",", "5000", ",", 
     "10000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dgrid", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "10", ",", "50", ",", "100", ",", "300", ",", "500", ",", 
     "1000", ",", "10000"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67558352273318*^9, 3.675583563019446*^9}, {
   3.675583608713636*^9, 3.675583649895831*^9}, {3.675583696238008*^9, 
   3.675583714501089*^9}, {3.675587885606567*^9, 3.675587975313457*^9}, {
   3.675597707014162*^9, 3.675597724317615*^9}, 3.675598116733819*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "bm", "]"}], ";", 
  RowBox[{
   RowBox[{"bm", "[", 
    RowBox[{"f_", ",", "n_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xx", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"First", "[", 
       RowBox[{"RepeatedTiming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "xx", "]"}], ";"}], ",", "3"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6755865239218893`*^9, 3.6755865623938217`*^9}, {
  3.675586650278653*^9, 3.675586650734549*^9}, {3.6755879791616163`*^9, 
  3.675587979241152*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["MM Native implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.675670665204402*^9, 
  3.6756706699393377`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kl", "[", "xx_", "]"}], ":=", 
   RowBox[{"xx", ".", 
    RowBox[{"Transpose", "[", "xx", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675670701628518*^9, 3.6756707087707767`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingsnat", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"kl", "[", "#", "]"}], "&"}], ")"}], ",", "n", ",", "d"}], 
       "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6755837310841618`*^9, 3.675583781105747*^9}, {
   3.675583812401144*^9, 3.6755838144811172`*^9}, {3.675584401481059*^9, 
   3.675584413088552*^9}, {3.675584552835106*^9, 3.6755845594826393`*^9}, {
   3.675585593154819*^9, 3.675585595441177*^9}, {3.675586438711046*^9, 
   3.675586439014894*^9}, {3.675586566584388*^9, 3.675586580969152*^9}, {
   3.675591918506966*^9, 3.67559192155416*^9}, 3.6755977433728247`*^9, {
   3.675598062822199*^9, 3.6755980708837976`*^9}, {3.6755981035665407`*^9, 
   3.675598107869968*^9}, {3.675670677763235*^9, 3.675670696690607*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.47494206832627109860661164530971`2.*^-6", ",", 
     "4.53635117430124346575960950223028`3.*^-6", ",", 
     "0.00001480701078582434550257821564978045`3.", ",", 
     "3.93426054267473202636327955783457`3.*^-6", ",", 
     "9.55689593545751818080488670936745`3.*^-6", ",", 
     "0.00001910535117056871292576941678831304`1.", ",", 
     "0.00002349092060810833811263821646608818`2.", ",", 
     "0.00018754587732528908488802144027829399`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0000133479555236728817622102530315864`3.", ",", 
     "8.03292947287087773548201058426699`3.*^-6", ",", 
     "0.0000129299834969165355300644085212447`2.", ",", 
     "0.00002119525448028673357591181170000993`2.", ",", 
     "0.00004904435856784264045026000555793644`3.", ",", 
     "0.00007834695378151264343914716992145486`3.", ",", 
     "0.00012740027322404373828247658995138636`2.", ",", 
     "0.00152057841140529445729534518960690548`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001243954863424384902910024147670853`3.", ",", 
     "0.0000184245321474893277466193530766958`2.", ",", 
     "0.0000301721938775510663570053604409793`2.", ",", 
     "0.0000448502284752284614138817531170389`2.", ",", 
     "0.00010872973756705817821328202699149301`2.", ",", 
     "0.00019921388775648868753147258114921669`2.", ",", 
     "0.00042985768115942027834536220964878339`3.", ",", 
     "0.00590570238095238127240538261730762315`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00023660682110682111742479272198380613`3.", ",", 
     "0.00026847188175919267779864774148279594`2.", ",", 
     "0.00047286830497794571587580336746725607`2.", ",", 
     "0.00068231751152073786929885823582253579`2.", ",", 
     "0.00170008561643835700780136299670175504`2.", ",", 
     "0.00274495018450184600014574165527392324`2.", ",", 
     "0.00565460227272727381647721145441209956`2.", ",", 
     "0.05673515384615384488098399629052437376`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00242381535947712315262614346522695996`3.", ",", 
     "0.00282847159090909199344321400815260859`2.", ",", 
     "0.00330917218543046393400275384522046807`2.", ",", 
     "0.00366625862068965628626227015729455161`3.", ",", 
     "0.00688912037037037357223301370368062635`2.", ",", 
     "0.01017287671232876451743454282450329629`2.", ",", 
     "0.01939590789473684406818421166462940164`2.", ",", 
     "0.1662741111111111225184799877752084285`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.06240966666666664802720632110322185326`3.", ",", 
     "0.06585886363636363205475987570025608875`2.", ",", 
     "0.07686821052631577499969495192999602295`3.", ",", 
     "0.08923668749999998095479014637021464296`3.", ",", 
     "0.14780160000000003295284045634616632015`3.", ",", 
     "0.20417314285714285859718586380040505901`3.", ",", 
     "0.35295524999999999815614160070254001766`3.", ",", 
     "2.92126149999999995543475961312651634216`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.21046114285714284664052797779731918126`3.", ",", 
     "0.23223816666666663444118512416025623679`3.", ",", 
     "0.2901512000000000535138156010361853987`3.", ",", 
     "0.34458874999999999921840299066388979554`3.", ",", 
     "0.55816549999999998110666865613893605769`3.", ",", 
     "0.75860149999999992864729847497073933482`3.", ",", 
     "1.3314894999999999924966687103733420372`4.", ",", 
     "11.42550349999999959038632368901744484901`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675598370195902*^9, 3.675670944762334*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compiled WVM implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.6755864457108727`*^9, 
  3.675586449781939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"xx", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
     RowBox[{"xx", ".", 
      RowBox[{"Transpose", "[", "xx", "]"}]}], ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<WVM\>\""}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675586464865552*^9, 3.675586496244589*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingswvm", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{"f", ",", "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675586499328845*^9, 3.675586507980432*^9}, {
  3.675586625392827*^9, 3.6755866275113153`*^9}, {3.675598385665947*^9, 
  3.675598412625558*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.45538814484126894278784389996639`2.*^-6", ",", 
     "3.5626002827017100016415967339567`2.*^-6", ",", 
     "0.00001370186312488470697110252288775101`3.", ",", 
     "2.76854731721698131362676201239204`3.*^-6", ",", 
     "8.28011807528408993713323060781306`3.*^-6", ",", 
     "0.00001227974539330295589568530639779098`2.", ",", 
     "0.00002222131537478072660992019227155225`2.", ",", 
     "0.00018735248041775468203287702273485138`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001467802165354330005649693274838441`3.", ",", 
     "9.41356476814516625979331609919143`3.*^-6", ",", 
     "0.00001398211002289016605408446952685253`2.", ",", 
     "0.00002240960664519818537035629468778808`2.", ",", 
     "0.00005146951303155010160874857638724222`2.", ",", 
     "0.00007925566239316237391113184607149833`3.", ",", 
     "0.00012870607848166213857919737417745409`2.", ",", 
     "0.00149041041041040938849859820436449809`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00002241345490537175768035876854966659`3.", ",", 
     "0.00002964732673267326146671757358674881`2.", ",", 
     "0.00004079548663990031773718056284927513`3.", ",", 
     "0.00005356429364766582561143554164218017`2.", ",", 
     "0.00011777690724912950632086855451419183`3.", ",", 
     "0.00020835106981981969635764340154082674`3.", ",", 
     "0.00045067147147147149175566704926154671`2.", ",", 
     "0.00591104365079364764412606092491841991`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00056538660578386607403339469968273079`3.", ",", 
     "0.00060872727272727282770564682934377743`2.", ",", 
     "0.00079051489361702128276510048721092971`2.", ",", 
     "0.00101683722527472555907657181251124712`2.", ",", 
     "0.00201500134408602116567466033814071125`2.", ",", 
     "0.00284462022900763443142291286847012088`2.", ",", 
     "0.00572485114503816852615791788139176788`2.", ",", 
     "0.05480485185185185459388890194531995803`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00578422656250000052219339963244237879`2.", ",", 
     "0.00615269834710743899336415907441732998`3.", ",", 
     "0.00660160964912280372185460208811491611`3.", ",", 
     "0.00706199523809524290496320020338316681`3.", ",", 
     "0.01034499305555554998781175868316495325`2.", ",", 
     "0.01346126363636363475195789618510389118`2.", ",", 
     "0.02280401538461538160640351691199612105`2.", ",", 
     "0.17464999999999999968913755310495616868`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.18627687499999998066435580312827369198`3.", ",", 
     "0.19034287500000002246736130473436787724`3.", ",", 
     "0.20203142857142858401786611466377507895`3.", ",", 
     "0.21555399999999999560706953616318060085`3.", ",", 
     "0.26852600000000004243361217959318310022`3.", ",", 
     "0.32670525000000000259703369920316617936`3.", ",", 
     "0.47955533333333333345649407419841736555`3.", ",", 
     "3.07594700000000020878587747574783861637`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.71576349999999999695887709094677120447`3.", ",", 
     "0.7199119999999999963691266202658880502`3.", ",", 
     "0.78257799999999999585043042316101491451`3.", ",", 
     "0.83772849999999998704680592709337361157`4.", ",", 
     "1.05522049999999989466914485092274844646`3.", ",", 
     "1.26657749999999991175059221859555691481`3.", ",", 
     "1.95725250000000006167510946397669613361`2.", ",", 
     "12.05014849999999881902112974785268306732`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675671433709803*^9}]
}, Open  ]],

Cell["Previous measurement:", "Text",
 CellChangeTimes->{{3.67567148653855*^9, 3.6756714900178413`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.36420138484390034579977080825275`2.*^-6", ",", 
     "3.49557509718899234039046416966379`2.*^-6", ",", 
     "0.00001367377716769617566775017053481989`3.", ",", 
     "2.73838914735487125727184630485933`3.*^-6", ",", 
     "8.04046295501373200608624669527558`3.*^-6", ",", 
     "0.0000122859197302300928686695155600539`2.", ",", 
     "0.00002213872858096579905639103569292558`2.", ",", 
     "0.00026774209770114953781117161923930325`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001448319678496544378042566042497086`3.", ",", 
     "9.2183049841772227774592055049574`3.*^-6", ",", 
     "0.00001380677777777778869746586748457062`2.", ",", 
     "0.00002181486344537815911452487138699752`2.", ",", 
     "0.00005044803523035228836387394713014487`2.", ",", 
     "0.00008026532474503489085829177618336416`2.", ",", 
     "0.00012916562608394037544798371719423358`2.", ",", 
     "0.00236050949367088607269704603197624238`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00002233569100929554861667200582608928`3.", ",", 
     "0.00002923260647893952837261637156540672`2.", ",", 
     "0.00004086755094194541293711048224324145`2.", ",", 
     "0.00005315508135883532681584609513869566`2.", ",", 
     "0.00011806244064577397438319666944650521`2.", ",", 
     "0.00020828951793721976228079828530326267`3.", ",", 
     "0.00044085499999999943742529096013527123`2.", ",", 
     "0.0060960819672131166119255496482765011`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00056332115963855420269490448248461689`2.", ",", 
     "0.00060041404358353528750158467630626546`2.", ",", 
     "0.00081671225382932174756411836114011749`2.", ",", 
     "0.00104775980392156917511692348909946304`2.", ",", 
     "0.00206951666666666716024036709598021844`2.", ",", 
     "0.00404076648351648411855441267448441067`2.", ",", 
     "0.00708762318840579826767500648543318675`2.", ",", 
     "0.06027347999999999039744125184370204806`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00609265447154471416479903922436278663`2.", ",", 
     "0.00643990948275862101074507037878902338`3.", ",", 
     "0.00681498623853211103751359445368507295`2.", ",", 
     "0.00732527941176470704515155674130255647`2.", ",", 
     "0.01058593571428571161741061246175377164`2.", ",", 
     "0.01489627000000000485446793874189097551`2.", ",", 
     "0.02330079687500001203726007759087224258`2.", ",", 
     "0.17498325000000003459632580415927805007`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.18588650000000001005773242468421813101`3.", ",", 
     "0.19849349999999998939159695510170422494`2.", ",", 
     "0.20191814285714287935391553219233173877`3.", ",", 
     "0.21444400000000002348699013055011164397`3.", ",", 
     "0.27578080000000004812221732208854518831`3.", ",", 
     "0.339000999999999996781241407006746158`2.", ",", 
     "0.48377933333333333898451655841199681163`3.", ",", 
     "3.22160549999999989978505254839546978474`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.70759949999999993686117250035749748349`4.", ",", 
     "0.7203935000000000199449345927860122174`3.", ",", 
     "0.76799200000000000798650034994352608919`3.", ",", 
     "0.82039649999999997298516518640099093318`3.", ",", 
     "1.03131700000000003925038072338793426752`3.", ",", 
     "1.25351349999999994722088558773975819349`3.", ",", 
     "1.84071249999999997370991877687629312277`3.", ",", 
     "12.14203200000000038016878534108400344849`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675598400629724*^9, 3.675598661550433*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Results", "Subsubsubsection",
 CellChangeTimes->{{3.675586453813734*^9, 3.675586458589772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"timingsnat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "2.47494206832627109860661164530971`2.*^-6", ",", 
       "4.53635117430124346575960950223028`3.*^-6", ",", 
       "0.00001480701078582434550257821564978045`3.", ",", 
       "3.93426054267473202636327955783457`3.*^-6", ",", 
       "9.55689593545751818080488670936745`3.*^-6", ",", 
       "0.00001910535117056871292576941678831304`1.", ",", 
       "0.00002349092060810833811263821646608818`2.", ",", 
       "0.00018754587732528908488802144027829399`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.0000133479555236728817622102530315864`3.", ",", 
       "8.03292947287087773548201058426699`3.*^-6", ",", 
       "0.0000129299834969165355300644085212447`2.", ",", 
       "0.00002119525448028673357591181170000993`2.", ",", 
       "0.00004904435856784264045026000555793644`3.", ",", 
       "0.00007834695378151264343914716992145486`3.", ",", 
       "0.00012740027322404373828247658995138636`2.", ",", 
       "0.00152057841140529445729534518960690548`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00001243954863424384902910024147670853`3.", ",", 
       "0.0000184245321474893277466193530766958`2.", ",", 
       "0.0000301721938775510663570053604409793`2.", ",", 
       "0.0000448502284752284614138817531170389`2.", ",", 
       "0.00010872973756705817821328202699149301`2.", ",", 
       "0.00019921388775648868753147258114921669`2.", ",", 
       "0.00042985768115942027834536220964878339`3.", ",", 
       "0.00590570238095238127240538261730762315`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00023660682110682111742479272198380613`3.", ",", 
       "0.00026847188175919267779864774148279594`2.", ",", 
       "0.00047286830497794571587580336746725607`2.", ",", 
       "0.00068231751152073786929885823582253579`2.", ",", 
       "0.00170008561643835700780136299670175504`2.", ",", 
       "0.00274495018450184600014574165527392324`2.", ",", 
       "0.00565460227272727381647721145441209956`2.", ",", 
       "0.05673515384615384488098399629052437376`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00242381535947712315262614346522695996`3.", ",", 
       "0.00282847159090909199344321400815260859`2.", ",", 
       "0.00330917218543046393400275384522046807`2.", ",", 
       "0.00366625862068965628626227015729455161`3.", ",", 
       "0.00688912037037037357223301370368062635`2.", ",", 
       "0.01017287671232876451743454282450329629`2.", ",", 
       "0.01939590789473684406818421166462940164`2.", ",", 
       "0.1662741111111111225184799877752084285`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.06240966666666664802720632110322185326`3.", ",", 
       "0.06585886363636363205475987570025608875`2.", ",", 
       "0.07686821052631577499969495192999602295`3.", ",", 
       "0.08923668749999998095479014637021464296`3.", ",", 
       "0.14780160000000003295284045634616632015`3.", ",", 
       "0.20417314285714285859718586380040505901`3.", ",", 
       "0.35295524999999999815614160070254001766`3.", ",", 
       "2.92126149999999995543475961312651634216`3."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.21046114285714284664052797779731918126`3.", ",", 
       "0.23223816666666663444118512416025623679`3.", ",", 
       "0.2901512000000000535138156010361853987`3.", ",", 
       "0.34458874999999999921840299066388979554`3.", ",", 
       "0.55816549999999998110666865613893605769`3.", ",", 
       "0.75860149999999992864729847497073933482`3.", ",", 
       "1.3314894999999999924966687103733420372`4.", ",", 
       "11.42550349999999959038632368901744484901`3."}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timingswvm", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1.36420138484390034579977080825275`2.*^-6", ",", 
       "3.49557509718899234039046416966379`2.*^-6", ",", 
       "0.00001367377716769617566775017053481989`3.", ",", 
       "2.73838914735487125727184630485933`3.*^-6", ",", 
       "8.04046295501373200608624669527558`3.*^-6", ",", 
       "0.0000122859197302300928686695155600539`2.", ",", 
       "0.00002213872858096579905639103569292558`2.", ",", 
       "0.00026774209770114953781117161923930325`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00001448319678496544378042566042497086`3.", ",", 
       "9.2183049841772227774592055049574`3.*^-6", ",", 
       "0.00001380677777777778869746586748457062`2.", ",", 
       "0.00002181486344537815911452487138699752`2.", ",", 
       "0.00005044803523035228836387394713014487`2.", ",", 
       "0.00008026532474503489085829177618336416`2.", ",", 
       "0.00012916562608394037544798371719423358`2.", ",", 
       "0.00236050949367088607269704603197624238`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00002233569100929554861667200582608928`3.", ",", 
       "0.00002923260647893952837261637156540672`2.", ",", 
       "0.00004086755094194541293711048224324145`2.", ",", 
       "0.00005315508135883532681584609513869566`2.", ",", 
       "0.00011806244064577397438319666944650521`2.", ",", 
       "0.00020828951793721976228079828530326267`3.", ",", 
       "0.00044085499999999943742529096013527123`2.", ",", 
       "0.0060960819672131166119255496482765011`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00056332115963855420269490448248461689`2.", ",", 
       "0.00060041404358353528750158467630626546`2.", ",", 
       "0.00081671225382932174756411836114011749`2.", ",", 
       "0.00104775980392156917511692348909946304`2.", ",", 
       "0.00206951666666666716024036709598021844`2.", ",", 
       "0.00404076648351648411855441267448441067`2.", ",", 
       "0.00708762318840579826767500648543318675`2.", ",", 
       "0.06027347999999999039744125184370204806`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00609265447154471416479903922436278663`2.", ",", 
       "0.00643990948275862101074507037878902338`3.", ",", 
       "0.00681498623853211103751359445368507295`2.", ",", 
       "0.00732527941176470704515155674130255647`2.", ",", 
       "0.01058593571428571161741061246175377164`2.", ",", 
       "0.01489627000000000485446793874189097551`2.", ",", 
       "0.02330079687500001203726007759087224258`2.", ",", 
       "0.17498325000000003459632580415927805007`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.18588650000000001005773242468421813101`3.", ",", 
       "0.19849349999999998939159695510170422494`2.", ",", 
       "0.20191814285714287935391553219233173877`3.", ",", 
       "0.21444400000000002348699013055011164397`3.", ",", 
       "0.27578080000000004812221732208854518831`3.", ",", 
       "0.339000999999999996781241407006746158`2.", ",", 
       "0.48377933333333333898451655841199681163`3.", ",", 
       "3.22160549999999989978505254839546978474`3."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.70759949999999993686117250035749748349`4.", ",", 
       "0.7203935000000000199449345927860122174`3.", ",", 
       "0.76799200000000000798650034994352608919`3.", ",", 
       "0.82039649999999997298516518640099093318`3.", ",", 
       "1.03131700000000003925038072338793426752`3.", ",", 
       "1.25351349999999994722088558773975819349`3.", ",", 
       "1.84071249999999997370991877687629312277`3.", ",", 
       "12.14203200000000038016878534108400344849`3."}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.675667933182199*^9, 3.675667968122138*^9}, {
  3.6756709615935917`*^9, 3.675670963433538*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<MM/nat\>\"", ",", 
       RowBox[{"Transpose", "[", "timingsnat", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<WVM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingswvm", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<MM/nat\>\"", ",", 
       RowBox[{"Transpose", "[", "timingsnat", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<WVM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingswvm", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"\"\<PlotType\>\"", "\[Rule]", "\"\<Contours\>\""}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"p", "=", 
  RowBox[{"Row", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2"}], "}"}], ",", 
    RowBox[{"Alignment", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Center", ",", "Bottom"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.675585228483169*^9, 3.675585231079399*^9}, {
  3.67558573270728*^9, 3.6755857761693783`*^9}, {3.67558591764384*^9, 
  3.675585921731621*^9}, {3.6755860073122683`*^9, 3.675586007368134*^9}, {
  3.675586348538485*^9, 3.675586372265463*^9}, {3.675586774097477*^9, 
  3.675586789312622*^9}, {3.67558683717619*^9, 3.67558685018228*^9}, {
  3.6755996301857357`*^9, 3.6755996849661627`*^9}, {3.675599764331643*^9, 
  3.67559984971093*^9}, {3.675599894685419*^9, 3.6755998950933037`*^9}, {
  3.675599931667879*^9, 3.675599946939253*^9}, {3.675669242085101*^9, 
  3.675669247060527*^9}, {3.675669278532414*^9, 3.675669279259132*^9}, {
  3.675669328162595*^9, 3.675669357696048*^9}, {3.675669406239079*^9, 
  3.675669408725966*^9}, {3.675670994030793*^9, 3.675671012125802*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"fn", "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<results\>\"", ",", 
       "\"\<2016-06-23_kernel_linear_mmnat_vs_wvm.pdf\>\""}], "}"}], "]"}]}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"fn", ",", "p"}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6755999844355087`*^9, 3.675600044967346*^9}, {
  3.6756710994180737`*^9, 3.6756710994900007`*^9}, {3.675671510025259*^9, 
  3.675671518792883*^9}, {3.675671625604706*^9, 3.675671625684579*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "[2016-06-23] L: MM/nat vs MM/WVM  ",
 StyleBox["[MM/nat]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.6755833406524754`*^9, 3.6755834054017553`*^9}, {
  3.6755834831665173`*^9, 3.675583493822259*^9}, {3.675670626717189*^9, 
  3.675670643484375*^9}, {3.675671662284398*^9, 3.675671662850811*^9}, {
  3.6756721496229467`*^9, 3.675672162062339*^9}, {3.6756727145843973`*^9, 
  3.675672741671221*^9}}],

Cell["\<\
iMac, 3.5 GHz Intel Core i5, 16 GB RAM, OS 10.11.5; Mathematica 10.4.1\
\>", "Text",
 CellChangeTimes->{{3.675670549705044*^9, 3.675670606118071*^9}}],

Cell[CellGroupData[{

Cell["Grid", "Subsubsubsection",
 CellChangeTimes->{{3.6756704065181637`*^9, 3.675670406934144*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ngrid", "=", 
   RowBox[{"{", 
    RowBox[{
    "10", ",", "50", ",", "100", ",", "500", ",", "1000", ",", "5000", ",", 
     "10000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dgrid", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "10", ",", "50", ",", "100", ",", "300", ",", "500", ",", 
     "1000", ",", "10000"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67558352273318*^9, 3.675583563019446*^9}, {
   3.675583608713636*^9, 3.675583649895831*^9}, {3.675583696238008*^9, 
   3.675583714501089*^9}, {3.675587885606567*^9, 3.675587975313457*^9}, {
   3.675597707014162*^9, 3.675597724317615*^9}, 3.675598116733819*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "bm", "]"}], ";", 
  RowBox[{
   RowBox[{"bm", "[", 
    RowBox[{"f_", ",", "n_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xx", ",", "zz"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xx", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zz", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"First", "[", 
       RowBox[{"RepeatedTiming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"xx", ",", "zz"}], "]"}], ";"}], ",", "3"}], "]"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6755865239218893`*^9, 3.6755865623938217`*^9}, {
  3.675586650278653*^9, 3.675586650734549*^9}, {3.6755879791616163`*^9, 
  3.675587979241152*^9}, {3.675672842411611*^9, 3.675672853515049*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["MM Native implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.675670665204402*^9, 
  3.6756706699393377`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"k", "[", 
    RowBox[{"xx_", ",", "zz_"}], "]"}], ":=", 
   RowBox[{"xx", ".", 
    RowBox[{"Transpose", "[", "zz", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675670701628518*^9, 3.6756707087707767`*^9}, {
  3.675672766918335*^9, 3.675672773230054*^9}, {3.6756728240600357`*^9, 
  3.675672824491921*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingsnat", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{"k", ",", "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6755837310841618`*^9, 3.675583781105747*^9}, {
   3.675583812401144*^9, 3.6755838144811172`*^9}, {3.675584401481059*^9, 
   3.675584413088552*^9}, {3.675584552835106*^9, 3.6755845594826393`*^9}, {
   3.675585593154819*^9, 3.675585595441177*^9}, {3.675586438711046*^9, 
   3.675586439014894*^9}, {3.675586566584388*^9, 3.675586580969152*^9}, {
   3.675591918506966*^9, 3.67559192155416*^9}, 3.6755977433728247`*^9, {
   3.675598062822199*^9, 3.6755980708837976`*^9}, {3.6755981035665407`*^9, 
   3.675598107869968*^9}, {3.675670677763235*^9, 3.675670696690607*^9}, 
   3.6756728315878773`*^9, 3.6756728712901287`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.27920684814453091264507302027287`3.*^-6", ",", 
     "4.4139267843655531219256016317587`2.*^-6", ",", 
     "0.00001498553583820759561363346323847878`2.", ",", 
     "3.84231599506579004331147803030788`3.*^-6", ",", 
     "9.70024028577302791041120366699602`2.*^-6", ",", 
     "0.00001357680685994283213214109395927665`2.", ",", 
     "0.00002338264915859251922322474548376903`3.", ",", 
     "0.00027274878892733579781662567320665858`1."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001371855433810376025810517930381138`2.", ",", 
     "8.02964564732142300834075859805594`3.*^-6", ",", 
     "0.00003320266105389762774716122528673168`1.", ",", 
     "0.00002301971014492752349070957273990956`1.", ",", 
     "0.00006552391587567467411482025063662604`1.", ",", 
     "0.00012966063492063486855751519577495401`1.", ",", 
     "0.00012772706935123065560486188552147269`2.", ",", 
     "0.00163280277777777690050020620304849217`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001377358507734303448371247780013249`2.", ",", 
     "0.00002063574159269099142586384454389759`1.", ",", 
     "0.00003592562794348508456356711127099857`1.", ",", 
     "0.00006729088431253788416420286155883446`1.", ",", 
     "0.00010927802690582952662486787565043755`2.", ",", 
     "0.00028331835853131717055733429511121813`2.", ",", 
     "0.00068832901785714295864182510342743626`1.", ",", 
     "0.00601881057268722520492421068638577708`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00027170165745856372568542425049997746`3.", ",", 
     "0.00038017405660377325948146021161733188`1.", ",", 
     "0.00046883964646464584098348171714576438`2.", ",", 
     "0.00068612685185185165459564871071052039`2.", ",", 
     "0.00170904252873563234325915427547215586`3.", ",", 
     "0.00271811775362318678792017401235625584`2.", ",", 
     "0.00536003649635036737153281904966206639`3.", ",", 
     "0.0566717692307692338937741283189097885`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00245757755775577587872837703741879523`3.", ",", 
     "0.00298670634920634872969125162001091667`2.", ",", 
     "0.00330605140186915986630356023567856028`2.", ",", 
     "0.00527047101449275561674268075762483932`2.", ",", 
     "0.0105911388888888929882270417692780029`1.", ",", 
     "0.01453176851851851678065763451286329655`1.", ",", 
     "0.01947921052631578289759950450843462022`2.", ",", 
     "0.16983137500000000663646915199933573604`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.06418983333333333485271054996701423079`2.", ",", 
     "0.06641513636363637063109166547292261384`3.", ",", 
     "0.08299038888888889131667525589364231564`2.", ",", 
     "0.09015287499999999343280876473727403209`3.", ",", 
     "0.20085825000000001594457899045664817095`2.", ",", 
     "0.21656066666666665132545688265963690355`2.", ",", 
     "0.53043850000000003497291345411213114858`1.", ",", 
     "4.04860649999999999693045538151636719704`1."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.38531349999999997546495933420374058187`2.", ",", 
     "0.39686074999999998436095438592019490898`2.", ",", 
     "0.35866850000000000120436993711336981505`1.", ",", 
     "0.47045749999999997292832176754018291831`1.", ",", 
     "0.81473750000000000337507799486047588289`2.", ",", 
     "0.94221749999999993008259480120614171028`2.", ",", 
     "1.98049249999999998905764186929445713758`2.", ",", 
     "12.48683850000000106206243799533694982529`2."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675598370195902*^9, 3.675670944762334*^9, 
  3.675673118806423*^9}]
}, Open  ]],

Cell["No load on machine:", "Text",
 CellChangeTimes->{{3.6756774933171997`*^9, 3.675677495812257*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingsnat", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{"k", ",", "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6755837310841618`*^9, 3.675583781105747*^9}, {
   3.675583812401144*^9, 3.6755838144811172`*^9}, {3.675584401481059*^9, 
   3.675584413088552*^9}, {3.675584552835106*^9, 3.6755845594826393`*^9}, {
   3.675585593154819*^9, 3.675585595441177*^9}, {3.675586438711046*^9, 
   3.675586439014894*^9}, {3.675586566584388*^9, 3.675586580969152*^9}, {
   3.675591918506966*^9, 3.67559192155416*^9}, 3.6755977433728247`*^9, {
   3.675598062822199*^9, 3.6755980708837976`*^9}, {3.6755981035665407`*^9, 
   3.675598107869968*^9}, {3.675670677763235*^9, 3.675670696690607*^9}, 
   3.6756728315878773`*^9, 3.6756728712901287`*^9, 3.675677497482801*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.21518258759469677796928588353609`2.*^-6", ",", 
     "4.33260331915680242214879494544455`2.*^-6", ",", 
     "0.00001457772151898734450115036054285156`3.", ",", 
     "3.72584188136132324871223862883252`3.*^-6", ",", 
     "9.13353881835937986028318286146899`3.*^-6", ",", 
     "0.00001454643874643891544710429253317585`2.", ",", 
     "0.00002467661097852016292798424390575462`2.", ",", 
     "0.00018583133133133125777444738524479817`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001303153886554621039648577118796879`3.", ",", 
     "7.7766632729388269459945906558751`3.*^-6", ",", 
     "0.00001273121033388521239901932519122951`3.", ",", 
     "0.0000208592125542945367789628152710435`2.", ",", 
     "0.00004875045913682281225080480946409978`3.", ",", 
     "0.00007995317156236698594943407281121495`2.", ",", 
     "0.00012706520430107526103101489578506289`2.", ",", 
     "0.00160082903225806471962655574969858208`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001216139739980800138149930056385983`3.", ",", 
     "0.00001804662344284986230332802625841992`2.", ",", 
     "0.00003029378472294472191515823933372076`2.", ",", 
     "0.00004433225998807395869727096537893374`3.", ",", 
     "0.00010761885964912285386721468860571349`2.", ",", 
     "0.0001992841614906834134170882100178801`2.", ",", 
     "0.00043127816492450618069201540016877061`2.", ",", 
     "0.00609549999999999762151370319429588562`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00023797419354838707022600785556676328`3.", ",", 
     "0.00027394997949979507743251128104589043`2.", ",", 
     "0.00046972011251758099539474478056888529`2.", ",", 
     "0.00069236452513966450107024686033696526`2.", ",", 
     "0.00176810595238095303108338818276479287`2.", ",", 
     "0.00315537659574468198550589725925874518`2.", ",", 
     "0.00556115789473683903854084320528272656`2.", ",", 
     "0.05759346153846153781863392850937088951`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00249559533898304885396468577596351679`3.", ",", 
     "0.00286523461538461515080156161161539785`3.", ",", 
     "0.0033389822222222235829913739024732422`2.", ",", 
     "0.00377027806122448919112777332429686794`2.", ",", 
     "0.0070019952830188674636202605938706256`2.", ",", 
     "0.01025445833333332897041589859554733266`2.", ",", 
     "0.01957459210526316106815158946119481698`2.", ",", 
     "0.1690797499999999731201683061954099685`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.06317737499999999395416949710124754347`2.", ",", 
     "0.06574386363636362806683877124669379555`3.", ",", 
     "0.07683173684210524434501365931282634847`3.", ",", 
     "0.08950081249999999877253742397442692891`3.", ",", 
     "0.14844160000000000687592205395048949867`3.", ",", 
     "0.2044880000000000030979663279140368104`3.", ",", 
     "0.35674349999999999116795379450195468962`3.", ",", 
     "2.96843849999999997990585143270436674356`4."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.21622642857142854166951906336180400103`3.", ",", 
     "0.23216566666666668683483010227064369246`3.", ",", 
     "0.28543879999999999252935367621830664575`3.", ",", 
     "0.33722900000000005649170020660676527768`3.", ",", 
     "0.56153450000000004749267645820509642363`2.", ",", 
     "0.76739950000000001217870249092811718583`3.", ",", 
     "1.34691650000000007203482255135895684361`3.", ",", 
     "11.5352664999999987571754900272935628891`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6756777616972103`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compiled WVM implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.6755864457108727`*^9, 
  3.675586449781939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xx", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"zz", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"xx", ".", 
      RowBox[{"Transpose", "[", "zz", "]"}]}], ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<WVM\>\""}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675586464865552*^9, 3.675586496244589*^9}, {
  3.6756731504563837`*^9, 3.675673156622596*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingswvm", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{"f", ",", "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675586499328845*^9, 3.675586507980432*^9}, {
  3.675586625392827*^9, 3.6755866275113153`*^9}, {3.675598385665947*^9, 
  3.675598412625558*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.53045118004706913309755089702691`2.*^-6", ",", 
     "3.63883220615671458352370984390411`3.*^-6", ",", 
     "0.00001391906119558735828163446857086427`3.", ",", 
     "2.9233203124999989109557806121753`3.*^-6", ",", 
     "8.41204202586206224788283047910653`3.*^-6", ",", 
     "0.00001445877734711882648928685246580983`1.", ",", 
     "0.00002462115945503216929792812683874814`2.", ",", 
     "0.00019554846715328464833334731753922142`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001571879308183982549944335271874252`2.", ",", 
     "9.74105864591196439299363579733537`3.*^-6", ",", 
     "0.00001540002044571661389505898287488606`2.", ",", 
     "0.00002308862876254176083783489770162589`1.", ",", 
     "0.00005458800220143095221136605998957236`2.", ",", 
     "0.00008246973180076634646600702849283948`2.", ",", 
     "0.00013178915770609324212628288286452971`2.", ",", 
     "0.00165876829268292577332366555253884144`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00002270581014729949984477103130942055`3.", ",", 
     "0.00002993252595155705708153404120963614`1.", ",", 
     "0.00004137990276862229974087423189921253`2.", ",", 
     "0.00006394298298783691284364466556056072`1.", ",", 
     "0.00014188501245995015979765863090023004`1.", ",", 
     "0.00021047480106100796364530791660030218`2.", ",", 
     "0.00065919727891156402153904902974090874`1.", ",", 
     "0.00634729487179487052161963589469451108`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00060066987179487160881941054668686775`2.", ",", 
     "0.00064899825327510945842390821525214051`2.", ",", 
     "0.00082949665178571436400384309095557001`2.", ",", 
     "0.00108257974137931055336192542881690315`2.", ",", 
     "0.00212856402877697808637136311915583065`2.", ",", 
     "0.00309168388429751934270983682040423446`2.", ",", 
     "0.0055754569288389505335445939238070423`2.", ",", 
     "0.05621557692307692366551208351665991358`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00636583613445378202616575791239483806`2.", ",", 
     "0.00681422522522522576549075523644205532`2.", ",", 
     "0.00700635922330097166144113884911348578`2.", ",", 
     "0.0073287772277227667197530003306837898`2.", ",", 
     "0.01123331617647058827680339732069114689`2.", ",", 
     "0.01376975925925926283466260713339579524`2.", ",", 
     "0.02356524999999999939181982711033924716`2.", ",", 
     "0.17168475000000002483879768533370224759`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.19016687500000001298516849601583089679`3.", ",", 
     "0.20752728571428571968660037327936151996`2.", ",", 
     "0.2347979999999999789483950962676317431`2.", ",", 
     "0.22690799999999999858601995583740063012`2.", ",", 
     "0.28696125000000000104805053524614777416`2.", ",", 
     "0.35108874999999994948041148745687678456`2.", ",", 
     "0.54237350000000006389200279954820871353`2.", ",", 
     "3.86689249999999962170704748132266104221`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.82622899999999999121058635864756070077`2.", ",", 
     "0.82851999999999992319033026433316990733`2.", ",", 
     "0.83875849999999996242650013300590217113`2.", ",", 
     "0.88236249999999993853805335675133392215`3.", ",", 
     "1.13801050000000003592504072003066539764`2.", ",", 
     "1.41953100000000009828227121033705770969`2.", ",", 
     "1.93555300000000007898393050709273666143`3.", ",", 
     "13.5295684999999998865405359538272023201`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675671433709803*^9, 3.675673406445662*^9}]
}, Open  ]],

Cell["No load on machine:", "Text",
 CellChangeTimes->{{3.675677798024056*^9, 3.67567780170397*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingswvm", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{"f", ",", "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675586499328845*^9, 3.675586507980432*^9}, {
   3.675586625392827*^9, 3.6755866275113153`*^9}, {3.675598385665947*^9, 
   3.675598412625558*^9}, 3.67567780291136*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.41919775722789306870628110723853`2.*^-6", ",", 
     "3.5569359756097577802069157476561`3.*^-6", ",", 
     "0.00001372921522921523177288016803743176`3.", ",", 
     "2.86735409007353174746591042976185`3.*^-6", ",", 
     "8.22685327422752879565452654997415`3.*^-6", ",", 
     "0.00001235097690054586662509062550130423`2.", ",", 
     "0.00004427500000000012073684066415957261`1.", ",", 
     "0.00019190298507462672092035993465231059`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001457837223101266378288282110631258`3.", ",", 
     "9.49987317370129698539810148005813`3.*^-6", ",", 
     "0.00001370955361800429624390042920856203`2.", ",", 
     "0.00002248450491307635914226339957089351`2.", ",", 
     "0.00005067817622950821854557745815839098`2.", ",", 
     "0.0000826129134860051692187607463857546`1.", ",", 
     "0.00012771424874935311021342809745249269`3.", ",", 
     "0.00164421412803532123944605380927441729`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00002244050277643650024694127464996996`3.", ",", 
     "0.00002963580198019802027170968572455934`2.", ",", 
     "0.00004062083607275914854187193192558425`3.", ",", 
     "0.00005339371182177508223147890942250626`2.", ",", 
     "0.00011822166824944600478208139859859216`2.", ",", 
     "0.00020723460410557178828193369835020121`3.", ",", 
     "0.00043983959451401367663631036819538167`3.", ",", 
     "0.00598687499999999827443586397635044705`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00059935040322580659857137908019808492`3.", ",", 
     "0.00064574118165784818394042909872609926`2.", ",", 
     "0.00083525777777777789490781801262642148`2.", ",", 
     "0.00107027351040918936378454340285770741`2.", ",", 
     "0.00209570704225352016578098890420278622`2.", ",", 
     "0.00301003427419355021679714390359094978`2.", ",", 
     "0.0055295111940298503211410618973786768`3.", ",", 
     "0.05484825925925927020410099999025987927`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00605489919354838465603840802486956818`2.", ",", 
     "0.00634297008547008746293105474478579708`3.", ",", 
     "0.00676783636363636510735464213439627201`2.", ",", 
     "0.00730120098039215448953997977810104203`2.", ",", 
     "0.01046485714285714553606343457659022533`3.", ",", 
     "0.01417251886792452938990116706463595619`2.", ",", 
     "0.02279573437500000132605038061228697188`3.", ",", 
     "0.17355987500000000234301467116893036291`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.18591487500000003496580802675453014672`3.", ",", 
     "0.19096174999999998567190573339757975191`3.", ",", 
     "0.20000200000000001310240804741624742746`3.", ",", 
     "0.21048728571428571010315522471501026303`3.", ",", 
     "0.26937566666666662440476898154884111136`3.", ",", 
     "0.32807324999999998293986891439999453723`3.", ",", 
     "0.47928399999999998781774479539308231324`3.", ",", 
     "3.17682200000000003470290721452329307795`4."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.70480699999999996130384261050494387746`3.", ",", 
     "0.72574800000000005972822236799402162433`3.", ",", 
     "0.77045900000000000495958829560549929738`3.", ",", 
     "0.8199654999999999027693320385878905654`3.", ",", 
     "1.04949099999999995169730482302838936448`3.", ",", 
     "1.24926499999999984780174600018654018641`3.", ",", 
     "1.81885649999999987613819030229933559895`4.", ",", 
     "12.18936400000000119803189591038972139359`5."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.67567805050465*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Results", "Subsubsubsection",
 CellChangeTimes->{{3.675586453813734*^9, 3.675586458589772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<MM/nat\>\"", ",", 
       RowBox[{"Transpose", "[", "timingsnat", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<WVM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingswvm", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<MM/nat\>\"", ",", 
       RowBox[{"Transpose", "[", "timingsnat", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<WVM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingswvm", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"\"\<PlotType\>\"", "\[Rule]", "\"\<Contours\>\""}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"p", "=", 
  RowBox[{"Row", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2"}], "}"}], ",", 
    RowBox[{"Alignment", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Center", ",", "Bottom"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.675585228483169*^9, 3.675585231079399*^9}, {
  3.67558573270728*^9, 3.6755857761693783`*^9}, {3.67558591764384*^9, 
  3.675585921731621*^9}, {3.6755860073122683`*^9, 3.675586007368134*^9}, {
  3.675586348538485*^9, 3.675586372265463*^9}, {3.675586774097477*^9, 
  3.675586789312622*^9}, {3.67558683717619*^9, 3.67558685018228*^9}, {
  3.6755996301857357`*^9, 3.6755996849661627`*^9}, {3.675599764331643*^9, 
  3.67559984971093*^9}, {3.675599894685419*^9, 3.6755998950933037`*^9}, {
  3.675599931667879*^9, 3.675599946939253*^9}, {3.675669242085101*^9, 
  3.675669247060527*^9}, {3.675669278532414*^9, 3.675669279259132*^9}, {
  3.675669328162595*^9, 3.675669357696048*^9}, {3.675669406239079*^9, 
  3.675669408725966*^9}, {3.675670994030793*^9, 3.675671012125802*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "[2016-06-23] L: MM/WVM vs MM/C  ",
 StyleBox["[MM/WVM]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.6755833406524754`*^9, 3.6755834054017553`*^9}, {
  3.6755834831665173`*^9, 3.675583493822259*^9}, {3.675670626717189*^9, 
  3.675670643484375*^9}, {3.675671662284398*^9, 3.675671662850811*^9}, {
  3.6756721496229467`*^9, 3.675672162062339*^9}, {3.6756727145843973`*^9, 
  3.675672741671221*^9}, {3.675678230670579*^9, 3.675678238982194*^9}, {
  3.675678717195244*^9, 3.675678717515177*^9}}],

Cell["\<\
iMac, 3.5 GHz Intel Core i5, 16 GB RAM, OS 10.11.5; Mathematica 10.4.1\
\>", "Text",
 CellChangeTimes->{{3.675670549705044*^9, 3.675670606118071*^9}}],

Cell[CellGroupData[{

Cell["Grid", "Subsubsubsection",
 CellChangeTimes->{{3.6756704065181637`*^9, 3.675670406934144*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ngrid", "=", 
   RowBox[{"{", 
    RowBox[{
    "10", ",", "50", ",", "100", ",", "500", ",", "1000", ",", "5000", ",", 
     "10000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dgrid", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "10", ",", "50", ",", "100", ",", "300", ",", "500", ",", 
     "1000", ",", "10000"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67558352273318*^9, 3.675583563019446*^9}, {
   3.675583608713636*^9, 3.675583649895831*^9}, {3.675583696238008*^9, 
   3.675583714501089*^9}, {3.675587885606567*^9, 3.675587975313457*^9}, {
   3.675597707014162*^9, 3.675597724317615*^9}, 3.675598116733819*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "bm", "]"}], ";", 
  RowBox[{
   RowBox[{"bm", "[", 
    RowBox[{"f_", ",", "n_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xx", ",", "zz"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xx", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zz", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"First", "[", 
       RowBox[{"RepeatedTiming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"xx", ",", "zz"}], "]"}], ";"}], ",", "3"}], "]"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6755865239218893`*^9, 3.6755865623938217`*^9}, {
  3.675586650278653*^9, 3.675586650734549*^9}, {3.6755879791616163`*^9, 
  3.675587979241152*^9}, {3.675672842411611*^9, 3.675672853515049*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Compiled C implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.6755864457108727`*^9, 
  3.675586449781939*^9}, {3.6756782690050583`*^9, 3.675678269725006*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xx", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"zz", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"xx", ".", 
      RowBox[{"Transpose", "[", "zz", "]"}]}], ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675586464865552*^9, 3.675586496244589*^9}, {
  3.6756731504563837`*^9, 3.675673156622596*^9}, {3.6756782737171497`*^9, 
  3.675678274349078*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingsc", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{"f", ",", "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675586499328845*^9, 3.675586507980432*^9}, {
  3.675586625392827*^9, 3.6755866275113153`*^9}, {3.675598385665947*^9, 
  3.675598412625558*^9}, {3.6756783292909527`*^9, 3.6756783296908693`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.68641305327278048385632874817119`2.*^-6", ",", 
     "3.86885385664682382884102876396959`2.*^-6", ",", 
     "0.00001404238155608770858857187180390724`3.", ",", 
     "3.20405016447368328369894180385202`3.*^-6", ",", 
     "8.62278106508876235878659211042674`3.*^-6", ",", 
     "0.00001292015903246473820310032815106283`2.", ",", 
     "0.0000225533333333333026171890062228087`2.", ",", 
     "0.00018444854946689809445901919726651386`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0000157570008460236855526732241417065`3.", ",", 
     "0.00001058219805945733165298411337928997`3.", ",", 
     "0.00001536431069958848076085523859379833`2.", ",", 
     "0.00002398628917378917954671482815065531`2.", ",", 
     "0.00005141376686267725202141368190389414`3.", ",", 
     "0.00008057389375743811044290609846285633`3.", ",", 
     "0.00012957481751824876520240437116626708`2.", ",", 
     "0.00159536227224008606874472437908707434`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00002727643242255322383448684631090941`3.", ",", 
     "0.00003392731864095502737187909358951288`2.", ",", 
     "0.00004501318278913641777669307764142559`3.", ",", 
     "0.00005766266266266268264743463656252231`2.", ",", 
     "0.00012205358316896765692033399730576093`3.", ",", 
     "0.00021495186781609194577938315440235328`2.", ",", 
     "0.00045079897836538466819600312618376847`2.", ",", 
     "0.00599543951612903098374873778197979846`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0007851085028690660142305923763217379`2.", ",", 
     "0.00084703367579908690407353155649161636`2.", ",", 
     "0.00102436707988980786263044642225850112`2.", ",", 
     "0.00129616840277777889758881180171101732`2.", ",", 
     "0.00229141131498470946442624907035678916`2.", ",", 
     "0.00329428318584071028879423082003086165`2.", ",", 
     "0.00581108914728682354744471183494169964`2.", ",", 
     "0.05545426923076923059197085308369423728`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00865730813953488088918764020718299435`2.", ",", 
     "0.00899621084337349878612410947198441136`3.", ",", 
     "0.00938980254777069776872533424239009037`3.", ",", 
     "0.009914326666666667398075674100255128`3.", ",", 
     "0.01321100892857143653535967331436040695`2.", ",", 
     "0.01723281395348837119474438850375008769`2.", ",", 
     "0.02573156896551723540889078378768317634`2.", ",", 
     "0.17595562500000003214317700894753215834`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.28990039999999994702051253625540994108`3.", ",", 
     "0.29463099999999997624655634353985078633`3.", ",", 
     "0.3006457500000000448991954726807307452`3.", ",", 
     "0.31537099999999995691979393086512573063`3.", ",", 
     "0.37514475000000002680167199287097901106`3.", ",", 
     "0.43224066666666666192142542968213092536`3.", ",", 
     "0.58296150000000002133759835487580858171`3.", ",", 
     "3.22492249999999991416643752017989754677`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.11262600000000011490897122712340205908`3.", ",", 
     "1.12210499999999990805576999264303594828`3.", ",", 
     "1.17995550000000015700152289355173707008`3.", ",", 
     "1.22780200000000005999822860758285969496`4.", ",", 
     "1.44581999999999988304466569388750940561`3.", ",", 
     "1.64061849999999997962163433840032666922`3.", ",", 
     "2.23757949999999983248244461719878017902`3.", ",", 
     "12.44503599999999998715338733745738863945`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675678602347081*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compiled WVM implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.6755864457108727`*^9, 
  3.675586449781939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xx", ",", "_Real", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"zz", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"xx", ".", 
      RowBox[{"Transpose", "[", "zz", "]"}]}], ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<WVM\>\""}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675586464865552*^9, 3.675586496244589*^9}, {
  3.6756731504563837`*^9, 3.675673156622596*^9}}],

Cell["No load on machine:", "Text",
 CellChangeTimes->{{3.675677798024056*^9, 3.67567780170397*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingswvm", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{"f", ",", "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675586499328845*^9, 3.675586507980432*^9}, {
   3.675586625392827*^9, 3.6755866275113153`*^9}, {3.675598385665947*^9, 
   3.675598412625558*^9}, 3.67567780291136*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.41919775722789306870628110723853`2.*^-6", ",", 
     "3.5569359756097577802069157476561`3.*^-6", ",", 
     "0.00001372921522921523177288016803743176`3.", ",", 
     "2.86735409007353174746591042976185`3.*^-6", ",", 
     "8.22685327422752879565452654997415`3.*^-6", ",", 
     "0.00001235097690054586662509062550130423`2.", ",", 
     "0.00004427500000000012073684066415957261`1.", ",", 
     "0.00019190298507462672092035993465231059`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001457837223101266378288282110631258`3.", ",", 
     "9.49987317370129698539810148005813`3.*^-6", ",", 
     "0.00001370955361800429624390042920856203`2.", ",", 
     "0.00002248450491307635914226339957089351`2.", ",", 
     "0.00005067817622950821854557745815839098`2.", ",", 
     "0.0000826129134860051692187607463857546`1.", ",", 
     "0.00012771424874935311021342809745249269`3.", ",", 
     "0.00164421412803532123944605380927441729`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00002244050277643650024694127464996996`3.", ",", 
     "0.00002963580198019802027170968572455934`2.", ",", 
     "0.00004062083607275914854187193192558425`3.", ",", 
     "0.00005339371182177508223147890942250626`2.", ",", 
     "0.00011822166824944600478208139859859216`2.", ",", 
     "0.00020723460410557178828193369835020121`3.", ",", 
     "0.00043983959451401367663631036819538167`3.", ",", 
     "0.00598687499999999827443586397635044705`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00059935040322580659857137908019808492`3.", ",", 
     "0.00064574118165784818394042909872609926`2.", ",", 
     "0.00083525777777777789490781801262642148`2.", ",", 
     "0.00107027351040918936378454340285770741`2.", ",", 
     "0.00209570704225352016578098890420278622`2.", ",", 
     "0.00301003427419355021679714390359094978`2.", ",", 
     "0.0055295111940298503211410618973786768`3.", ",", 
     "0.05484825925925927020410099999025987927`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00605489919354838465603840802486956818`2.", ",", 
     "0.00634297008547008746293105474478579708`3.", ",", 
     "0.00676783636363636510735464213439627201`2.", ",", 
     "0.00730120098039215448953997977810104203`2.", ",", 
     "0.01046485714285714553606343457659022533`3.", ",", 
     "0.01417251886792452938990116706463595619`2.", ",", 
     "0.02279573437500000132605038061228697188`3.", ",", 
     "0.17355987500000000234301467116893036291`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.18591487500000003496580802675453014672`3.", ",", 
     "0.19096174999999998567190573339757975191`3.", ",", 
     "0.20000200000000001310240804741624742746`3.", ",", 
     "0.21048728571428571010315522471501026303`3.", ",", 
     "0.26937566666666662440476898154884111136`3.", ",", 
     "0.32807324999999998293986891439999453723`3.", ",", 
     "0.47928399999999998781774479539308231324`3.", ",", 
     "3.17682200000000003470290721452329307795`4."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.70480699999999996130384261050494387746`3.", ",", 
     "0.72574800000000005972822236799402162433`3.", ",", 
     "0.77045900000000000495958829560549929738`3.", ",", 
     "0.8199654999999999027693320385878905654`3.", ",", 
     "1.04949099999999995169730482302838936448`3.", ",", 
     "1.24926499999999984780174600018654018641`3.", ",", 
     "1.81885649999999987613819030229933559895`4.", ",", 
     "12.18936400000000119803189591038972139359`5."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.67567805050465*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Results", "Subsubsubsection",
 CellChangeTimes->{{3.675586453813734*^9, 3.675586458589772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<MM/C\>\"", ",", 
       RowBox[{"Transpose", "[", "timingsc", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<MM/WVM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingswvm", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<MM/C\>\"", ",", 
       RowBox[{"Transpose", "[", "timingsc", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<MM/WVM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingswvm", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"\"\<PlotType\>\"", "\[Rule]", "\"\<Contours\>\""}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"p", "=", 
  RowBox[{"Row", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2"}], "}"}], ",", 
    RowBox[{"Alignment", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Center", ",", "Bottom"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.675585228483169*^9, 3.675585231079399*^9}, {
  3.67558573270728*^9, 3.6755857761693783`*^9}, {3.67558591764384*^9, 
  3.675585921731621*^9}, {3.6755860073122683`*^9, 3.675586007368134*^9}, {
  3.675586348538485*^9, 3.675586372265463*^9}, {3.675586774097477*^9, 
  3.675586789312622*^9}, {3.67558683717619*^9, 3.67558685018228*^9}, {
  3.6755996301857357`*^9, 3.6755996849661627`*^9}, {3.675599764331643*^9, 
  3.67559984971093*^9}, {3.675599894685419*^9, 3.6755998950933037`*^9}, {
  3.675599931667879*^9, 3.675599946939253*^9}, {3.675669242085101*^9, 
  3.675669247060527*^9}, {3.675669278532414*^9, 3.675669279259132*^9}, {
  3.675669328162595*^9, 3.675669357696048*^9}, {3.675669406239079*^9, 
  3.675669408725966*^9}, {3.675670994030793*^9, 3.675671012125802*^9}, {
  3.6756786590859833`*^9, 3.675678683308997*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "[2016-06-24] m: MM/nat vs C++ (2015)  ",
 StyleBox["[C++]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.6755833406524754`*^9, 3.6755834054017553`*^9}, {
  3.6755834831665173`*^9, 3.675583493822259*^9}, {3.675671669746537*^9, 
  3.675671670266548*^9}, {3.6756721409375134`*^9, 3.675672142359215*^9}, {
  3.6757385661364727`*^9, 3.675738575144824*^9}, {3.675740550785239*^9, 
  3.6757405512796783`*^9}}],

Cell["\<\
iMac, 3.5 GHz Intel Core i5, 16 GB RAM, OS 10.11.5; Mathematica 10.4.1\
\>", "Text",
 CellChangeTimes->{{3.675670549705044*^9, 3.675670606118071*^9}}],

Cell[CellGroupData[{

Cell["Grid", "Subsubsubsection",
 CellChangeTimes->{{3.6756704065181637`*^9, 3.675670406934144*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ngrid", "=", 
   RowBox[{"{", 
    RowBox[{
    "10", ",", "50", ",", "100", ",", "500", ",", "1000", ",", "5000", ",", 
     "10000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dgrid", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "10", ",", "50", ",", "100", ",", "300", ",", "500", ",", 
     "1000", ",", "10000"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67558352273318*^9, 3.675583563019446*^9}, {
   3.675583608713636*^9, 3.675583649895831*^9}, {3.675583696238008*^9, 
   3.675583714501089*^9}, {3.675587885606567*^9, 3.675587975313457*^9}, {
   3.675597707014162*^9, 3.675597724317615*^9}, 3.675598116733819*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "bm", "]"}], ";", 
  RowBox[{
   RowBox[{"bm", "[", 
    RowBox[{"f_", ",", "n_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xx", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"First", "[", 
       RowBox[{"RepeatedTiming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "xx", "]"}], ";"}], ",", "3"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6755865239218893`*^9, 3.6755865623938217`*^9}, {
  3.675586650278653*^9, 3.675586650734549*^9}, {3.6755879791616163`*^9, 
  3.675587979241152*^9}, {3.675738614103034*^9, 3.675738621142568*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["C++ (2015) implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<QMMLPack`\>\"", "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"old", " ", "version", " ", 
    RowBox[{"C", "++"}], " ", "implementation"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.675583416488957*^9, 3.67558343580858*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingscpp", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"KernelLinear", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], "&"}], ")"}], ",", 
        "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6755837310841618`*^9, 3.675583781105747*^9}, {
   3.675583812401144*^9, 3.6755838144811172`*^9}, {3.675584401481059*^9, 
   3.675584413088552*^9}, {3.675584552835106*^9, 3.6755845594826393`*^9}, {
   3.675585593154819*^9, 3.675585595441177*^9}, {3.675586438711046*^9, 
   3.675586439014894*^9}, {3.675586566584388*^9, 3.675586580969152*^9}, {
   3.675591918506966*^9, 3.67559192155416*^9}, 3.6755977433728247`*^9, {
   3.675598062822199*^9, 3.6755980708837976`*^9}, {3.6755981035665407`*^9, 
   3.675598107869968*^9}, {3.675738636237687*^9, 3.675738637597827*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.37536764705882665863097280567473`1.*^-6", ",", 
     "2.43697916666666505698603424623361`3.*^-6", ",", 
     "2.53422361591695469813442787021529`3.*^-6", ",", 
     "2.59334584535967685155286727161084`3.*^-6", ",", 
     "2.93138373807730582708188510343561`3.*^-6", ",", 
     "3.26410130092075770552942359792326`3.*^-6", ",", 
     "3.99527994791666741207373028665906`3.*^-6", ",", 
     "0.00002298549382716050018516350250674662`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.47663863877118570945719787379513`2.*^-6", ",", 
     "2.96533993863866415511740780297512`2.*^-6", ",", 
     "3.28261412205717377873386356168517`3.*^-6", ",", 
     "3.80892944335937219628028700679767`3.*^-6", ",", 
     "5.11521730222901911493398746655359`3.*^-6", ",", 
     "7.17530732996323776713178121955394`3.*^-6", ",", 
     "0.00001403518685955394660626847913587056`3.", ",", 
     "0.00011050774336283187898252733383230861`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.78686987583174997456483996949306`2.*^-6", ",", 
     "3.59885891317733725423052421055203`3.*^-6", ",", 
     "4.2496706940406990253458578699064`3.*^-6", ",", 
     "5.13171902508803235906913869923685`3.*^-6", ",", 
     "9.39361728766025696319395821287657`3.*^-6", ",", 
     "0.000014860988376721592313595490808531`3.", ",", 
     "0.00002466894079555966950685966243561609`3.", ",", 
     "0.00039358680555555533488870656455560493`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5.35921045100732024933339395222909`3.*^-6", ",", 
     "8.67212495349701832853591548788685`3.*^-6", ",", 
     "0.00001200078480363893090475304464836981`3.", ",", 
     "0.00001717851082370208096097158323445342`3.", ",", 
     "0.00004047339132314010798829526094344544`3.", ",", 
     "0.0000612944664031620764553867641843965`3.", ",", 
     "0.00012511034255599480036549864259143305`2.", ",", 
     "0.00248416390728476961860526905923052254`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "8.52092796148255902813437728804402`3.*^-6", ",", 
     "0.00001484241295514302327158105698767798`3.", ",", 
     "0.00002189258823529411274221370686809962`3.", ",", 
     "0.00003074059405940593610838396099183001`3.", ",", 
     "0.00007819696969696968884624976858788159`3.", ",", 
     "0.0001314899537695590867221462350045158`2.", ",", 
     "0.00045349939613526532664750101631057078`2.", ",", 
     "0.00494786754966887194068236865973631211`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00003422450657894736549642297762652277`2.", ",", 
     "0.00006480424334271487317189058829924875`3.", ",", 
     "0.00009430127236079616529981772821145114`3.", ",", 
     "0.00015483918158567795773233877199004382`2.", ",", 
     "0.0009863203947368414693797067371860976`2.", ",", 
     "0.00175265492957746423993703466237548128`3.", ",", 
     "0.0030063959595959602322245984851178946`3.", ",", 
     "0.02464830000000000492788032602220482659`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00006564743589743589357882874724126054`3.", ",", 
     "0.0001263734187890030872050695087693839`3.", ",", 
     "0.00019683532854482575303114999520914807`2.", ",", 
     "0.00048721804511278203652160923020630889`2.", ",", 
     "0.00232738664596273368834200567789594061`3.", ",", 
     "0.00358800476190476247753680105745388573`3.", ",", 
     "0.00600400403225806456042334957601269707`3.", ",", 
     "0.04921869999999999023554408950076322071`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675598370195902*^9, 3.675738831927532*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Mathematica implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.6755864457108727`*^9, 
  3.675586449781939*^9}, {3.67573885524617*^9, 3.6757388564524107`*^9}}],

Cell[CellGroupData[{

Cell["Implementation via Dot[.,.]", "Subsubsubsubsection",
 CellChangeTimes->{{3.6757397469522657`*^9, 3.6757397545598707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"xx_", "?", "MatrixQ"}], ",", 
     RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{"#", ",", "#"}], "]"}], "&"}], ",", "xx"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675739013180179*^9, 3.67573902221411*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingsmm", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], "&"}], ")"}], ",", 
        "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675586499328845*^9, 3.675586507980432*^9}, {
  3.675586625392827*^9, 3.6755866275113153`*^9}, {3.675598385665947*^9, 
  3.675598412625558*^9}, {3.675739026045982*^9, 3.675739033173674*^9}, {
  3.675739315602481*^9, 3.675739325913767*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "7.45608458227040663001978365587163`3.*^-6", ",", 
     "7.59564208984375181994176673416774`3.*^-6", ",", 
     "8.01541037087912245078392264874267`3.*^-6", ",", 
     "8.82147143260542090025758815707846`3.*^-6", ",", 
     "0.00001016835669549657143035086698246161`3.", ",", 
     "0.00001080707272831970962810848452262391`3.", ",", 
     "0.00001395524829021706856983266187288706`2.", ",", 
     "0.00009474358974358992467774964740812038`1."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00003002617927373627435233376103962399`3.", ",", 
     "0.00003054159519725556105581090737821626`3.", ",", 
     "0.00003296369041065725665308819292143028`3.", ",", 
     "0.00003600165658311727185161843500793566`3.", ",", 
     "0.00004660805940471016671489135063666254`3.", ",", 
     "0.00005470773315873707950528909149667811`3.", ",", 
     "0.00007277249269717625740957339663950165`3.", ",", 
     "0.00058541020910209129457513199668028392`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001202281448857656213663903238542119`2.", ",", 
     "0.00001288741532791778800855122394386498`2.", ",", 
     "0.00001695018173557473839074653809699811`3.", ",", 
     "0.00001861303031819091317856061651436761`3.", ",", 
     "0.00002730865524781341243461436907313811`3.", ",", 
     "0.00003502261070067290432564557911554459`3.", ",", 
     "0.00006001426053517065208834507794577462`3.", ",", 
     "0.0013774851851851854529079632882826445`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00005055113094427035087688807046824024`3.", ",", 
     "0.00005611776726584671458244318875685508`2.", ",", 
     "0.0000745611763525042887295127269631223`3.", ",", 
     "0.00008154581738655002553714523649830426`3.", ",", 
     "0.00011960381899871631167231456061017525`3.", ",", 
     "0.00015491795085381085709738679945246531`3.", ",", 
     "0.00028463721374045791506421365646417598`3.", ",", 
     "0.00743816831683168436240016774263494881`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00009723728035667455267716807743028085`3.", ",", 
     "0.00010526206171108000843403967872191629`2.", ",", 
     "0.00015037016129032260841613677371242375`3.", ",", 
     "0.00016345234426590359217736081465233156`3.", ",", 
     "0.00023658507273877283543297989076847898`3.", ",", 
     "0.00032678758169934650143484411444205762`2.", ",", 
     "0.00078461292016806757129016025587020522`2.", ",", 
     "0.01484118999999999022332275444568949752`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00046346218749999972723666030738343125`2.", ",", 
     "0.0005114117647058824111389041533470845`2.", ",", 
     "0.00074346803196803190431907193413962887`3.", ",", 
     "0.00081019945652173930208256313889592093`3.", ",", 
     "0.00170344659090909070903174793443213275`3.", ",", 
     "0.00245003618421052796194636869131500134`3.", ",", 
     "0.00450680606060606218921105181607345003`3.", ",", 
     "0.07322360000000001367670421359434840269`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00096269610389610339035160180287675757`2.", ",", 
     "0.00105243741209564019810362989204577389`2.", ",", 
     "0.00148419345238095254715937620915156003`3.", ",", 
     "0.00173373488372093043086152874820982106`3.", ",", 
     "0.00351910328638497735265211474597890629`3.", ",", 
     "0.00489184313725490090701830681041428761`3.", ",", 
     "0.00898919277108433702194734138402054668`3.", ",", 
     "0.14574749999999997429611653387837577611`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675598400629724*^9, 3.675598661550433*^9, 
  3.675739216214953*^9, 3.675739522640366*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Implementation via Norm[.]^2", "Subsubsubsubsection",
 CellChangeTimes->{{3.6757397469522657`*^9, 3.675739765287519*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"xx_", "?", "MatrixQ"}], ",", 
     RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], ":=", 
   RowBox[{"Power", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Norm", ",", "xx"}], "]"}], ",", "2"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.675739013180179*^9, 3.67573902221411*^9}, {
  3.6757397701915417`*^9, 3.675739793918486*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingsmm", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], "&"}], ")"}], ",", 
        "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675586499328845*^9, 3.675586507980432*^9}, {
  3.675586625392827*^9, 3.6755866275113153`*^9}, {3.675598385665947*^9, 
  3.675598412625558*^9}, {3.675739026045982*^9, 3.675739033173674*^9}, {
  3.675739315602481*^9, 3.675739325913767*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.00001117826890150491288202384138061873`3.", ",", 
     "0.00001124126080125687867955659726693085`3.", ",", 
     "0.00001154045119534250451976634815887124`3.", ",", 
     "0.00001185824628046851127031232481234824`3.", ",", 
     "0.00001325139773531494445006975735346089`3.", ",", 
     "0.00001418559488692232279467494993063781`3.", ",", 
     "0.00001744557894491456111652101512721202`3.", ",", 
     "0.00007602510204081629890948690331242688`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00004516848948839468730299603893563187`3.", ",", 
     "0.00004539382063434197167291553332013621`3.", ",", 
     "0.00004707599167560068523273944518514611`3.", ",", 
     "0.00004866772172551066754329907038112424`2.", ",", 
     "0.00006042832379263083492342695235421957`3.", ",", 
     "0.00006772449440231127694867635513631399`3.", ",", 
     "0.00008563661763028848411191673584141881`3.", ",", 
     "0.00057657501933488033724756194331462211`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001184089195730666652301484725873237`3.", ",", 
     "0.00001257778766410367960913111590182112`3.", ",", 
     "0.0000149783743920912134749839905722979`3.", ",", 
     "0.00001713016698603887140472425143489232`3.", ",", 
     "0.00002592156419529836815533394012156521`3.", ",", 
     "0.00003568136291752527510011752664986773`3.", ",", 
     "0.00005694084907108859137069012401610735`3.", ",", 
     "0.00076494615384615290316905333867225636`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00004741035196687370489691815134136732`3.", ",", 
     "0.00005044064772421224298595485158180907`3.", ",", 
     "0.0000627236886490133588875975356735637`3.", ",", 
     "0.00007339143068209801968118655146611218`3.", ",", 
     "0.00011294266020299951894592660472937951`3.", ",", 
     "0.00015903382978723398094578200812065916`3.", ",", 
     "0.00028169590533433488998074634146462358`2.", ",", 
     "0.00428856321839080328189863777765822306`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00009065750748000247485544611514285407`2.", ",", 
     "0.00009751219992129080973378846275423371`3.", ",", 
     "0.00012110073051948053559148665847544635`3.", ",", 
     "0.0001433479716800611686484956397436008`3.", ",", 
     "0.00022309835575485791590334694323161102`2.", ",", 
     "0.00033187742504409156480554843327013259`2.", ",", 
     "0.00078811449579831919891315106241336252`2.", ",", 
     "0.00857272988505746770526716460381067009`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00043966015971606017646855502079006328`2.", ",", 
     "0.00047637679769894523615358927770557784`3.", ",", 
     "0.00058349882812500021740664823965971664`3.", ",", 
     "0.00069965915492957691645264928226310985`3.", ",", 
     "0.00161144696969696952539019552119725631`3.", ",", 
     "0.00248169536423841147546043295335493895`3.", ",", 
     "0.0045145333333333334188686158938708104`3.", ",", 
     "0.04250658823529411545205647371403756551`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00087583471074380119230501362537211207`3.", ",", 
     "0.00095451794871794859789759790658081329`2.", ",", 
     "0.00117566851265822765702784291619309442`2.", ",", 
     "0.00146811428571428531121567662154348`3.", ",", 
     "0.00333925503355704620528365822451632994`3.", ",", 
     "0.00494646026490066191561023600797852851`3.", ",", 
     "0.00899445783132529937120569485387022723`3.", ",", 
     "0.0851742777777777931857983162444725167`3."}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.675598400629724*^9, 3.675598661550433*^9, 
  3.675739216214953*^9, 3.675739522640366*^9, 3.675739993341981*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Implementation via Diagonal[xx.xx\[Transpose]]", "Subsubsubsubsection",
 CellChangeTimes->{{3.6757397469522657`*^9, 3.675739765287519*^9}, {
  3.675740251115926*^9, 3.6757402563396187`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "f", "]"}], ";", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"xx_", "?", "MatrixQ"}], ",", 
     RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], ":=", 
   RowBox[{"Diagonal", "[", 
    RowBox[{"xx", ".", 
     RowBox[{"Transpose", "[", "xx", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675739013180179*^9, 3.67573902221411*^9}, {
  3.6757397701915417`*^9, 3.675739793918486*^9}, {3.6757402610117197`*^9, 
  3.675740289882539*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingsmm", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], "&"}], ")"}], ",", 
        "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675586499328845*^9, 3.675586507980432*^9}, {
  3.675586625392827*^9, 3.6755866275113153`*^9}, {3.675598385665947*^9, 
  3.675598412625558*^9}, {3.675739026045982*^9, 3.675739033173674*^9}, {
  3.675739315602481*^9, 3.675739325913767*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "3.5432926944612560181087964478186`2.*^-6", ",", 
     "5.69219355620155342243048426920105`2.*^-6", ",", 
     "0.00001603414181492383744115533261709317`3.", ",", 
     "5.27853459419964002167537098220151`3.*^-6", ",", 
     "0.00001066506814017407608267788698963585`3.", ",", 
     "0.00001508217187531979552460488502863001`2.", ",", 
     "0.00002508209105560031026071685089640084`2.", ",", 
     "0.00018826075404858305792007988621605818`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001441738794435858431967206749746424`3.", ",", 
     "9.29827185522151399715579805915766`3.*^-6", ",", 
     "0.00001419451885627435651783100761802459`2.", ",", 
     "0.00002296448881007703591043342394861781`2.", ",", 
     "0.0000505138813467282196548527317681021`2.", ",", 
     "0.00007973664529914527884357083875599415`3.", ",", 
     "0.0001292999301675979036390512488807758`2.", ",", 
     "0.00151031072874494042869442100851529176`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001373908172635445393966729249468628`3.", ",", 
     "0.00001953401689843337315556116851045232`2.", ",", 
     "0.00003174212842312126717832926336981814`2.", ",", 
     "0.00004571666041744781405591069312066566`3.", ",", 
     "0.00010967042606516287206030318968075221`2.", ",", 
     "0.00020047881469562883077241421947434219`2.", ",", 
     "0.00043539295154185046234085465499674683`2.", ",", 
     "0.0060754857142857159046922532752432744`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0002381044061302683544772973434078267`2.", ",", 
     "0.00028289812646370145025886966294592639`1.", ",", 
     "0.00070004899930986921874342954197345534`2.", ",", 
     "0.00067640416666666551906428317408881412`2.", ",", 
     "0.0020697902777777788148327875461518488`2.", ",", 
     "0.00250871525423728911063925295366061619`2.", ",", 
     "0.00614470370370370777557411656744079664`2.", ",", 
     "0.05657446153846154568434201337367994711`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00228587808641975186521588803145732527`2.", ",", 
     "0.00268162724014336809399972061385142297`2.", ",", 
     "0.00315180851063829887276357410996752151`2.", ",", 
     "0.00365843910256410378631364288537497487`3.", ",", 
     "0.00739798000000000191556104311985109234`2.", ",", 
     "0.01133544615384615532327483578001192654`2.", ",", 
     "0.02067659722222222815068981560671090847`2.", ",", 
     "0.18884462500000001594635534729604842141`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.06322358333333333302306300538475625217`3.", ",", 
     "0.06606104545454544174631905661954078823`3.", ",", 
     "0.07643140000000001044178077336255228147`3.", ",", 
     "0.08920893750000001565236829037530696951`3.", ",", 
     "0.14751630000000001685656059180473675951`3.", ",", 
     "0.20454285714285713737581318127922713757`3.", ",", 
     "0.35558400000000001117683723350637592375`3.", ",", 
     "3.01363199999999986644638738653156906366`4."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.2147196666666666420297815420781262219`3.", ",", 
     "0.22947516666666664675311437804339220747`3.", ",", 
     "0.28960819999999998231032805051654577255`3.", ",", 
     "0.34308125000000000426325641456060111523`3.", ",", 
     "0.55824699999999993771382378326961770654`3.", ",", 
     "0.76524799999999992827781625237548723817`4.", ",", 
     "1.36107050000000007194955742306774482131`3.", ",", 
     "11.47734149999999964109065331285819411278`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675598400629724*^9, 3.675598661550433*^9, 
  3.675739216214953*^9, 3.675739522640366*^9, 3.675739993341981*^9, 
  3.675740523407946*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Results", "Subsubsubsection",
 CellChangeTimes->{{3.675586453813734*^9, 3.675586458589772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<C++\>\"", ",", 
       RowBox[{"Transpose", "[", "timingscpp", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<MM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingsmm", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<C++\>\"", ",", 
       RowBox[{"Transpose", "[", "timingscpp", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<MM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingsmm", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"\"\<PlotType\>\"", "\[Rule]", "\"\<Contours\>\""}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"p", "=", 
  RowBox[{"Row", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2"}], "}"}], ",", 
    RowBox[{"Alignment", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Center", ",", "Bottom"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.675585228483169*^9, 3.675585231079399*^9}, {
  3.67558573270728*^9, 3.6755857761693783`*^9}, {3.67558591764384*^9, 
  3.675585921731621*^9}, {3.6755860073122683`*^9, 3.675586007368134*^9}, {
  3.675586348538485*^9, 3.675586372265463*^9}, {3.675586774097477*^9, 
  3.675586789312622*^9}, {3.67558683717619*^9, 3.67558685018228*^9}, {
  3.6755996301857357`*^9, 3.6755996849661627`*^9}, {3.675599764331643*^9, 
  3.67559984971093*^9}, {3.675599894685419*^9, 3.6755998950933037`*^9}, {
  3.675599931667879*^9, 3.675599946939253*^9}, {3.675669242085101*^9, 
  3.675669247060527*^9}, {3.675669278532414*^9, 3.675669279259132*^9}, {
  3.675669328162595*^9, 3.675669357696048*^9}, {3.675669406239079*^9, 
  3.675669408725966*^9}, {3.6757395377930307`*^9, 3.67573954779349*^9}}],

Cell["C++ better everywhere.", "Text",
 CellChangeTimes->{{3.6757396079498863`*^9, 3.675739613997589*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "[2016-06-24] m: MM/nat vs C++ (2016, naive)  ",
 StyleBox["[MM]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.6755833406524754`*^9, 3.6755834054017553`*^9}, {
  3.6755834831665173`*^9, 3.675583493822259*^9}, {3.675671669746537*^9, 
  3.675671670266548*^9}, {3.6756721409375134`*^9, 3.675672142359215*^9}, {
  3.6757385661364727`*^9, 3.675738575144824*^9}, {3.675740550785239*^9, 
  3.6757405512796783`*^9}, {3.675746329241826*^9, 3.675746339633297*^9}, {
  3.675751405872078*^9, 3.675751407431838*^9}}],

Cell["\<\
iMac, 3.5 GHz Intel Core i5, 16 GB RAM, OS 10.11.5; Mathematica 10.4.1\
\>", "Text",
 CellChangeTimes->{{3.675670549705044*^9, 3.675670606118071*^9}}],

Cell[CellGroupData[{

Cell["Grid", "Subsubsubsection",
 CellChangeTimes->{{3.6756704065181637`*^9, 3.675670406934144*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ngrid", "=", 
   RowBox[{"{", 
    RowBox[{
    "10", ",", "50", ",", "100", ",", "500", ",", "1000", ",", "5000", ",", 
     "10000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dgrid", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "10", ",", "50", ",", "100", ",", "300", ",", "500", ",", 
     "1000", ",", "10000"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67558352273318*^9, 3.675583563019446*^9}, {
   3.675583608713636*^9, 3.675583649895831*^9}, {3.675583696238008*^9, 
   3.675583714501089*^9}, {3.675587885606567*^9, 3.675587975313457*^9}, {
   3.675597707014162*^9, 3.675597724317615*^9}, 3.675598116733819*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "bm", "]"}], ";", 
  RowBox[{
   RowBox[{"bm", "[", 
    RowBox[{"f_", ",", "n_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xx", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"First", "[", 
       RowBox[{"RepeatedTiming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "xx", "]"}], ";"}], ",", "3"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6755865239218893`*^9, 3.6755865623938217`*^9}, {
  3.675586650278653*^9, 3.675586650734549*^9}, {3.6755879791616163`*^9, 
  3.675587979241152*^9}, {3.675738614103034*^9, 3.675738621142568*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["C++ (2016) naive implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.675746346561017*^9, 
  3.675746348984899*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Path", "=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"$Path", ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<qmmlpack\>\""}], "]"}], "&"}], ")"}]}]}], 
      "]"}], ",", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", ",", 
        "\"\<mathematica\>\""}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<QMMLPack`\>\"", "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"new", " ", "version"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.675746418347074*^9, 3.675746510874631*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingscpp", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"KernelLinear", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], "&"}], ")"}], ",", 
        "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6755837310841618`*^9, 3.675583781105747*^9}, {
   3.675583812401144*^9, 3.6755838144811172`*^9}, {3.675584401481059*^9, 
   3.675584413088552*^9}, {3.675584552835106*^9, 3.6755845594826393`*^9}, {
   3.675585593154819*^9, 3.675585595441177*^9}, {3.675586438711046*^9, 
   3.675586439014894*^9}, {3.675586566584388*^9, 3.675586580969152*^9}, {
   3.675591918506966*^9, 3.67559192155416*^9}, 3.6755977433728247`*^9, {
   3.675598062822199*^9, 3.6755980708837976`*^9}, {3.6755981035665407`*^9, 
   3.675598107869968*^9}, {3.675738636237687*^9, 3.675738637597827*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "8.37321524784482947218779147480205`3.*^-6", ",", 
     "8.31557950106534321445955759699586`3.*^-6", ",", 
     "8.70543852306547627560671248625468`3.*^-6", ",", 
     "9.82281989020270699471040071193428`3.*^-6", ",", 
     "0.00001118712231559290417291525204790403`3.", ",", 
     "0.00001193542216886754390558610799955019`3.", ",", 
     "0.00001473587981146897117341442590143785`3.", ",", 
     "0.00008386890243902496054010514692222955`1."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00003123484594072705383205681983760371`3.", ",", 
     "0.00003182508574228320183743812243903903`3.", ",", 
     "0.00003414579728622166152800579408399528`2.", ",", 
     "0.00003802783295136237100850587489198062`3.", ",", 
     "0.00004895008460236885638973067247370352`3.", ",", 
     "0.00005666542694497154417912140877966465`3.", ",", 
     "0.00007483875976758165690563145977520776`3.", ",", 
     "0.00060976703163017037089693728191264199`1."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001362381272360750515606087757136677`2.", ",", 
     "0.00001441843616324328722474914371565191`2.", ",", 
     "0.00001808395544925225028286275286149021`3.", ",", 
     "0.00001959012530932446790330261898738229`3.", ",", 
     "0.00002766040462427745257522823663087763`2.", ",", 
     "0.0000373743140776214798331328337255286`3.", ",", 
     "0.00005800543053602129453831179328737733`3.", ",", 
     "0.0014044822097378287500263338571926397`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0000518177364037236671103284213479867`2.", ",", 
     "0.00005628008283132529131383148257583571`2.", ",", 
     "0.0000779368957545187708785619506990372`3.", ",", 
     "0.00008388540260908678987232522938910506`3.", ",", 
     "0.00011802967711301040024292341445999455`3.", ",", 
     "0.00016423015873015867397387290704813267`3.", ",", 
     "0.00028054743008314441407927142257960895`2.", ",", 
     "0.00742444500000000260492294401615254174`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00009646289062500000457793525310279392`3.", ",", 
     "0.00010958602072085213516728502414210311`2.", ",", 
     "0.00015038585858585869106489318891561879`3.", ",", 
     "0.00015977051282051274948801944386644891`3.", ",", 
     "0.00023596054292929289752239752075979595`3.", ",", 
     "0.00033807520325203235626865261309603738`2.", ",", 
     "0.00078095535714285755756608464750456733`2.", ",", 
     "0.01490181000000000664795773985815685592`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00048545855263157903407636450943130058`2.", ",", 
     "0.00055426740740740707003020304455276346`2.", ",", 
     "0.00072894936708860745295385230591023173`3.", ",", 
     "0.00078563612565445031625521732365768912`3.", ",", 
     "0.0016692964205816561082396098925073602`3.", ",", 
     "0.00249131833333333203503445751891831605`3.", ",", 
     "0.00451440303030302934883533083620932302`3.", ",", 
     "0.07335270000000000678586076219289680012`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0009508694267515919833211324174726542`2.", ",", 
     "0.00107080808080808127964733689196918931`2.", ",", 
     "0.00145412112403100817967227520455253398`3.", ",", 
     "0.00163935494505494422541602705933883044`3.", ",", 
     "0.00346710185185185098752369547980833886`3.", ",", 
     "0.00502659797297297199214494156649379875`3.", ",", 
     "0.00902079518072289310293143671515281312`3.", ",", 
     "0.14783450000000000756905649268446722999`2."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675598370195902*^9, 3.675738831927532*^9, 
  3.675746771686277*^9}]
}, Open  ]],

Cell["Restarted Mathematica, no load:", "Text",
 CellChangeTimes->{{3.67574699760649*^9, 3.675747002718305*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingscpp", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"KernelLinear", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], "&"}], ")"}], ",", 
        "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6755837310841618`*^9, 3.675583781105747*^9}, {
   3.675583812401144*^9, 3.6755838144811172`*^9}, {3.675584401481059*^9, 
   3.675584413088552*^9}, {3.675584552835106*^9, 3.6755845594826393`*^9}, {
   3.675585593154819*^9, 3.675585595441177*^9}, {3.675586438711046*^9, 
   3.675586439014894*^9}, {3.675586566584388*^9, 3.675586580969152*^9}, {
   3.675591918506966*^9, 3.67559192155416*^9}, 3.6755977433728247`*^9, {
   3.675598062822199*^9, 3.6755980708837976`*^9}, {3.6755981035665407`*^9, 
   3.675598107869968*^9}, {3.675738636237687*^9, 3.675738637597827*^9}, 
   3.675746994494096*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "8.19991002457865477759998279472242`2.*^-6", ",", 
     "8.36359933035713679137616860526094`3.*^-6", ",", 
     "8.72178431919643080592278311380383`3.*^-6", ",", 
     "9.70596517180525038379253210951703`3.*^-6", ",", 
     "0.00001098836732602234045514961319200964`3.", ",", 
     "0.00001171692714065595521328363298740882`3.", ",", 
     "0.00001485447698330112516445621756444595`3.", ",", 
     "0.00007862883435582868312929000209621222`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00003135913815276284599036296651952682`3.", ",", 
     "0.00003143156456866658116219501173382866`3.", ",", 
     "0.00003367330263633081188995657684337459`3.", ",", 
     "0.00003731410256410255143382295739407084`3.", ",", 
     "0.00004785275545350174545341376264318001`3.", ",", 
     "0.00005586612999403696840040531301774251`3.", ",", 
     "0.00007384410439261134245347156790373333`3.", ",", 
     "0.00058435466179159031505085941660126991`1."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001247856806406029734506958617235028`2.", ",", 
     "0.00001346095611818882631567119434468083`2.", ",", 
     "0.00001765911129999526673326794290463937`3.", ",", 
     "0.00001957522517804775557376771588646847`3.", ",", 
     "0.00002709941860465115174780303952672966`3.", ",", 
     "0.0000365289314614409914815096325213517`3.", ",", 
     "0.00005812836052836051903150785258311828`3.", ",", 
     "0.00137867584940312183638955190190245048`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00004975865641711230971059448657811686`2.", ",", 
     "0.0000549429275831616107089033773647202`2.", ",", 
     "0.00007609727388535031237550010363435149`3.", ",", 
     "0.00008610970003447878772916829204220335`3.", ",", 
     "0.00011797158911047802328907890823117555`3.", ",", 
     "0.00016028572956782206350954955720311546`3.", ",", 
     "0.00028834652509652510627910504403814684`3.", ",", 
     "0.00737219117647058830300466070184484124`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00009557991311677357319353393050320733`3.", ",", 
     "0.00010682421652421651746614483791120165`2.", ",", 
     "0.0001500987357013846721850991450253332`3.", ",", 
     "0.00016462612810917896474273425244660984`3.", ",", 
     "0.0002339076850984067384390391319826108`3.", ",", 
     "0.00033331339285714282503689243064570746`3.", ",", 
     "0.00076434183673469344687256832315824795`2.", ",", 
     "0.01477500980392157034493116896101128077`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00046913280254777073264779718719807988`3.", ",", 
     "0.00052260491228070201676081385500083343`2.", ",", 
     "0.00072395472249269703177848578334874219`3.", ",", 
     "0.00080282634408602169314578267389492794`3.", ",", 
     "0.00164531688596491402869215203708108675`3.", ",", 
     "0.0024713996710526305554400661179670351`2.", ",", 
     "0.00450298787878787923344425792038236978`3.", ",", 
     "0.07310795000000000487538898141792742535`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00093391392405063329389125481583278088`3.", ",", 
     "0.00106033048433048430851666221741425034`2.", ",", 
     "0.00144294401544401503130476971392681662`3.", ",", 
     "0.00173266046511627862421189849584379772`3.", ",", 
     "0.00342253652968036586878852745030599181`3.", ",", 
     "0.00494665894039735161424875542479639989`3.", ",", 
     "0.00887545238095237797038006277716704062`3.", ",", 
     "0.14690580000000000304716252230718964711`2."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675747177006865*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Mathematica implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.6755864457108727`*^9, 
  3.675586449781939*^9}, {3.67573885524617*^9, 3.6757388564524107`*^9}}],

Cell[CellGroupData[{

Cell["Implementation via Norm[.]^2", "Subsubsubsubsection",
 CellChangeTimes->{{3.6757397469522657`*^9, 3.675739765287519*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"xx_", "?", "MatrixQ"}], ",", 
     RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], ":=", 
   RowBox[{"Power", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Norm", ",", "xx"}], "]"}], ",", "2"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.675739013180179*^9, 3.67573902221411*^9}, {
  3.6757397701915417`*^9, 3.675739793918486*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingsmm", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], "&"}], ")"}], ",", 
        "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675586499328845*^9, 3.675586507980432*^9}, {
  3.675586625392827*^9, 3.6755866275113153`*^9}, {3.675598385665947*^9, 
  3.675598412625558*^9}, {3.675739026045982*^9, 3.675739033173674*^9}, {
  3.675739315602481*^9, 3.675739325913767*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.00001117826890150491288202384138061873`3.", ",", 
     "0.00001124126080125687867955659726693085`3.", ",", 
     "0.00001154045119534250451976634815887124`3.", ",", 
     "0.00001185824628046851127031232481234824`3.", ",", 
     "0.00001325139773531494445006975735346089`3.", ",", 
     "0.00001418559488692232279467494993063781`3.", ",", 
     "0.00001744557894491456111652101512721202`3.", ",", 
     "0.00007602510204081629890948690331242688`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00004516848948839468730299603893563187`3.", ",", 
     "0.00004539382063434197167291553332013621`3.", ",", 
     "0.00004707599167560068523273944518514611`3.", ",", 
     "0.00004866772172551066754329907038112424`2.", ",", 
     "0.00006042832379263083492342695235421957`3.", ",", 
     "0.00006772449440231127694867635513631399`3.", ",", 
     "0.00008563661763028848411191673584141881`3.", ",", 
     "0.00057657501933488033724756194331462211`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001184089195730666652301484725873237`3.", ",", 
     "0.00001257778766410367960913111590182112`3.", ",", 
     "0.0000149783743920912134749839905722979`3.", ",", 
     "0.00001713016698603887140472425143489232`3.", ",", 
     "0.00002592156419529836815533394012156521`3.", ",", 
     "0.00003568136291752527510011752664986773`3.", ",", 
     "0.00005694084907108859137069012401610735`3.", ",", 
     "0.00076494615384615290316905333867225636`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00004741035196687370489691815134136732`3.", ",", 
     "0.00005044064772421224298595485158180907`3.", ",", 
     "0.0000627236886490133588875975356735637`3.", ",", 
     "0.00007339143068209801968118655146611218`3.", ",", 
     "0.00011294266020299951894592660472937951`3.", ",", 
     "0.00015903382978723398094578200812065916`3.", ",", 
     "0.00028169590533433488998074634146462358`2.", ",", 
     "0.00428856321839080328189863777765822306`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00009065750748000247485544611514285407`2.", ",", 
     "0.00009751219992129080973378846275423371`3.", ",", 
     "0.00012110073051948053559148665847544635`3.", ",", 
     "0.0001433479716800611686484956397436008`3.", ",", 
     "0.00022309835575485791590334694323161102`2.", ",", 
     "0.00033187742504409156480554843327013259`2.", ",", 
     "0.00078811449579831919891315106241336252`2.", ",", 
     "0.00857272988505746770526716460381067009`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00043966015971606017646855502079006328`2.", ",", 
     "0.00047637679769894523615358927770557784`3.", ",", 
     "0.00058349882812500021740664823965971664`3.", ",", 
     "0.00069965915492957691645264928226310985`3.", ",", 
     "0.00161144696969696952539019552119725631`3.", ",", 
     "0.00248169536423841147546043295335493895`3.", ",", 
     "0.0045145333333333334188686158938708104`3.", ",", 
     "0.04250658823529411545205647371403756551`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00087583471074380119230501362537211207`3.", ",", 
     "0.00095451794871794859789759790658081329`2.", ",", 
     "0.00117566851265822765702784291619309442`2.", ",", 
     "0.00146811428571428531121567662154348`3.", ",", 
     "0.00333925503355704620528365822451632994`3.", ",", 
     "0.00494646026490066191561023600797852851`3.", ",", 
     "0.00899445783132529937120569485387022723`3.", ",", 
     "0.0851742777777777931857983162444725167`3."}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.675598400629724*^9, 3.675598661550433*^9, 
  3.675739216214953*^9, 3.675739522640366*^9, 3.675739993341981*^9}]
}, Open  ]],

Cell["Redone, no load:", "Text",
 CellChangeTimes->{{3.6757472596120777`*^9, 3.6757472624596*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingsmm", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], "&"}], ")"}], ",", 
        "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.00001066760784313725143402154516003577`3.", ",", 
     "0.00001072335361205792813275861075084094`3.", ",", 
     "0.00001092449922958397991038567015342764`3.", ",", 
     "0.00001123257456239201159363394477708198`3.", ",", 
     "0.00001266460926255185697624806862027214`3.", ",", 
     "0.00001358010469307540010448862727310271`3.", ",", 
     "0.00001672462793616638992663138429950465`3.", ",", 
     "0.00007524139850232748410411437456346562`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00004270532673097289635749315706014784`2.", ",", 
     "0.00004311659322820034641017897247827761`3.", ",", 
     "0.00004426626305792971368194277381746815`3.", ",", 
     "0.0000459180464085677606921737092804392`3.", ",", 
     "0.00005648741756992343223146499364695217`3.", ",", 
     "0.00006399584190672150260052047920922291`3.", ",", 
     "0.00008195921849201979786543603712090089`3.", ",", 
     "0.00055395440956651693410750514345863849`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0000119515608094570323832522493190389`3.", ",", 
     "0.0000126155197459545270494835067509598`3.", ",", 
     "0.00001477452662721893248310052471072851`3.", ",", 
     "0.00001684798844739276283181093896157421`3.", ",", 
     "0.00002589792231255644673962312829473831`3.", ",", 
     "0.00003491395294665735769736730764734034`3.", ",", 
     "0.00005644392911010559879016190709677403`3.", ",", 
     "0.0007523566398390343261740054181530013`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00004937259392008495456063629780452118`3.", ",", 
     "0.00005111284340659337933465006242883533`3.", ",", 
     "0.00006248875749500334335437973232174613`3.", ",", 
     "0.00007438549618320612188265839037626392`3.", ",", 
     "0.00011405974025974025215599688687362345`3.", ",", 
     "0.00015759564164648920793834752096529428`2.", ",", 
     "0.00028280102234002268621337883303112903`3.", ",", 
     "0.00423413920454545397026313580113310309`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00009314655875525439175481590137195553`3.", ",", 
     "0.00010111950067476380631884685934451795`2.", ",", 
     "0.0001252877637130801844345812101622073`3.", ",", 
     "0.00014339427860696513810680186029600236`3.", ",", 
     "0.0002230451545154515165681613497739022`3.", ",", 
     "0.00032814464442493403682765684692412833`2.", ",", 
     "0.00075993214285714294573687022094077292`2.", ",", 
     "0.0084815624999999960492713668713804509`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00046893575949367088473787590352515053`3.", ",", 
     "0.00050064290540540563271415530621766266`3.", ",", 
     "0.00059657211538461567355146053515113636`3.", ",", 
     "0.00070351132075471660420884489894888247`3.", ",", 
     "0.00158072890295358602780195766968063253`3.", ",", 
     "0.00243862175324675422433129412524976942`3.", ",", 
     "0.00448609036144578202792709831214779115`3.", ",", 
     "0.04215634285714285611756935168159543537`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00092439444444444472063354689694847366`3.", ",", 
     "0.00099484466666666690297382569241335659`3.", ",", 
     "0.00120435473515248742462646625028810377`3.", ",", 
     "0.00147006960784313699813763420820578176`3.", ",", 
     "0.00331456222222222072343322807341792213`3.", ",", 
     "0.00490808552631578996067185371998675691`3.", ",", 
     "0.00893480357142857097019206236154786893`3.", ",", 
     "0.08443683333333333596026903933307039551`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675747444057185*^9, 3.675747649946*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Results", "Subsubsubsection",
 CellChangeTimes->{{3.675586453813734*^9, 3.675586458589772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<C++\>\"", ",", 
       RowBox[{"Transpose", "[", "timingscpp", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<MM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingsmm", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<C++\>\"", ",", 
       RowBox[{"Transpose", "[", "timingscpp", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<MM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingsmm", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"\"\<PlotType\>\"", "\[Rule]", "\"\<Contours\>\""}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"p", "=", 
  RowBox[{"Row", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2"}], "}"}], ",", 
    RowBox[{"Alignment", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Center", ",", "Bottom"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.675585228483169*^9, 3.675585231079399*^9}, {
  3.67558573270728*^9, 3.6755857761693783`*^9}, {3.67558591764384*^9, 
  3.675585921731621*^9}, {3.6755860073122683`*^9, 3.675586007368134*^9}, {
  3.675586348538485*^9, 3.675586372265463*^9}, {3.675586774097477*^9, 
  3.675586789312622*^9}, {3.67558683717619*^9, 3.67558685018228*^9}, {
  3.6755996301857357`*^9, 3.6755996849661627`*^9}, {3.675599764331643*^9, 
  3.67559984971093*^9}, {3.675599894685419*^9, 3.6755998950933037`*^9}, {
  3.675599931667879*^9, 3.675599946939253*^9}, {3.675669242085101*^9, 
  3.675669247060527*^9}, {3.675669278532414*^9, 3.675669279259132*^9}, {
  3.675669328162595*^9, 3.675669357696048*^9}, {3.675669406239079*^9, 
  3.675669408725966*^9}, {3.6757395377930307`*^9, 3.67573954779349*^9}}],

Cell["MM better for larger n", "Text",
 CellChangeTimes->{{3.6757479273211107`*^9, 3.675747929832531*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "[2016-06-24] m: MM/nat vs C++ (2016, BLAS)  ",
 StyleBox["[C++/BLAS]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.6755833406524754`*^9, 3.6755834054017553`*^9}, {
  3.6755834831665173`*^9, 3.675583493822259*^9}, {3.675671669746537*^9, 
  3.675671670266548*^9}, {3.6756721409375134`*^9, 3.675672142359215*^9}, {
  3.6757385661364727`*^9, 3.675738575144824*^9}, {3.675740550785239*^9, 
  3.6757405512796783`*^9}, {3.675746329241826*^9, 3.675746339633297*^9}, {
  3.675751400472402*^9, 3.6757514108479433`*^9}, {3.675751797744484*^9, 
  3.675751797864401*^9}, {3.67575353314841*^9, 3.675753535596517*^9}}],

Cell["\<\
iMac, 3.5 GHz Intel Core i5, 16 GB RAM, OS 10.11.5; Mathematica 10.4.1\
\>", "Text",
 CellChangeTimes->{{3.675670549705044*^9, 3.675670606118071*^9}}],

Cell[CellGroupData[{

Cell["Grid", "Subsubsubsection",
 CellChangeTimes->{{3.6756704065181637`*^9, 3.675670406934144*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ngrid", "=", 
   RowBox[{"{", 
    RowBox[{
    "10", ",", "50", ",", "100", ",", "500", ",", "1000", ",", "5000", ",", 
     "10000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dgrid", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "10", ",", "50", ",", "100", ",", "300", ",", "500", ",", 
     "1000", ",", "10000"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67558352273318*^9, 3.675583563019446*^9}, {
   3.675583608713636*^9, 3.675583649895831*^9}, {3.675583696238008*^9, 
   3.675583714501089*^9}, {3.675587885606567*^9, 3.675587975313457*^9}, {
   3.675597707014162*^9, 3.675597724317615*^9}, 3.675598116733819*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "bm", "]"}], ";", 
  RowBox[{
   RowBox[{"bm", "[", 
    RowBox[{"f_", ",", "n_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xx", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"First", "[", 
       RowBox[{"RepeatedTiming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "xx", "]"}], ";"}], ",", "3"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6755865239218893`*^9, 3.6755865623938217`*^9}, {
  3.675586650278653*^9, 3.675586650734549*^9}, {3.6755879791616163`*^9, 
  3.675587979241152*^9}, {3.675738614103034*^9, 3.675738621142568*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["C++ (2016) BLAS implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.675746346561017*^9, 
  3.675746348984899*^9}, {3.675751418479568*^9, 3.675751420191639*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Path", "=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"$Path", ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<qmmlpack\>\""}], "]"}], "&"}], ")"}]}]}], 
      "]"}], ",", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", ",", 
        "\"\<mathematica\>\""}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<QMMLPack`\>\"", "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"new", " ", "version"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.675746418347074*^9, 3.675746510874631*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingscpp", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"KernelLinear", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], "&"}], ")"}], ",", 
        "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6755837310841618`*^9, 3.675583781105747*^9}, {
   3.675583812401144*^9, 3.6755838144811172`*^9}, {3.675584401481059*^9, 
   3.675584413088552*^9}, {3.675584552835106*^9, 3.6755845594826393`*^9}, {
   3.675585593154819*^9, 3.675585595441177*^9}, {3.675586438711046*^9, 
   3.675586439014894*^9}, {3.675586566584388*^9, 3.675586580969152*^9}, {
   3.675591918506966*^9, 3.67559192155416*^9}, 3.6755977433728247`*^9, {
   3.675598062822199*^9, 3.6755980708837976`*^9}, {3.6755981035665407`*^9, 
   3.675598107869968*^9}, {3.675738636237687*^9, 3.675738637597827*^9}, 
   3.675746994494096*^9, 3.675753255614111*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.14130515716642091375229717264972`2.*^-6", ",", 
     "2.42591890806384417175940206023999`3.*^-6", ",", 
     "2.45590179135100950046175644070345`3.*^-6", ",", 
     "2.52935580549569041897508582528165`3.*^-6", ",", 
     "2.86136061338062737798232718078317`3.*^-6", ",", 
     "3.19318879639738105501514664474882`3.*^-6", ",", 
     "3.86607142857142646607832708882668`3.*^-6", ",", 
     "0.00002273636640755982474314603192233619`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.30956723186119588231966261171468`2.*^-6", ",", 
     "2.82011077763030848145455256603675`3.*^-6", ",", 
     "3.15353919719827363685616533617306`3.*^-6", ",", 
     "3.47690116538004716912040742426981`3.*^-6", ",", 
     "4.87846354166666718493771195963582`3.*^-6", ",", 
     "6.78774685329861115113021796663162`3.*^-6", ",", 
     "0.00001372938182219117927648516924721278`3.", ",", 
     "0.00011052528693076639476882555568337807`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.50533597763270431376726211925021`2.*^-6", ",", 
     "3.33228929384965522143336770499733`3.*^-6", ",", 
     "3.95468222128378335685720129655252`3.*^-6", ",", 
     "4.5293422261996944293478174758949`3.*^-6", ",", 
     "8.91557498094511778098658627556006`3.*^-6", ",", 
     "0.00001443014252696455582255976451966362`3.", ",", 
     "0.00002418360389610388493813498966833464`3.", ",", 
     "0.00037777707489878529232077419841573374`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.11227725596910455264313549728072`3.*^-6", ",", 
     "7.3288867187499965707487593891134`3.*^-6", ",", 
     "0.00001064626418325840033973165438263564`3.", ",", 
     "0.00001505834670947030935197422790716715`3.", ",", 
     "0.00003865419130615207164713975629410925`3.", ",", 
     "0.00005922264001583214408554883823043724`3.", ",", 
     "0.00011976510658759414095983486525653916`3.", ",", 
     "0.00247275165562913738087624793138274981`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "6.13799894957983453513484031760505`3.*^-6", ",", 
     "0.00001229762022316579228868767270643758`3.", ",", 
     "0.00001920397165309770847385281711261484`3.", ",", 
     "0.00002644980217606330709476276930036676`3.", ",", 
     "0.00007385937191388498228132586387317815`3.", ",", 
     "0.00012762587472264885876845064149875952`3.", ",", 
     "0.00043347714120370420308805958775622003`2.", ",", 
     "0.00491704934210526137944308189275943732`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00002186695014662756863664701267868651`3.", ",", 
     "0.00005194092169092171911966640540647688`3.", ",", 
     "0.00008174092274092269270330257668888407`3.", ",", 
     "0.00013172535087719295884313430722301064`2.", ",", 
     "0.00096385969387755097287362460178883339`2.", ",", 
     "0.00170917808219178094138179790917320133`3.", ",", 
     "0.00297102777777777816298199198286056344`3.", ",", 
     "0.02452819999999999653339521898942621192`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00004165066614420058081812506256547124`3.", ",", 
     "0.00010074810606060603573787964881702806`3.", ",", 
     "0.00017353921568627443000089327629353875`3.", ",", 
     "0.00045900731707317120409289623594872864`2.", ",", 
     "0.00222049850746268602474930986545587075`3.", ",", 
     "0.00345471064814814859261771218257308647`3.", ",", 
     "0.00590355952380952706676220387294051761`3.", ",", 
     "0.04884276666666666211202851854977780022`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675753430620298*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Mathematica implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.6755864457108727`*^9, 
  3.675586449781939*^9}, {3.67573885524617*^9, 3.6757388564524107`*^9}}],

Cell[CellGroupData[{

Cell["Implementation via Norm[.]^2", "Subsubsubsubsection",
 CellChangeTimes->{{3.6757397469522657`*^9, 3.675739765287519*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"xx_", "?", "MatrixQ"}], ",", 
     RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], ":=", 
   RowBox[{"Power", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"Norm", ",", "xx"}], "]"}], ",", "2"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.675739013180179*^9, 3.67573902221411*^9}, {
  3.6757397701915417`*^9, 3.675739793918486*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingsmm", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], "&"}], ")"}], ",", 
        "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.00001066760784313725143402154516003577`3.", ",", 
     "0.00001072335361205792813275861075084094`3.", ",", 
     "0.00001092449922958397991038567015342764`3.", ",", 
     "0.00001123257456239201159363394477708198`3.", ",", 
     "0.00001266460926255185697624806862027214`3.", ",", 
     "0.00001358010469307540010448862727310271`3.", ",", 
     "0.00001672462793616638992663138429950465`3.", ",", 
     "0.00007524139850232748410411437456346562`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00004270532673097289635749315706014784`2.", ",", 
     "0.00004311659322820034641017897247827761`3.", ",", 
     "0.00004426626305792971368194277381746815`3.", ",", 
     "0.0000459180464085677606921737092804392`3.", ",", 
     "0.00005648741756992343223146499364695217`3.", ",", 
     "0.00006399584190672150260052047920922291`3.", ",", 
     "0.00008195921849201979786543603712090089`3.", ",", 
     "0.00055395440956651693410750514345863849`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0000119515608094570323832522493190389`3.", ",", 
     "0.0000126155197459545270494835067509598`3.", ",", 
     "0.00001477452662721893248310052471072851`3.", ",", 
     "0.00001684798844739276283181093896157421`3.", ",", 
     "0.00002589792231255644673962312829473831`3.", ",", 
     "0.00003491395294665735769736730764734034`3.", ",", 
     "0.00005644392911010559879016190709677403`3.", ",", 
     "0.0007523566398390343261740054181530013`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00004937259392008495456063629780452118`3.", ",", 
     "0.00005111284340659337933465006242883533`3.", ",", 
     "0.00006248875749500334335437973232174613`3.", ",", 
     "0.00007438549618320612188265839037626392`3.", ",", 
     "0.00011405974025974025215599688687362345`3.", ",", 
     "0.00015759564164648920793834752096529428`2.", ",", 
     "0.00028280102234002268621337883303112903`3.", ",", 
     "0.00423413920454545397026313580113310309`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00009314655875525439175481590137195553`3.", ",", 
     "0.00010111950067476380631884685934451795`2.", ",", 
     "0.0001252877637130801844345812101622073`3.", ",", 
     "0.00014339427860696513810680186029600236`3.", ",", 
     "0.0002230451545154515165681613497739022`3.", ",", 
     "0.00032814464442493403682765684692412833`2.", ",", 
     "0.00075993214285714294573687022094077292`2.", ",", 
     "0.0084815624999999960492713668713804509`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00046893575949367088473787590352515053`3.", ",", 
     "0.00050064290540540563271415530621766266`3.", ",", 
     "0.00059657211538461567355146053515113636`3.", ",", 
     "0.00070351132075471660420884489894888247`3.", ",", 
     "0.00158072890295358602780195766968063253`3.", ",", 
     "0.00243862175324675422433129412524976942`3.", ",", 
     "0.00448609036144578202792709831214779115`3.", ",", 
     "0.04215634285714285611756935168159543537`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00092439444444444472063354689694847366`3.", ",", 
     "0.00099484466666666690297382569241335659`3.", ",", 
     "0.00120435473515248742462646625028810377`3.", ",", 
     "0.00147006960784313699813763420820578176`3.", ",", 
     "0.00331456222222222072343322807341792213`3.", ",", 
     "0.00490808552631578996067185371998675691`3.", ",", 
     "0.00893480357142857097019206236154786893`3.", ",", 
     "0.08443683333333333596026903933307039551`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675747444057185*^9, 3.675747649946*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Results", "Subsubsubsection",
 CellChangeTimes->{{3.675586453813734*^9, 3.675586458589772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<C++\>\"", ",", 
       RowBox[{"Transpose", "[", "timingscpp", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<MM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingsmm", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<C++\>\"", ",", 
       RowBox[{"Transpose", "[", "timingscpp", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<MM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingsmm", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"\"\<PlotType\>\"", "\[Rule]", "\"\<Contours\>\""}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"p", "=", 
  RowBox[{"Row", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2"}], "}"}], ",", 
    RowBox[{"Alignment", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Center", ",", "Bottom"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.675585228483169*^9, 3.675585231079399*^9}, {
  3.67558573270728*^9, 3.6755857761693783`*^9}, {3.67558591764384*^9, 
  3.675585921731621*^9}, {3.6755860073122683`*^9, 3.675586007368134*^9}, {
  3.675586348538485*^9, 3.675586372265463*^9}, {3.675586774097477*^9, 
  3.675586789312622*^9}, {3.67558683717619*^9, 3.67558685018228*^9}, {
  3.6755996301857357`*^9, 3.6755996849661627`*^9}, {3.675599764331643*^9, 
  3.67559984971093*^9}, {3.675599894685419*^9, 3.6755998950933037`*^9}, {
  3.675599931667879*^9, 3.675599946939253*^9}, {3.675669242085101*^9, 
  3.675669247060527*^9}, {3.675669278532414*^9, 3.675669279259132*^9}, {
  3.675669328162595*^9, 3.675669357696048*^9}, {3.675669406239079*^9, 
  3.675669408725966*^9}, {3.6757395377930307`*^9, 3.67573954779349*^9}}],

Cell["C++/BLAS better throughout.", "Text",
 CellChangeTimes->{{3.6757479273211107`*^9, 3.675747929832531*^9}, {
  3.6757517775861073`*^9, 3.675751780361191*^9}, {3.675753518228978*^9, 
  3.675753524508707*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "[2016-06-24] L: MM/nat vs C++ (2016, BLAS)  ",
 StyleBox["[C++/BLAS]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.6755833406524754`*^9, 3.6755834054017553`*^9}, {
  3.6755834831665173`*^9, 3.675583493822259*^9}, {3.675670626717189*^9, 
  3.675670643484375*^9}, {3.675671662284398*^9, 3.675671662850811*^9}, {
  3.6756721496229467`*^9, 3.675672162062339*^9}, {3.6756727145843973`*^9, 
  3.675672741671221*^9}, {3.675678230670579*^9, 3.675678238982194*^9}, {
  3.675678717195244*^9, 3.675678717515177*^9}, {3.675757352270879*^9, 
  3.6757573691021214`*^9}, {3.675758138455759*^9, 3.6757581404957733`*^9}}],

Cell["\<\
iMac, 3.5 GHz Intel Core i5, 16 GB RAM, OS 10.11.5; Mathematica 10.4.1\
\>", "Text",
 CellChangeTimes->{{3.675670549705044*^9, 3.675670606118071*^9}}],

Cell[CellGroupData[{

Cell["Grid", "Subsubsubsection",
 CellChangeTimes->{{3.6756704065181637`*^9, 3.675670406934144*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ngrid", "=", 
   RowBox[{"{", 
    RowBox[{
    "10", ",", "50", ",", "100", ",", "500", ",", "1000", ",", "5000", ",", 
     "10000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dgrid", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "10", ",", "50", ",", "100", ",", "300", ",", "500", ",", 
     "1000", ",", "10000"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67558352273318*^9, 3.675583563019446*^9}, {
   3.675583608713636*^9, 3.675583649895831*^9}, {3.675583696238008*^9, 
   3.675583714501089*^9}, {3.675587885606567*^9, 3.675587975313457*^9}, {
   3.675597707014162*^9, 3.675597724317615*^9}, 3.675598116733819*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "bm", "]"}], ";", 
  RowBox[{
   RowBox[{"bm", "[", 
    RowBox[{"f_", ",", "n_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xx", ",", "zz"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xx", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zz", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"First", "[", 
       RowBox[{"RepeatedTiming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"xx", ",", "zz"}], "]"}], ";"}], ",", "3"}], "]"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6755865239218893`*^9, 3.6755865623938217`*^9}, {
  3.675586650278653*^9, 3.675586650734549*^9}, {3.6755879791616163`*^9, 
  3.675587979241152*^9}, {3.675672842411611*^9, 3.675672853515049*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Compiled C implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.6755864457108727`*^9, 
  3.675586449781939*^9}, {3.6756782690050583`*^9, 3.675678269725006*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"k", "[", 
    RowBox[{"xx_", ",", "zz_"}], "]"}], ":=", 
   RowBox[{"xx", ".", 
    RowBox[{"Transpose", "[", "zz", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675670701628518*^9, 3.6756707087707767`*^9}, {
  3.675672766918335*^9, 3.675672773230054*^9}, {3.6756728240600357`*^9, 
  3.675672824491921*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingsnat", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{"k", ",", "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675586499328845*^9, 3.675586507980432*^9}, {
  3.675586625392827*^9, 3.6755866275113153`*^9}, {3.675598385665947*^9, 
  3.675598412625558*^9}, {3.6756783292909527`*^9, 3.6756783296908693`*^9}, {
  3.6757574113247433`*^9, 3.675757418604328*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.20691653332078465310668591303767`2.*^-6", ",", 
     "4.34952799479166678480856339517047`2.*^-6", ",", 
     "0.00001453498315121057592484363207852027`3.", ",", 
     "3.7546724759615412356477791994136`3.*^-6", ",", 
     "9.11443481445312430710807560796383`3.*^-6", ",", 
     "0.00001512110726643605748003868632922675`1.", ",", 
     "0.00002477945035216123101460411470853273`1.", ",", 
     "0.00018600099651220719206359821562557499`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001307648448962022127354913603181075`2.", ",", 
     "7.74418712797618927581345948940594`3.*^-6", ",", 
     "0.00001303405510432712502118593467237417`2.", ",", 
     "0.00002090678037187196317979627491201455`2.", ",", 
     "0.00004855406381302523373269877660085569`3.", ",", 
     "0.00007862436974789917991986859524544684`2.", ",", 
     "0.00012737851750171586321346006709376297`2.", ",", 
     "0.00161102689075630334768207685414154184`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00001230571494525787757290564983225778`3.", ",", 
     "0.00001774610573236197556259638452580418`2.", ",", 
     "0.00003077830704196308510799118263179253`2.", ",", 
     "0.00004446742984195660409411227087517204`3.", ",", 
     "0.00010875322604030736924497074769035976`2.", ",", 
     "0.00019762254120148876131331239225374929`2.", ",", 
     "0.00042861310649023307874083688062682995`2.", ",", 
     "0.00609699180327868614504005506660178071`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00023744877049180362644370534397353367`3.", ",", 
     "0.00042913188405797100246838460257947645`2.", ",", 
     "0.0004734590347923683354043611348771492`2.", ",", 
     "0.00070179887218045156407897344763568981`2.", ",", 
     "0.00222358233532933763712535757406385528`2.", ",", 
     "0.0031751153846153821330711153336778807`2.", ",", 
     "0.00557566914498141587286372811149703921`2.", ",", 
     "0.0582373846153846214113158907821343746`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00261494473229706295494545464919156075`2.", ",", 
     "0.00310787500000000039418468489316182968`2.", ",", 
     "0.0034337361111111104963744544704695727`2.", ",", 
     "0.00404147043010752785030526013088092441`2.", ",", 
     "0.00700621226415094108114223203642723092`2.", ",", 
     "0.01019347260273972648192408740897008101`2.", ",", 
     "0.0195490657894736852284722772310487926`2.", ",", 
     "0.16779387500000000899014196420466760173`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.06558622727272725438929512620234163478`2.", ",", 
     "0.06863968181818180802622464398154988885`2.", ",", 
     "0.07888933333333331132664056895009707659`3.", ",", 
     "0.09148162500000001084998757505672983825`3.", ",", 
     "0.14857029999999998848281279606453608721`3.", ",", 
     "0.20492400000000002280309274738101521507`3.", ",", 
     "0.35730700000000004123990038351621478796`3.", ",", 
     "3.13448300000000035225866668042726814747`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.22145833333333331260917020699707791209`3.", ",", 
     "0.23815583333333334437043049547355622053`3.", ",", 
     "0.28930899999999998284394564507238101214`3.", ",", 
     "0.34265799999999996261479395798232872039`3.", ",", 
     "0.57860099999999992093080436461605131626`3.", ",", 
     "0.77473700000000000898126018000766634941`3.", ",", 
     "1.41425800000000001510613856225972995162`2.", ",", 
     "12.040087500000000275690581474918872118`3."}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.675678602347081*^9, 3.6757576645987864`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["C++/BLAS implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.6755864457108727`*^9, 
  3.675586449781939*^9}, {3.6757576725957737`*^9, 3.675757674770166*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Path", "=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"$Path", ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<qmmlpack\>\""}], "]"}], "&"}], ")"}]}]}], 
      "]"}], ",", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", ",", 
        "\"\<mathematica\>\""}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<QMMLPack`\>\"", "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"new", " ", "version"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.675746418347074*^9, 3.675746510874631*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingscpp", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"KernelLinear", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], "&"}], ")"}], ",", 
        "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6755837310841618`*^9, 3.675583781105747*^9}, {
   3.675583812401144*^9, 3.6755838144811172`*^9}, {3.675584401481059*^9, 
   3.675584413088552*^9}, {3.675584552835106*^9, 3.6755845594826393`*^9}, {
   3.675585593154819*^9, 3.675585595441177*^9}, {3.675586438711046*^9, 
   3.675586439014894*^9}, {3.675586566584388*^9, 3.675586580969152*^9}, {
   3.675591918506966*^9, 3.67559192155416*^9}, 3.6755977433728247`*^9, {
   3.675598062822199*^9, 3.6755980708837976`*^9}, {3.6755981035665407`*^9, 
   3.675598107869968*^9}, {3.675738636237687*^9, 3.675738637597827*^9}, 
   3.675746994494096*^9, 3.675753255614111*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.14991674732669407228832433864874`2.*^-6", ",", 
     "2.42970056438127169764020808762073`3.*^-6", ",", 
     "2.53500561904246136750960827210832`3.*^-6", ",", 
     "2.58031360815602930599329395411345`3.*^-6", ",", 
     "2.94693944521760694142046947685554`3.*^-6", ",", 
     "3.29632073479729954812444958633932`3.*^-6", ",", 
     "3.95556772950542118822900294894396`3.*^-6", ",", 
     "0.00002287062681104162827224433873762877`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.32525266617063312203791090870819`2.*^-6", ",", 
     "2.84188030946601835358697810129947`3.*^-6", ",", 
     "3.16838304924242236015234988610878`3.*^-6", ",", 
     "3.53833833408815919241126660144126`3.*^-6", ",", 
     "4.91507523148148084581173997142933`3.*^-6", ",", 
     "6.85077391431924898523766337410379`3.*^-6", ",", 
     "0.0000138368461053646240520266161300178`3.", ",", 
     "0.00011536061538461532917972801604022948`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.5441103413545307766578662533874`2.*^-6", ",", 
     "3.35261073681193049755041961368374`3.*^-6", ",", 
     "3.99533598019125852073571772415939`3.*^-6", ",", 
     "4.56769714355468696160688518714821`3.*^-6", ",", 
     "8.9998975212191373919965245442576`3.*^-6", ",", 
     "0.00001450792538069088305290564588911906`3.", ",", 
     "0.00002424196884493571581796478309200893`3.", ",", 
     "0.00037925101317122571166137734444134821`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.15597534179687156600645908666181`3.*^-6", ",", 
     "7.39409229008838264710903528942332`3.*^-6", ",", 
     "0.00001069206944624096054677429151746892`3.", ",", 
     "0.00001509279141104294543569361297663534`3.", ",", 
     "0.00003862926804070458035658686135604967`3.", ",", 
     "0.00005917688501880073465716280978199393`3.", ",", 
     "0.00012595390190460147689620329369830642`3.", ",", 
     "0.00247340562913907343819963635667136259`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "6.13221343224789937836156569761492`3.*^-6", ",", 
     "0.00001229409828511241586218843274691537`3.", ",", 
     "0.00001916304959100204320892983644863961`3.", ",", 
     "0.00002646496161873429983353404881807336`3.", ",", 
     "0.00007411512605042018747916743315329313`3.", ",", 
     "0.00013315089126559714318917548858678401`3.", ",", 
     "0.00043860846560846573601380460338816647`3.", ",", 
     "0.00492134210526315712258549339708224579`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00002194412050534497941444572743918684`3.", ",", 
     "0.00005189329013377927168936334934024046`3.", ",", 
     "0.00008139080646911969394146496581399219`3.", ",", 
     "0.00013504160623640330536436582331560885`3.", ",", 
     "0.0009490825396825398321473676865878133`2.", ",", 
     "0.00171362298850574832492776877757023613`3.", ",", 
     "0.00299188690476190431027925242801757122`2.", ",", 
     "0.02447433333333334098957934088502952363`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0000417117335562987943801439849611512`3.", ",", 
     "0.00009921510084925696929848693006448457`3.", ",", 
     "0.00016616248890860706621981635056073401`3.", ",", 
     "0.00045633810975609731151389492076475562`2.", ",", 
     "0.00221465481481481363951191454475520004`3.", ",", 
     "0.00348359207459207403587142515277719212`3.", ",", 
     "0.00591663095238095185918192342455768085`3.", ",", 
     "0.0494103000000000042168935010522545781`2."}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.675757915233734*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Results", "Subsubsubsection",
 CellChangeTimes->{{3.675586453813734*^9, 3.675586458589772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<C++/BLAS\>\"", ",", 
       RowBox[{"Transpose", "[", "timingscpp", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<MM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingsnat", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<C++/BLAS\>\"", ",", 
       RowBox[{"Transpose", "[", "timingscpp", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<MM\>\"", ",", 
       RowBox[{"Transpose", "[", "timingsnat", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"\"\<PlotType\>\"", "\[Rule]", "\"\<Contours\>\""}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"p", "=", 
  RowBox[{"Row", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2"}], "}"}], ",", 
    RowBox[{"Alignment", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Center", ",", "Bottom"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.675585228483169*^9, 3.675585231079399*^9}, {
  3.67558573270728*^9, 3.6755857761693783`*^9}, {3.67558591764384*^9, 
  3.675585921731621*^9}, {3.6755860073122683`*^9, 3.675586007368134*^9}, {
  3.675586348538485*^9, 3.675586372265463*^9}, {3.675586774097477*^9, 
  3.675586789312622*^9}, {3.67558683717619*^9, 3.67558685018228*^9}, {
  3.6755996301857357`*^9, 3.6755996849661627`*^9}, {3.675599764331643*^9, 
  3.67559984971093*^9}, {3.675599894685419*^9, 3.6755998950933037`*^9}, {
  3.675599931667879*^9, 3.675599946939253*^9}, {3.675669242085101*^9, 
  3.675669247060527*^9}, {3.675669278532414*^9, 3.675669279259132*^9}, {
  3.675669328162595*^9, 3.675669357696048*^9}, {3.675669406239079*^9, 
  3.675669408725966*^9}, {3.675670994030793*^9, 3.675671012125802*^9}, {
  3.6756786590859833`*^9, 3.675678683308997*^9}, {3.6757579323776712`*^9, 
  3.6757579793110247`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "[2016-06-24] L: C++/BLAS/col vs C++/BLAS/row)  ",
 StyleBox["[C++/BLAS/col]",
  FontSize->12,
  FontColor->GrayLevel[0.5]]
}], "Subsubsection",
 CellChangeTimes->{{3.6755833406524754`*^9, 3.6755834054017553`*^9}, {
  3.6755834831665173`*^9, 3.675583493822259*^9}, {3.675670626717189*^9, 
  3.675670643484375*^9}, {3.675671662284398*^9, 3.675671662850811*^9}, {
  3.6756721496229467`*^9, 3.675672162062339*^9}, {3.6756727145843973`*^9, 
  3.675672741671221*^9}, {3.675678230670579*^9, 3.675678238982194*^9}, {
  3.675678717195244*^9, 3.675678717515177*^9}, {3.675757352270879*^9, 
  3.6757573691021214`*^9}, {3.675758138455759*^9, 3.6757581404957733`*^9}, {
  3.675763686082286*^9, 3.6757637014334497`*^9}, {3.6757641806155043`*^9, 
  3.675764184261806*^9}}],

Cell["\<\
iMac, 3.5 GHz Intel Core i5, 16 GB RAM, OS 10.11.5; Mathematica 10.4.1\
\>", "Text",
 CellChangeTimes->{{3.675670549705044*^9, 3.675670606118071*^9}}],

Cell[CellGroupData[{

Cell["Grid", "Subsubsubsection",
 CellChangeTimes->{{3.6756704065181637`*^9, 3.675670406934144*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ngrid", "=", 
   RowBox[{"{", 
    RowBox[{
    "10", ",", "50", ",", "100", ",", "500", ",", "1000", ",", "5000", ",", 
     "10000"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dgrid", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "10", ",", "50", ",", "100", ",", "300", ",", "500", ",", 
     "1000", ",", "10000"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67558352273318*^9, 3.675583563019446*^9}, {
   3.675583608713636*^9, 3.675583649895831*^9}, {3.675583696238008*^9, 
   3.675583714501089*^9}, {3.675587885606567*^9, 3.675587975313457*^9}, {
   3.675597707014162*^9, 3.675597724317615*^9}, 3.675598116733819*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "bm", "]"}], ";", 
  RowBox[{
   RowBox[{"bm", "[", 
    RowBox[{"f_", ",", "n_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xx", ",", "zz"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xx", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zz", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "100"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"First", "[", 
       RowBox[{"RepeatedTiming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"xx", ",", "zz"}], "]"}], ";"}], ",", "3"}], "]"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6755865239218893`*^9, 3.6755865623938217`*^9}, {
  3.675586650278653*^9, 3.675586650734549*^9}, {3.6755879791616163`*^9, 
  3.675587979241152*^9}, {3.675672842411611*^9, 3.675672853515049*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["C++/BLAS/col implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.6755864457108727`*^9, 
  3.675586449781939*^9}, {3.6756782690050583`*^9, 3.675678269725006*^9}, {
  3.675763738663952*^9, 3.675763741151649*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Path", "=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"$Path", ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<qmmlpack\>\""}], "]"}], "&"}], ")"}]}]}], 
      "]"}], ",", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", ",", 
        "\"\<mathematica\>\""}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<QMMLPack`\>\"", "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"new", " ", "version"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.675746418347074*^9, 3.675746510874631*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingscppcol", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"KernelLinear", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], "&"}], ")"}], ",", 
        "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675586499328845*^9, 3.675586507980432*^9}, {
  3.675586625392827*^9, 3.6755866275113153`*^9}, {3.675598385665947*^9, 
  3.675598412625558*^9}, {3.6756783292909527`*^9, 3.6756783296908693`*^9}, {
  3.6757574113247433`*^9, 3.675757418604328*^9}, {3.67576375231964*^9, 
  3.675763770399313*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.10147971668462774395618949951903`2.*^-6", ",", 
     "2.3755684705284587122388860469524`3.*^-6", ",", 
     "2.42897373338870200344718000562416`3.*^-6", ",", 
     "2.49256182123083549836300466806538`3.*^-6", ",", 
     "2.82585453941006163638125815718016`3.*^-6", ",", 
     "3.15694181965442610403077723646437`3.*^-6", ",", 
     "3.84100534539473721548337795117511`3.*^-6", ",", 
     "0.00002270467199225368012710686571598018`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.27616792007398282705736038133981`2.*^-6", ",", 
     "2.77228674988140831399641324239713`3.*^-6", ",", 
     "3.12139775453091854778473433762453`3.*^-6", ",", 
     "3.46261061537322025475271400352106`3.*^-6", ",", 
     "4.86485677083333165033425180001636`3.*^-6", ",", 
     "6.79949437792056060478546389291843`3.*^-6", ",", 
     "0.00001375131092344207229475738091251102`3.", ",", 
     "0.00010849578977932633982138310724252506`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.49536382785835993291146013561832`3.*^-6", ",", 
     "3.29528698620495448550664699394197`3.*^-6", ",", 
     "3.93760763188843977770621854195277`3.*^-6", ",", 
     "4.52289026219040365690404054133111`3.*^-6", ",", 
     "8.89763271162123590117282861955417`3.*^-6", ",", 
     "0.00001441674358678511811923152186043495`3.", ",", 
     "0.00002417245370370371126424700880530594`3.", ",", 
     "0.00038099258312020492771993174230260593`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.11119096734550608574680977125304`2.*^-6", ",", 
     "7.32477539062500319943290610913422`3.*^-6", ",", 
     "0.00001057917082386907105956159319548604`3.", ",", 
     "0.00001504273000000000123975527760444848`3.", ",", 
     "0.00003854272119341562677797413671854088`3.", ",", 
     "0.0000589773700063411462392315431912948`3.", ",", 
     "0.00011737154522613057236034989072592793`3.", ",", 
     "0.00247911019736842116664710111706426687`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "6.09261474609374943195395576966966`3.*^-6", ",", 
     "0.00001222344322344323066153928131205575`3.", ",", 
     "0.00001915739460068643598309942599478006`3.", ",", 
     "0.00002649576016676678271149353305347063`3.", ",", 
     "0.00007362981433932448455288721778089212`3.", ",", 
     "0.0001254170866935483722674066209279431`3.", ",", 
     "0.00043772339800117584986821617221153247`2.", ",", 
     "0.00491108552631578949149160351339560293`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00002179322925751497286805079267590912`3.", ",", 
     "0.00005179264654873397282939737062967822`3.", ",", 
     "0.00008104453397212543254175126650196148`3.", ",", 
     "0.00012776847079037798255232716293505746`3.", ",", 
     "0.00094908470290771152367420571138723062`2.", ",", 
     "0.00170549431818181758922781110499045099`3.", ",", 
     "0.00296495833333333290091071710037340381`3.", ",", 
     "0.02450323333333333242212148661565151997`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0000414881813125694571403601074166545`3.", ",", 
     "0.00010030124514660593727094495264395846`3.", ",", 
     "0.00016782231219073334119347429282953499`3.", ",", 
     "0.00048539936507936524978656933626552927`2.", ",", 
     "0.00221262573964497045314603340671055776`3.", ",", 
     "0.00346873193473193428687517680941709841`3.", ",", 
     "0.00591567460317460498686603642681802739`3.", ",", 
     "0.04885063333333332369345924917070078664`3."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675763951831794*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["C++/BLAS/row implementation", "Subsubsubsection",
 CellChangeTimes->{{3.675583456855699*^9, 3.675583460623555*^9}, {
  3.6755834964700117`*^9, 3.675583497533922*^9}, {3.6755864457108727`*^9, 
  3.675586449781939*^9}, {3.6757576725957737`*^9, 3.675757674770166*^9}, {
  3.675763710353136*^9, 3.675763710937097*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Path", "=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"$Path", ",", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<qmmlpack\>\""}], "]"}], "&"}], ")"}]}]}], 
      "]"}], ",", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", ",", 
        "\"\<mathematica\>\""}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<QMMLPack`\>\"", "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"new", " ", "version"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.675746418347074*^9, 3.675746510874631*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timingscpprow", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"{", 
        RowBox[{"n", ",", "d"}], "}"}], "]"}], ";", 
      RowBox[{"bm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"KernelLinear", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "}"}], ",", "Diagonal"}], "]"}], "&"}], ")"}], ",", 
        "n", ",", "d"}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "ngrid"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"d", ",", "dgrid"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6755837310841618`*^9, 3.675583781105747*^9}, {
   3.675583812401144*^9, 3.6755838144811172`*^9}, {3.675584401481059*^9, 
   3.675584413088552*^9}, {3.675584552835106*^9, 3.6755845594826393`*^9}, {
   3.675585593154819*^9, 3.675585595441177*^9}, {3.675586438711046*^9, 
   3.675586439014894*^9}, {3.675586566584388*^9, 3.675586580969152*^9}, {
   3.675591918506966*^9, 3.67559192155416*^9}, 3.6755977433728247`*^9, {
   3.675598062822199*^9, 3.6755980708837976`*^9}, {3.6755981035665407`*^9, 
   3.675598107869968*^9}, {3.675738636237687*^9, 3.675738637597827*^9}, 
   3.675746994494096*^9, 3.675753255614111*^9, {3.675763732120371*^9, 
   3.675763732384482*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.14991674732669407228832433864874`2.*^-6", ",", 
     "2.42970056438127169764020808762073`3.*^-6", ",", 
     "2.53500561904246136750960827210832`3.*^-6", ",", 
     "2.58031360815602930599329395411345`3.*^-6", ",", 
     "2.94693944521760694142046947685554`3.*^-6", ",", 
     "3.29632073479729954812444958633932`3.*^-6", ",", 
     "3.95556772950542118822900294894396`3.*^-6", ",", 
     "0.00002287062681104162827224433873762877`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.32525266617063312203791090870819`2.*^-6", ",", 
     "2.84188030946601835358697810129947`3.*^-6", ",", 
     "3.16838304924242236015234988610878`3.*^-6", ",", 
     "3.53833833408815919241126660144126`3.*^-6", ",", 
     "4.91507523148148084581173997142933`3.*^-6", ",", 
     "6.85077391431924898523766337410379`3.*^-6", ",", 
     "0.0000138368461053646240520266161300178`3.", ",", 
     "0.00011536061538461532917972801604022948`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.5441103413545307766578662533874`2.*^-6", ",", 
     "3.35261073681193049755041961368374`3.*^-6", ",", 
     "3.99533598019125852073571772415939`3.*^-6", ",", 
     "4.56769714355468696160688518714821`3.*^-6", ",", 
     "8.9998975212191373919965245442576`3.*^-6", ",", 
     "0.00001450792538069088305290564588911906`3.", ",", 
     "0.00002424196884493571581796478309200893`3.", ",", 
     "0.00037925101317122571166137734444134821`2."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.15597534179687156600645908666181`3.*^-6", ",", 
     "7.39409229008838264710903528942332`3.*^-6", ",", 
     "0.00001069206944624096054677429151746892`3.", ",", 
     "0.00001509279141104294543569361297663534`3.", ",", 
     "0.00003862926804070458035658686135604967`3.", ",", 
     "0.00005917688501880073465716280978199393`3.", ",", 
     "0.00012595390190460147689620329369830642`3.", ",", 
     "0.00247340562913907343819963635667136259`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "6.13221343224789937836156569761492`3.*^-6", ",", 
     "0.00001229409828511241586218843274691537`3.", ",", 
     "0.00001916304959100204320892983644863961`3.", ",", 
     "0.00002646496161873429983353404881807336`3.", ",", 
     "0.00007411512605042018747916743315329313`3.", ",", 
     "0.00013315089126559714318917548858678401`3.", ",", 
     "0.00043860846560846573601380460338816647`3.", ",", 
     "0.00492134210526315712258549339708224579`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.00002194412050534497941444572743918684`3.", ",", 
     "0.00005189329013377927168936334934024046`3.", ",", 
     "0.00008139080646911969394146496581399219`3.", ",", 
     "0.00013504160623640330536436582331560885`3.", ",", 
     "0.0009490825396825398321473676865878133`2.", ",", 
     "0.00171362298850574832492776877757023613`3.", ",", 
     "0.00299188690476190431027925242801757122`2.", ",", 
     "0.02447433333333334098957934088502952363`3."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0000417117335562987943801439849611512`3.", ",", 
     "0.00009921510084925696929848693006448457`3.", ",", 
     "0.00016616248890860706621981635056073401`3.", ",", 
     "0.00045633810975609731151389492076475562`2.", ",", 
     "0.00221465481481481363951191454475520004`3.", ",", 
     "0.00348359207459207403587142515277719212`3.", ",", 
     "0.00591663095238095185918192342455768085`3.", ",", 
     "0.0494103000000000042168935010522545781`2."}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{3.675763726853065*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Results", "Subsubsubsection",
 CellChangeTimes->{{3.675586453813734*^9, 3.675586458589772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<C++/BLAS/row\>\"", ",", 
       RowBox[{"Transpose", "[", "timingscpprow", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<C++/BLAS/col\>\"", ",", 
       RowBox[{"Transpose", "[", "timingscppcol", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", 
   RowBox[{"BenchmarkPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<C++/BLAS/row\>\"", ",", 
       RowBox[{"Transpose", "[", "timingscpprow", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<C++/BLAS/col\>\"", ",", 
       RowBox[{"Transpose", "[", "timingscppcol", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<d\>\"", ",", "dgrid"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<n\>\"", ",", "ngrid"}], "}"}]}], "}"}], ",", 
     RowBox[{"\"\<PlotType\>\"", "\[Rule]", "\"\<Contours\>\""}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"p", "=", 
  RowBox[{"Row", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2"}], "}"}], ",", 
    RowBox[{"Alignment", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Center", ",", "Bottom"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQLV/WHzk/6bVjQdcjMM21aNoMEN2TzToPRIfN2rIe
LJ9pvgFES/17uQtEHzz+Gky7Wk98CqLX1HW8ANEdcoelFgBpBsZVMiA6cvFS
JRBte9VVBUT3fDyauAxIn3s1LwNEX5rTVQSiP+w3qwXRX95dbQLREX8egWmX
+NJ2EB3DF9cJotV2OsWfANLX3j8E052cF5NB9HmvF2D6lzFrFohmc9uWC5Zf
drwYRMtai5eAaKc/DlYngfQkthYbEJ1wIOnHGSDt9zjzN4h+JNqz9jOQfvU5
czOIXlVXMv8bkJ7Rw78YRLN9TloFojMiulaDaACz5K+g
  "]],

Cell["Almost no difference.", "Text",
 CellChangeTimes->{{3.6757641233449593`*^9, 3.675764127296093*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Results", "Subsubsection",
 CellChangeTimes->{{3.67567044794855*^9, 3.675670448820509*^9}}],

Cell["Entries refer to better-performing method.", "Text",
 CellChangeTimes->{{3.675672075185925*^9, 3.6756720835135527`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<K\>\"", ",", "Bold"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<L\>\"", ",", "Bold"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<m\>\"", ",", "Bold"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<C++/old vs MM/WVM\>\"", ",", "\"\<mixed\>\"", ",", ",", 
       "\"\<C++\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<C++/new vs MM\>\"", ",", ",", ",", "\"\<MM/nat for large n\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<C++/BLAS vs MM\>\"", ",", ",", "\"\<C++/BLAS\>\"", ",", 
       "\"\<C++/BLAS\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<MM/nat vs MM/WVM\>\"", ",", "\"\<MM/nat for large n\>\"", ",", 
       "\"\<MM/nat for large n\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<MM/C vs MM/WVM\>\"", ",", ",", "\"\<MM/WVM\>\""}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<C++/BLAS/row vs C++/BLAS/col\>\"", ",", ",", 
       "\"\<C++/BLAS/col\>\""}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"Alignment", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Left", ",", 
        RowBox[{"{", "Center", "}"}]}], "}"}], ",", "Automatic"}], "}"}]}], 
   ",", 
   RowBox[{"Spacings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", " ", "0"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.675670467113475*^9, 3.6756705063062983`*^9}, {
  3.67567152641693*^9, 3.675671554567297*^9}, {3.67567193789753*^9, 
  3.675671947159584*^9}, {3.6756719998703613`*^9, 3.6756720696347437`*^9}, {
  3.67567263358009*^9, 3.6756726362917213`*^9}, {3.675678141578784*^9, 
  3.6756781456184797`*^9}, {3.6756787212034807`*^9, 3.675678734322852*^9}, {
  3.6757396370769167`*^9, 3.675739642173012*^9}, {3.675747939456525*^9, 
  3.67574797427903*^9}, {3.675751803216632*^9, 3.675751820648059*^9}, {
  3.675753554237781*^9, 3.6757535557479067`*^9}, {3.6757581561034937`*^9, 
  3.675758159159369*^9}, {3.675764130672222*^9, 3.675764150527564*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"", 
     StyleBox["\<\"K\"\>",
      StripOnInput->False,
      FontWeight->Bold], 
     StyleBox["\<\"L\"\>",
      StripOnInput->False,
      FontWeight->Bold], 
     StyleBox["\<\"m\"\>",
      StripOnInput->False,
      FontWeight->Bold]},
    {"\<\"C++/old vs MM/WVM\"\>", "\<\"mixed\"\>", "", "\<\"C++\"\>"},
    {"\<\"C++/new vs MM\"\>", "", "", "\<\"MM/nat for large n\"\>"},
    {"\<\"C++/BLAS vs MM\"\>", "", "\<\"C++/BLAS\"\>", "\<\"C++/BLAS\"\>"},
    {"\<\"MM/nat vs MM/WVM\"\>", "\<\"MM/nat for large n\"\>", "\<\"MM/nat \
for large n\"\>", ""},
    {"\<\"MM/C vs MM/WVM\"\>", "", "\<\"MM/WVM\"\>", ""},
    {"\<\"C++/BLAS/row vs C++/BLAS/col\"\>", "", "\<\"C++/BLAS/col\"\>", ""}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {Left, {Center}}, "Rows" -> {{Automatic}}},
   
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
   GridBoxSpacings->{"Columns" -> {{1}}, "Rows" -> {{0}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.675670508882881*^9, 3.6756715548240643`*^9, 3.6756719477211742`*^9, {
   3.6756720038812428`*^9, 3.675672070010283*^9}, 3.67567263684978*^9, 
   3.6756781460581493`*^9, 3.6756787351988363`*^9, 3.6757396434683933`*^9, {
   3.675747965864602*^9, 3.6757479746439133`*^9}, 3.675751822144946*^9, 
   3.675753556852713*^9, 3.675758160481982*^9, 3.6757641513741083`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Regression", "Section",
 CellChangeTimes->{{3.676705840234108*^9, 3.676705841442141*^9}, {
  3.677210454850891*^9, 3.6772104558981247`*^9}, {3.677926315357045*^9, 
  3.6779263164769497`*^9}}],

Cell[CellGroupData[{

Cell["Utility routines", "Subsection",
 CellChangeTimes->{{3.677926334500222*^9, 3.677926350939509*^9}}],

Cell[CellGroupData[{

Cell["ForwardSubstitution", "Subsubsection",
 CellChangeTimes->{{3.676705845938011*^9, 3.676705851785695*^9}, {
  3.6767851492378387`*^9, 3.67678515103646*^9}, {3.6779263538033867`*^9, 
  3.67792638033013*^9}}],

Cell[CellGroupData[{

Cell["Mathematica", "Subsubsubsection",
 CellChangeTimes->{{3.676780818559895*^9, 3.676780820111006*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<regression_forwardsubstitutionv_mm-cppnaive_2016-07-19_15-51.json\>\"\
", ",", "\[IndentingNewLine]", 
     "\"\<regression_forwardsubstitutionv_mm-cppblas_2016-07-19_17-27.json\>\"\
", ",", "\[IndentingNewLine]", 
     "\"\<regression_forwardsubstitutionv_mm-cppblas2_2016-07-20_10-18.json\>\
\""}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<results\>\"", 
          ",", "#"}], "}"}], "]"}], "]"}], "&"}], ",", "filenames"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"NamesJoin", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Benchmark\>\"", "/.", "#"}], "&"}], ",", "res"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BenchmarkStatistics", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"names", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Timings\>\"", "/.", "#"}], "&"}], ",", "res"}], 
        "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Transpose", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6767063688321667`*^9, 3.676706511239314*^9}, {
   3.676706972316763*^9, 3.6767069989714727`*^9}, {3.676707036139514*^9, 
   3.6767070399860363`*^9}, {3.676708369210973*^9, 3.6767083731004467`*^9}, {
   3.676708704214966*^9, 3.6767087071748867`*^9}, {3.676716020684443*^9, 
   3.676716021219853*^9}, {3.6767160986882687`*^9, 3.67671609935236*^9}, {
   3.676718004352167*^9, 3.67671823331108*^9}, {3.6767791952365637`*^9, 
   3.676779212131809*^9}, {3.677926385114375*^9, 3.677926422497121*^9}, 
   3.677926454983384*^9, {3.677990729800213*^9, 3.67799074634997*^9}, {
   3.677991593220038*^9, 3.677991608037994*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", "\<\"naive\"\>", "\<\"BLAS\"\>", "\<\"BLAS2\"\>"},
    {"\<\"\[CapitalSigma]t/s\"\>", "0.05217013626`", 
     ItemBox["0.02884579018`",
      BaseStyle->Bold,
      StripOnInput->False], "0.028965478439999998`"},
    {"\<\"best t/%\"\>", "29", "29", 
     ItemBox["43",
      BaseStyle->Bold,
      StripOnInput->False]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.676780259905254*^9, 3.676780302854866*^9, {3.677926439318927*^9, 
   3.6779264564396257`*^9}, 3.677990746706101*^9, 3.677991608501773*^9, {
   3.677997619459927*^9, 3.677997643085113*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Python", "Subsubsubsection",
 CellChangeTimes->{{3.676780818559895*^9, 3.676780820111006*^9}, {
  3.677997577611072*^9, 3.677997578258432*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"filenames", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<regression_forwardsubstitutionv_py-sp_2016-07-20_09-57.json\>\"", 
     ",", "\[IndentingNewLine]", 
     "\"\<regression_forwardsubstitutionv_py-cppblas2_2016-07-20_09-58.json\>\
\""}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<results\>\"", 
          ",", "#"}], "}"}], "]"}], "]"}], "&"}], ",", "filenames"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"NamesJoin", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Benchmark\>\"", "/.", "#"}], "&"}], ",", "res"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BenchmarkStatistics", "[", 
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"names", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\"\<Timings\>\"", "/.", "#"}], "&"}], ",", "res"}], 
        "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Transpose", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6767063688321667`*^9, 3.676706511239314*^9}, {
   3.676706972316763*^9, 3.6767069989714727`*^9}, {3.676707036139514*^9, 
   3.6767070399860363`*^9}, {3.676708369210973*^9, 3.6767083731004467`*^9}, {
   3.676708704214966*^9, 3.6767087071748867`*^9}, {3.676716020684443*^9, 
   3.676716021219853*^9}, {3.6767160986882687`*^9, 3.67671609935236*^9}, {
   3.676718004352167*^9, 3.67671823331108*^9}, {3.6767791952365637`*^9, 
   3.676779212131809*^9}, {3.677926385114375*^9, 3.677926422497121*^9}, 
   3.677926454983384*^9, {3.677990729800213*^9, 3.67799074634997*^9}, {
   3.677991593220038*^9, 3.677991608037994*^9}, {3.6779976078567133`*^9, 
   3.677997617467473*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"\"\>", "\<\"SciPy\"\>", "\<\"C++/BLAS2\"\>"},
    {"\<\"\[CapitalSigma]t/s\"\>", "2.2339723932559825`", 
     ItemBox["0.029328854877634022`",
      BaseStyle->Bold,
      StripOnInput->False]},
    {"\<\"best t/%\"\>", "0", 
     ItemBox["100",
      BaseStyle->Bold,
      StripOnInput->False]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.677997640290316*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Interactive analysis", "Section",
 CellChangeTimes->{{3.676357913035746*^9, 3.676357916427425*^9}, {
  3.6763579499382143`*^9, 3.676357951938055*^9}, {3.676456909773415*^9, 
  3.67645691059762*^9}, {3.676780869453065*^9, 3.676780876452722*^9}}],

Cell[BoxData[
 RowBox[{"PairwiseComparison", "[", "]"}]], "Input",
 CellChangeTimes->{{3.6779288815789633`*^9, 3.677928886348104*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1552, 1304},
WindowMargins->{{2, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 11, \
2016)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Section"], MenuCommandKey -> "1", FontFamily -> "Helvetica", 
    FontSize -> 24, FontWeight -> "Plain", FontSlant -> "Plain"], 
   Cell[
    StyleData["Subsection"], MenuSortingValue -> 10000, MenuCommandKey -> "2",
     FontFamily -> "Helvetica", FontSize -> 16, FontWeight -> "Bold", 
    FontSlant -> "Plain"], 
   Cell[
    StyleData["Subsubsection"], MenuSortingValue -> 10000, MenuCommandKey -> 
    "3", FontFamily -> "Helvetica", FontSize -> 15, FontWeight -> "Plain", 
    FontSlant -> "Plain"], 
   Cell[
    StyleData["Subsubsubsection"], MenuSortingValue -> 10000, MenuCommandKey -> 
    "4", FontFamily -> "Helvetica", FontSize -> 14, FontWeight -> "Plain", 
    FontSlant -> "Italic"], 
   Cell[
    StyleData["Subsubsubsubsection"], MenuSortingValue -> 10000, 
    MenuCommandKey -> "5", FontFamily -> "Helvetica Light Oblique", FontSize -> 
    12, FontWeight -> "Plain", FontSlant -> "Plain"], 
   Cell[
    StyleData["Text"], MenuSortingValue -> 10000], 
   Cell[
    StyleData["Title"], MenuCommandKey -> None], 
   Cell[
    StyleData["Chapter"], MenuCommandKey -> None], 
   Cell[
    StyleData["Subchapter"], MenuCommandKey -> None]}, Visible -> False, 
  FrontEndVersion -> 
  "10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 11, 2016)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 213, 3, 92, "Title"],
Cell[638, 20, 269, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[932, 29, 282, 4, 56, "Section"],
Cell[CellGroupData[{
Cell[1239, 37, 244, 7, 37, "Subsection"],
Cell[CellGroupData[{
Cell[1508, 48, 110, 1, 28, "Subsubsection"],
Cell[1621, 51, 1808, 33, 148, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3466, 89, 240, 7, 28, "Subsubsection"],
Cell[3709, 98, 308, 8, 28, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4066, 112, 236, 7, 37, "Subsection"],
Cell[4305, 121, 2162, 53, 182, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[6504, 179, 453, 10, 29, "Subsection"],
Cell[6960, 191, 8877, 177, 284, "Input"],
Cell[15840, 370, 20655, 455, 1015, "Input"],
Cell[36498, 827, 5284, 133, 335, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[41819, 965, 303, 8, 29, "Subsection"],
Cell[42125, 975, 7538, 177, 625, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[49700, 1157, 256, 7, 29, "Subsection"],
Cell[49959, 1166, 10421, 219, 607, "Input"]
}, Closed]]
}, Closed]],
Cell[60407, 1389, 148, 2, 42, "Section"],
Cell[CellGroupData[{
Cell[60580, 1395, 145, 2, 42, "Section"],
Cell[CellGroupData[{
Cell[60750, 1401, 210, 6, 37, "Subsection"],
Cell[CellGroupData[{
Cell[60985, 1411, 351, 5, 28, "Subsubsection"],
Cell[CellGroupData[{
Cell[61361, 1420, 71, 1, 27, "Subsubsubsection"],
Cell[CellGroupData[{
Cell[61457, 1425, 154, 2, 27, "Subsubsubsubsection"],
Cell[CellGroupData[{
Cell[61636, 1431, 2461, 59, 182, "Input"],
Cell[64100, 1492, 667, 17, 63, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[64816, 1515, 210, 3, 21, "Subsubsubsubsection"],
Cell[CellGroupData[{
Cell[65051, 1522, 2189, 54, 131, "Input"],
Cell[67243, 1578, 510, 15, 63, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[67814, 1600, 73, 1, 21, "Subsubsubsection"],
Cell[CellGroupData[{
Cell[67912, 1605, 154, 2, 27, "Subsubsubsubsection"],
Cell[CellGroupData[{
Cell[68091, 1611, 2347, 56, 148, "Input"],
Cell[70441, 1669, 543, 15, 63, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[71057, 1692, 207, 3, 22, "Subsubsection"],
Cell[CellGroupData[{
Cell[71289, 1699, 94, 1, 27, "Subsubsubsection"],
Cell[CellGroupData[{
Cell[71408, 1704, 108, 1, 27, "Subsubsubsubsection"],
Cell[CellGroupData[{
Cell[71541, 1709, 2075, 52, 131, "Input"],
Cell[73619, 1763, 503, 15, 63, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[74171, 1784, 103, 1, 27, "Subsubsubsubsection"],
Cell[CellGroupData[{
Cell[74299, 1789, 2029, 51, 131, "Input"],
Cell[76331, 1842, 556, 16, 63, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[76960, 1866, 216, 3, 22, "Subsubsection"],
Cell[CellGroupData[{
Cell[77201, 1873, 105, 1, 27, "Subsubsubsection"],
Cell[CellGroupData[{
Cell[77331, 1878, 2047, 52, 148, "Input"],
Cell[79381, 1932, 568, 16, 63, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[79998, 1954, 100, 1, 27, "Subsubsubsection"],
Cell[CellGroupData[{
Cell[80123, 1959, 2004, 51, 131, "Input"],
Cell[82130, 2012, 524, 15, 63, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[82739, 2036, 92, 1, 42, "Section"],
Cell[CellGroupData[{
Cell[82856, 2041, 164, 2, 37, "Subsection"],
Cell[CellGroupData[{
Cell[83045, 2047, 105, 1, 27, "Subsubsubsection"],
Cell[CellGroupData[{
Cell[83175, 2052, 2128, 54, 148, "Input"],
Cell[85306, 2108, 487, 15, 63, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[85854, 2130, 103, 1, 29, "Subsection"],
Cell[CellGroupData[{
Cell[85982, 2135, 108, 1, 28, "Subsubsection"],
Cell[CellGroupData[{
Cell[86115, 2140, 105, 1, 27, "Subsubsubsection"],
Cell[CellGroupData[{
Cell[86245, 2145, 2085, 54, 148, "Input"],
Cell[88333, 2201, 536, 16, 63, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[88930, 2224, 164, 2, 28, "Subsubsection"],
Cell[CellGroupData[{
Cell[89119, 2230, 105, 1, 27, "Subsubsubsection"],
Cell[CellGroupData[{
Cell[89249, 2235, 2121, 54, 148, "Input"],
Cell[91373, 2291, 499, 15, 63, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[91945, 2314, 101, 1, 37, "Subsection"],
Cell[CellGroupData[{
Cell[92071, 2319, 106, 1, 28, "Subsubsection"],
Cell[CellGroupData[{
Cell[92202, 2324, 270, 6, 28, "Input"],
Cell[92475, 2332, 407, 7, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92919, 2344, 464, 9, 28, "Input"],
Cell[93386, 2355, 6672, 177, 220, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100095, 2537, 456, 9, 28, "Input"],
Cell[100554, 2548, 6663, 176, 220, "Output"]
}, Open  ]],
Cell[107232, 2727, 1447, 38, 46, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[108728, 2771, 101, 1, 37, "Subsection"],
Cell[CellGroupData[{
Cell[108854, 2776, 363, 8, 28, "Subsubsection"],
Cell[109220, 2786, 160, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[109405, 2793, 100, 1, 27, "Subsubsubsection"],
Cell[109508, 2796, 699, 16, 46, "Input"],
Cell[110210, 2814, 967, 27, 80, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[111214, 2846, 170, 2, 21, "Subsubsubsection"],
Cell[111387, 2850, 302, 7, 28, "Input"],
Cell[CellGroupData[{
Cell[111714, 2861, 1168, 28, 28, "Input"],
Cell[112885, 2891, 3589, 74, 74, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[116523, 2971, 223, 3, 21, "Subsubsubsection"],
Cell[116749, 2976, 428, 12, 28, "Input"],
Cell[CellGroupData[{
Cell[117202, 2992, 624, 17, 28, "Input"],
Cell[117829, 3011, 3619, 74, 74, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[121497, 3091, 101, 1, 21, "Subsubsubsection"],
Cell[121601, 3094, 7555, 151, 692, "Input"],
Cell[129159, 3247, 2315, 56, 63, "Input"],
Cell[131477, 3305, 455, 12, 46, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[131981, 3323, 458, 10, 22, "Subsubsection"],
Cell[132442, 3335, 160, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[132627, 3342, 100, 1, 27, "Subsubsubsection"],
Cell[132730, 3345, 699, 16, 46, "Input"],
Cell[133432, 3363, 967, 27, 80, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[134436, 3395, 220, 3, 21, "Subsubsubsection"],
Cell[134659, 3400, 232, 6, 28, "Input"],
Cell[CellGroupData[{
Cell[134916, 3410, 1144, 26, 28, "Input"],
Cell[136063, 3438, 3617, 74, 74, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[139729, 3518, 223, 3, 21, "Subsubsubsection"],
Cell[139955, 3523, 428, 12, 28, "Input"],
Cell[CellGroupData[{
Cell[140408, 3539, 624, 17, 28, "Input"],
Cell[141035, 3558, 3601, 74, 74, "Output"]
}, Open  ]],
Cell[144651, 3635, 104, 1, 30, "Text"],
Cell[144758, 3638, 3619, 74, 74, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[148414, 3717, 101, 1, 21, "Subsubsubsection"],
Cell[148518, 3720, 7612, 152, 692, "Input"],
Cell[156133, 3874, 2367, 56, 63, "Input"],
Cell[158503, 3932, 619, 14, 46, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[159171, 3952, 460, 10, 22, "Subsubsection"],
Cell[159634, 3964, 160, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[159819, 3971, 100, 1, 27, "Subsubsubsection"],
Cell[159922, 3974, 699, 16, 46, "Input"],
Cell[160624, 3992, 1369, 38, 97, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[162030, 4035, 220, 3, 21, "Subsubsubsection"],
Cell[162253, 4040, 358, 9, 28, "Input"],
Cell[CellGroupData[{
Cell[162636, 4053, 1097, 23, 28, "Input"],
Cell[163736, 4078, 3647, 75, 74, "Output"]
}, Open  ]],
Cell[167398, 4156, 103, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[167526, 4161, 1119, 23, 28, "Input"],
Cell[168648, 4186, 3597, 74, 74, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[172294, 4266, 223, 3, 21, "Subsubsubsection"],
Cell[172520, 4271, 580, 16, 28, "Input"],
Cell[CellGroupData[{
Cell[173125, 4291, 624, 17, 28, "Input"],
Cell[173752, 4310, 3620, 74, 74, "Output"]
}, Open  ]],
Cell[177387, 4387, 100, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[177512, 4392, 647, 17, 28, "Input"],
Cell[178162, 4411, 3598, 74, 74, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[181809, 4491, 101, 1, 21, "Subsubsubsection"],
Cell[181913, 4494, 2367, 56, 63, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[184329, 4556, 553, 11, 22, "Subsubsection"],
Cell[184885, 4569, 160, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[185070, 4576, 100, 1, 27, "Subsubsubsection"],
Cell[185173, 4579, 699, 16, 46, "Input"],
Cell[185875, 4597, 1369, 38, 97, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[187281, 4640, 269, 3, 21, "Subsubsubsection"],
Cell[187553, 4645, 629, 17, 28, "Input"],
Cell[CellGroupData[{
Cell[188207, 4666, 672, 17, 28, "Input"],
Cell[188882, 4685, 3599, 74, 74, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[192530, 4765, 223, 3, 21, "Subsubsubsection"],
Cell[192756, 4770, 580, 16, 28, "Input"],
Cell[193339, 4788, 100, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[193464, 4793, 647, 17, 28, "Input"],
Cell[194114, 4812, 3598, 74, 74, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[197761, 4892, 101, 1, 21, "Subsubsubsection"],
Cell[197865, 4895, 2416, 57, 63, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[200330, 4958, 463, 10, 22, "Subsubsection"],
Cell[200796, 4970, 160, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[200981, 4977, 100, 1, 27, "Subsubsubsection"],
Cell[201084, 4980, 699, 16, 46, "Input"],
Cell[201786, 4998, 1013, 27, 80, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[202836, 5030, 170, 2, 21, "Subsubsubsection"],
Cell[203009, 5034, 302, 7, 28, "Input"],
Cell[CellGroupData[{
Cell[203336, 5045, 1232, 28, 28, "Input"],
Cell[204571, 5075, 3584, 74, 100, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[208204, 5155, 269, 3, 21, "Subsubsubsection"],
Cell[CellGroupData[{
Cell[208498, 5162, 128, 1, 27, "Subsubsubsubsection"],
Cell[208629, 5165, 402, 13, 28, "Input"],
Cell[CellGroupData[{
Cell[209056, 5182, 894, 24, 28, "Input"],
Cell[209953, 5208, 3670, 75, 91, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[213672, 5289, 127, 1, 21, "Subsubsubsubsection"],
Cell[213802, 5292, 434, 13, 28, "Input"],
Cell[CellGroupData[{
Cell[214261, 5309, 894, 24, 28, "Input"],
Cell[215158, 5335, 3694, 75, 80, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[218901, 5416, 196, 2, 21, "Subsubsubsubsection"],
Cell[219100, 5420, 505, 13, 28, "Input"],
Cell[CellGroupData[{
Cell[219630, 5437, 894, 24, 28, "Input"],
Cell[220527, 5463, 3714, 76, 74, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[224302, 5546, 101, 1, 21, "Subsubsubsection"],
Cell[224406, 5549, 2358, 56, 63, "Input"],
Cell[226767, 5607, 106, 1, 30, "Text"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[226922, 5614, 564, 11, 22, "Subsubsection"],
Cell[227489, 5627, 160, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[227674, 5634, 100, 1, 27, "Subsubsubsection"],
Cell[227777, 5637, 699, 16, 46, "Input"],
Cell[228479, 5655, 1013, 27, 80, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[229529, 5687, 225, 3, 21, "Subsubsubsection"],
Cell[229757, 5692, 813, 23, 63, "Input"],
Cell[CellGroupData[{
Cell[230595, 5719, 1232, 28, 28, "Input"],
Cell[231830, 5749, 3645, 75, 91, "Output"]
}, Open  ]],
Cell[235490, 5827, 112, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[235627, 5832, 1258, 29, 28, "Input"],
Cell[236888, 5863, 3599, 74, 91, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[240536, 5943, 269, 3, 21, "Subsubsubsection"],
Cell[CellGroupData[{
Cell[240830, 5950, 127, 1, 27, "Subsubsubsubsection"],
Cell[240960, 5953, 434, 13, 28, "Input"],
Cell[CellGroupData[{
Cell[241419, 5970, 894, 24, 28, "Input"],
Cell[242316, 5996, 3694, 75, 80, "Output"]
}, Open  ]],
Cell[246025, 6074, 98, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[246148, 6079, 633, 20, 28, "Input"],
Cell[246784, 6101, 3624, 74, 80, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[250469, 6182, 101, 1, 21, "Subsubsubsection"],
Cell[250573, 6185, 2358, 56, 63, "Input"],
Cell[252934, 6243, 106, 1, 30, "Text"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[253089, 6250, 665, 12, 22, "Subsubsection"],
Cell[253757, 6264, 160, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[253942, 6271, 100, 1, 27, "Subsubsubsection"],
Cell[254045, 6274, 699, 16, 46, "Input"],
Cell[254747, 6292, 1013, 27, 80, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[255797, 6324, 270, 3, 21, "Subsubsubsection"],
Cell[256070, 6329, 813, 23, 63, "Input"],
Cell[CellGroupData[{
Cell[256908, 6356, 1280, 29, 28, "Input"],
Cell[258191, 6387, 3568, 74, 100, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[261808, 6467, 269, 3, 21, "Subsubsubsection"],
Cell[CellGroupData[{
Cell[262102, 6474, 127, 1, 27, "Subsubsubsubsection"],
Cell[262232, 6477, 434, 13, 28, "Input"],
Cell[CellGroupData[{
Cell[262691, 6494, 633, 20, 28, "Input"],
Cell[263327, 6516, 3624, 74, 80, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[267012, 6597, 101, 1, 21, "Subsubsubsection"],
Cell[267116, 6600, 2358, 56, 63, "Input"],
Cell[269477, 6658, 211, 3, 30, "Text"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[269737, 6667, 666, 12, 22, "Subsubsection"],
Cell[270406, 6681, 160, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[270591, 6688, 100, 1, 27, "Subsubsubsection"],
Cell[270694, 6691, 699, 16, 46, "Input"],
Cell[271396, 6709, 1369, 38, 97, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[272802, 6752, 269, 3, 21, "Subsubsubsection"],
Cell[273074, 6757, 358, 9, 28, "Input"],
Cell[CellGroupData[{
Cell[273457, 6770, 725, 18, 28, "Input"],
Cell[274185, 6790, 3618, 74, 74, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[277852, 6870, 267, 3, 21, "Subsubsubsection"],
Cell[278122, 6875, 813, 23, 63, "Input"],
Cell[CellGroupData[{
Cell[278960, 6902, 1280, 29, 28, "Input"],
Cell[280243, 6933, 3563, 74, 100, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[283855, 7013, 101, 1, 21, "Subsubsubsection"],
Cell[283959, 7016, 2473, 58, 63, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[286481, 7080, 775, 14, 22, "Subsubsection"],
Cell[287259, 7096, 160, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[287444, 7103, 100, 1, 27, "Subsubsubsection"],
Cell[287547, 7106, 699, 16, 46, "Input"],
Cell[288249, 7124, 1369, 38, 97, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[289655, 7167, 320, 4, 21, "Subsubsubsection"],
Cell[289978, 7173, 813, 23, 63, "Input"],
Cell[CellGroupData[{
Cell[290816, 7200, 963, 25, 28, "Input"],
Cell[291782, 7227, 3566, 74, 100, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[295397, 7307, 320, 4, 21, "Subsubsubsection"],
Cell[295720, 7313, 813, 23, 63, "Input"],
Cell[CellGroupData[{
Cell[296558, 7340, 1333, 30, 28, "Input"],
Cell[297894, 7372, 3563, 74, 100, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[301506, 7452, 101, 1, 21, "Subsubsubsection"],
Cell[301610, 7455, 2011, 53, 63, "Input"],
Cell[303624, 7510, 105, 1, 30, "Text"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[303778, 7517, 97, 1, 22, "Subsubsection"],
Cell[303878, 7520, 126, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[304029, 7525, 2381, 55, 165, "Input"],
Cell[306413, 7582, 1388, 31, 101, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[307874, 7621, 197, 3, 56, "Section"],
Cell[CellGroupData[{
Cell[308096, 7628, 104, 1, 37, "Subsection"],
Cell[CellGroupData[{
Cell[308225, 7633, 210, 3, 28, "Subsubsection"],
Cell[CellGroupData[{
Cell[308460, 7640, 105, 1, 27, "Subsubsubsection"],
Cell[CellGroupData[{
Cell[308590, 7645, 2205, 54, 148, "Input"],
Cell[310798, 7701, 708, 18, 63, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[311555, 7725, 149, 2, 27, "Subsubsubsection"],
Cell[CellGroupData[{
Cell[311729, 7731, 2143, 53, 131, "Input"],
Cell[313875, 7786, 506, 15, 63, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[314466, 7810, 250, 3, 42, "Section"],
Cell[314719, 7815, 134, 2, 28, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

